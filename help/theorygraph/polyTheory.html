<HTML>
<HEAD><TITLE>Theory: poly</TITLE></HEAD>
<BODY bgcolor=linen text=midnightblue>
<H1><font color="black">Theory "poly"</font></H1>
<STRONG><font size=+3 color="black">Parents</font></STRONG>&nbsp;&nbsp;&nbsp;&nbsp;
    <A HREF = "listTheory.html"><STRONG><font color="black">list</font></STRONG></A>
    <A HREF = "pred_setTheory.html"><STRONG><font color="black">pred_set</font></STRONG></A>
    <A HREF = "limTheory.html"><STRONG><font color="black">lim</font></STRONG></A>

<H1><font color="black">Signature</font></H1>
<center>
<table BORDER=4 CELLPADDING=10 CELLSPACING=1>

    <tr>
    <th>
    <font color="crimson">Constant</font>
    <th>
    <font color="crimson">Type</font><tr><td>
                                         <STRONG><font color="black">##</font></STRONG>
                                         <td>
                                         :real -> real list -> real list
    <tr><td>
        <STRONG><font color="black">poly_order</font></STRONG>
        <td>
        :real -> real list -> num
    <tr><td>
        <STRONG><font color="black">poly_diff_aux</font></STRONG>
        <td>
        :num -> real list -> real list
    <tr><td>
        <STRONG><font color="black">poly_divides</font></STRONG>
        <td>
        :real list -> real list -> bool
    <tr><td>
        <STRONG><font color="black">poly_add</font></STRONG>
        <td>
        :real list -> real list -> real list
    <tr><td>
        <STRONG><font color="black">diff</font></STRONG>
        <td>
        :real list -> real list
    <tr><td>
        <STRONG><font color="black">poly_exp</font></STRONG>
        <td>
        :real list -> num -> real list
    <tr><td>
        <STRONG><font color="black">poly_neg</font></STRONG>
        <td>
        :real list -> real list
    <tr><td>
        <STRONG><font color="black">poly_mul</font></STRONG>
        <td>
        :real list -> real list -> real list
    <tr><td>
        <STRONG><font color="black">normalize</font></STRONG>
        <td>
        :real list -> real list
    <tr><td>
        <STRONG><font color="black">degree</font></STRONG>
        <td>
        :real list -> num
    <tr><td>
        <STRONG><font color="black">rsquarefree</font></STRONG>
        <td>
        :real list -> bool
    <tr><td>
        <STRONG><font color="black">poly</font></STRONG>
        <td>
        :real list -> real -> real
    
</table>
</center>

<H1><font color="black">Definitions</font></H1>
<DL>
<DT><STRONG><font color="black">poly_def</font></STRONG>
<DD>
<PRE>
|- (!x. poly [] x = 0) /\ !h t x. poly (h::t) x = h + x * poly t x
</PRE>

<DT><STRONG><font color="black">poly_add_def</font></STRONG>
<DD>
<PRE>
|- (!l2. [] + l2 = l2) /\
   !h t l2. (h::t) + l2 = (if l2 = [] then h::t else h + HD l2::t + TL l2)
</PRE>

<DT><STRONG><font color="black">poly_cmul_def</font></STRONG>
<DD>
<PRE>
|- (!c. c ## [] = []) /\ !c h t. c ## (h::t) = c * h::c ## t
</PRE>

<DT><STRONG><font color="black">poly_neg_def</font></STRONG>
<DD>
<PRE>
|- $~ = $## ~1
</PRE>

<DT><STRONG><font color="black">poly_mul_def</font></STRONG>
<DD>
<PRE>
|- (!l2. [] * l2 = []) /\
   !h t l2. (h::t) * l2 = (if t = [] then h ## l2 else h ## l2 + (0::t * l2))
</PRE>

<DT><STRONG><font color="black">poly_exp_def</font></STRONG>
<DD>
<PRE>
|- (!p. p poly_exp 0 = [1]) /\ !p n. p poly_exp SUC n = p * p poly_exp n
</PRE>

<DT><STRONG><font color="black">poly_diff_aux_def</font></STRONG>
<DD>
<PRE>
|- (!n. poly_diff_aux n [] = []) /\
   !n h t. poly_diff_aux n (h::t) = $& n * h::poly_diff_aux (SUC n) t
</PRE>

<DT><STRONG><font color="black">poly_diff_def</font></STRONG>
<DD>
<PRE>
|- !l. diff l = (if l = [] then [] else poly_diff_aux 1 (TL l))
</PRE>

<DT><STRONG><font color="black">poly_divides</font></STRONG>
<DD>
<PRE>
|- !p1 p2. p1 poly_divides p2 = ?q. poly p2 = poly (p1 * q)
</PRE>

<DT><STRONG><font color="black">poly_order</font></STRONG>
<DD>
<PRE>
|- !a p.
     poly_order a p =
     @n.
       [~a; 1] poly_exp n poly_divides p /\
       ~([~a; 1] poly_exp SUC n poly_divides p)
</PRE>

<DT><STRONG><font color="black">rsquarefree</font></STRONG>
<DD>
<PRE>
|- !p.
     rsquarefree p =
     ~(poly p = poly []) /\ !a. (poly_order a p = 0) \/ (poly_order a p = 1)
</PRE>

<DT><STRONG><font color="black">normalize</font></STRONG>
<DD>
<PRE>
|- (normalize [] = []) /\
   !h t.
     normalize (h::t) =
     (if normalize t = [] then
        (if h = 0 then [] else [h])
      else
        h::normalize t)
</PRE>

<DT><STRONG><font color="black">degree</font></STRONG>
<DD>
<PRE>
|- !p. degree p = PRE (LENGTH (normalize p))
</PRE>

</DL>


<HR>

<HR>
<H1><font color="black">Theorems</font></H1>
<DL>
<DT><STRONG><font color="black">POLY_ADD_CLAUSES</font></STRONG>
<DD>
<PRE>
|- ([] + p2 = p2) /\ (p1 + [] = p1) /\
   ((h1::t1) + (h2::t2) = h1 + h2::t1 + t2)
</PRE>

<DT><STRONG><font color="black">POLY_CMUL_CLAUSES</font></STRONG>
<DD>
<PRE>
|- (c ## [] = []) /\ (c ## (h::t) = c * h::c ## t)
</PRE>

<DT><STRONG><font color="black">POLY_NEG_CLAUSES</font></STRONG>
<DD>
<PRE>
|- (~[] = []) /\ (~(h::t) = ~h::~t)
</PRE>

<DT><STRONG><font color="black">POLY_MUL_CLAUSES</font></STRONG>
<DD>
<PRE>
|- ([] * p2 = []) /\ ([h1] * p2 = h1 ## p2) /\
   ((h1::k1::t1) * p2 = h1 ## p2 + (0::(k1::t1) * p2))
</PRE>

<DT><STRONG><font color="black">POLY_DIFF_CLAUSES</font></STRONG>
<DD>
<PRE>
|- (diff [] = []) /\ (diff [c] = []) /\ (diff (h::t) = poly_diff_aux 1 t)
</PRE>

<DT><STRONG><font color="black">POLY_ADD</font></STRONG>
<DD>
<PRE>
|- !p1 p2 x. poly (p1 + p2) x = poly p1 x + poly p2 x
</PRE>

<DT><STRONG><font color="black">POLY_CMUL</font></STRONG>
<DD>
<PRE>
|- !p c x. poly (c ## p) x = c * poly p x
</PRE>

<DT><STRONG><font color="black">POLY_NEG</font></STRONG>
<DD>
<PRE>
|- !p x. poly (~p) x = ~poly p x
</PRE>

<DT><STRONG><font color="black">POLY_MUL</font></STRONG>
<DD>
<PRE>
|- !x p1 p2. poly (p1 * p2) x = poly p1 x * poly p2 x
</PRE>

<DT><STRONG><font color="black">POLY_EXP</font></STRONG>
<DD>
<PRE>
|- !p n x. poly (p poly_exp n) x = poly p x pow n
</PRE>

<DT><STRONG><font color="black">POLY_DIFF_LEMMA</font></STRONG>
<DD>
<PRE>
|- !l n x.
     ((\x. x pow SUC n * poly l x) diffl
      (x pow n * poly (poly_diff_aux (SUC n) l) x)) x
</PRE>

<DT><STRONG><font color="black">POLY_DIFF</font></STRONG>
<DD>
<PRE>
|- !l x. ((\x. poly l x) diffl poly (diff l) x) x
</PRE>

<DT><STRONG><font color="black">POLY_DIFFERENTIABLE</font></STRONG>
<DD>
<PRE>
|- !l x. (\x. poly l x) differentiable x
</PRE>

<DT><STRONG><font color="black">POLY_CONT</font></STRONG>
<DD>
<PRE>
|- !l x. (\x. poly l x) contl x
</PRE>

<DT><STRONG><font color="black">POLY_IVT_POS</font></STRONG>
<DD>
<PRE>
|- !p a b.
     a < b /\ poly p a < 0 /\ poly p b > 0 ==>
     ?x. a < x /\ x < b /\ (poly p x = 0)
</PRE>

<DT><STRONG><font color="black">POLY_IVT_NEG</font></STRONG>
<DD>
<PRE>
|- !p a b.
     a < b /\ poly p a > 0 /\ poly p b < 0 ==>
     ?x. a < x /\ x < b /\ (poly p x = 0)
</PRE>

<DT><STRONG><font color="black">POLY_MVT</font></STRONG>
<DD>
<PRE>
|- !p a b.
     a < b ==>
     ?x. a < x /\ x < b /\ (poly p b - poly p a = (b - a) * poly (diff p) x)
</PRE>

<DT><STRONG><font color="black">POLY_ADD_RZERO</font></STRONG>
<DD>
<PRE>
|- !p. poly (p + []) = poly p
</PRE>

<DT><STRONG><font color="black">POLY_MUL_ASSOC</font></STRONG>
<DD>
<PRE>
|- !p q r. poly (p * (q * r)) = poly (p * q * r)
</PRE>

<DT><STRONG><font color="black">POLY_EXP_ADD</font></STRONG>
<DD>
<PRE>
|- !d n p. poly (p poly_exp (n + d)) = poly (p poly_exp n * p poly_exp d)
</PRE>

<DT><STRONG><font color="black">POLY_DIFF_AUX_ADD</font></STRONG>
<DD>
<PRE>
|- !p1 p2 n.
     poly (poly_diff_aux n (p1 + p2)) =
     poly (poly_diff_aux n p1 + poly_diff_aux n p2)
</PRE>

<DT><STRONG><font color="black">POLY_DIFF_AUX_CMUL</font></STRONG>
<DD>
<PRE>
|- !p c n. poly (poly_diff_aux n (c ## p)) = poly (c ## poly_diff_aux n p)
</PRE>

<DT><STRONG><font color="black">POLY_DIFF_AUX_NEG</font></STRONG>
<DD>
<PRE>
|- !p n. poly (poly_diff_aux n ~p) = poly ~poly_diff_aux n p
</PRE>

<DT><STRONG><font color="black">POLY_DIFF_AUX_MUL_LEMMA</font></STRONG>
<DD>
<PRE>
|- !p n. poly (poly_diff_aux (SUC n) p) = poly (poly_diff_aux n p + p)
</PRE>

<DT><STRONG><font color="black">POLY_DIFF_ADD</font></STRONG>
<DD>
<PRE>
|- !p1 p2. poly (diff (p1 + p2)) = poly (diff p1 + diff p2)
</PRE>

<DT><STRONG><font color="black">POLY_DIFF_CMUL</font></STRONG>
<DD>
<PRE>
|- !p c. poly (diff (c ## p)) = poly (c ## diff p)
</PRE>

<DT><STRONG><font color="black">POLY_DIFF_NEG</font></STRONG>
<DD>
<PRE>
|- !p. poly (diff ~p) = poly ~diff p
</PRE>

<DT><STRONG><font color="black">POLY_DIFF_MUL_LEMMA</font></STRONG>
<DD>
<PRE>
|- !t h. poly (diff (h::t)) = poly ((0::diff t) + t)
</PRE>

<DT><STRONG><font color="black">POLY_DIFF_MUL</font></STRONG>
<DD>
<PRE>
|- !p1 p2. poly (diff (p1 * p2)) = poly (p1 * diff p2 + diff p1 * p2)
</PRE>

<DT><STRONG><font color="black">POLY_DIFF_EXP</font></STRONG>
<DD>
<PRE>
|- !p n.
     poly (diff (p poly_exp SUC n)) =
     poly ($& (SUC n) ## p poly_exp n * diff p)
</PRE>

<DT><STRONG><font color="black">POLY_DIFF_EXP_PRIME</font></STRONG>
<DD>
<PRE>
|- !n a.
     poly (diff ([~a; 1] poly_exp SUC n)) =
     poly ($& (SUC n) ## [~a; 1] poly_exp n)
</PRE>

<DT><STRONG><font color="black">POLY_LINEAR_REM</font></STRONG>
<DD>
<PRE>
|- !t h. ?q r. h::t = [r] + [~a; 1] * q
</PRE>

<DT><STRONG><font color="black">POLY_LINEAR_DIVIDES</font></STRONG>
<DD>
<PRE>
|- !a p. (poly p a = 0) = (p = []) \/ ?q. p = [~a; 1] * q
</PRE>

<DT><STRONG><font color="black">POLY_LENGTH_MUL</font></STRONG>
<DD>
<PRE>
|- !q. LENGTH ([~a; 1] * q) = SUC (LENGTH q)
</PRE>

<DT><STRONG><font color="black">POLY_ROOTS_INDEX_LEMMA</font></STRONG>
<DD>
<PRE>
|- !n p.
     ~(poly p = poly []) /\ (LENGTH p = n) ==>
     ?i. !x. (poly p x = 0) ==> ?m. m <= n /\ (x = i m)
</PRE>

<DT><STRONG><font color="black">POLY_ROOTS_INDEX_LENGTH</font></STRONG>
<DD>
<PRE>
|- !p.
     ~(poly p = poly []) ==>
     ?i. !x. (poly p x = 0) ==> ?n. n <= LENGTH p /\ (x = i n)
</PRE>

<DT><STRONG><font color="black">POLY_ROOTS_FINITE_LEMMA</font></STRONG>
<DD>
<PRE>
|- !p.
     ~(poly p = poly []) ==>
     ?N i. !x. (poly p x = 0) ==> ?n. n < N /\ (x = i n)
</PRE>

<DT><STRONG><font color="black">FINITE_LEMMA</font></STRONG>
<DD>
<PRE>
|- !i N P. (!x. P x ==> ?n. n < N /\ (x = i n)) ==> ?a. !x. P x ==> x < a
</PRE>

<DT><STRONG><font color="black">POLY_ROOTS_FINITE</font></STRONG>
<DD>
<PRE>
|- !p.
     ~(poly p = poly []) = ?N i. !x. (poly p x = 0) ==> ?n. n < N /\ (x = i n)
</PRE>

<DT><STRONG><font color="black">POLY_ENTIRE_LEMMA</font></STRONG>
<DD>
<PRE>
|- !p q.
     ~(poly p = poly []) /\ ~(poly q = poly []) ==> ~(poly (p * q) = poly [])
</PRE>

<DT><STRONG><font color="black">POLY_ENTIRE</font></STRONG>
<DD>
<PRE>
|- !p q. (poly (p * q) = poly []) = (poly p = poly []) \/ (poly q = poly [])
</PRE>

<DT><STRONG><font color="black">POLY_MUL_LCANCEL</font></STRONG>
<DD>
<PRE>
|- !p q r.
     (poly (p * q) = poly (p * r)) = (poly p = poly []) \/ (poly q = poly r)
</PRE>

<DT><STRONG><font color="black">POLY_EXP_EQ_0</font></STRONG>
<DD>
<PRE>
|- !p n. (poly (p poly_exp n) = poly []) = (poly p = poly []) /\ ~(n = 0)
</PRE>

<DT><STRONG><font color="black">POLY_PRIME_EQ_0</font></STRONG>
<DD>
<PRE>
|- !a. ~(poly [a; 1] = poly [])
</PRE>

<DT><STRONG><font color="black">POLY_EXP_PRIME_EQ_0</font></STRONG>
<DD>
<PRE>
|- !a n. ~(poly ([a; 1] poly_exp n) = poly [])
</PRE>

<DT><STRONG><font color="black">POLY_ZERO_LEMMA</font></STRONG>
<DD>
<PRE>
|- !h t. (poly (h::t) = poly []) ==> (h = 0) /\ (poly t = poly [])
</PRE>

<DT><STRONG><font color="black">POLY_ZERO</font></STRONG>
<DD>
<PRE>
|- !p. (poly p = poly []) = ALL_EL (\c. c = 0) p
</PRE>

<DT><STRONG><font color="black">POLY_DIFF_AUX_ISZERO</font></STRONG>
<DD>
<PRE>
|- !p n. ALL_EL (\c. c = 0) (poly_diff_aux (SUC n) p) = ALL_EL (\c. c = 0) p
</PRE>

<DT><STRONG><font color="black">POLY_DIFF_ISZERO</font></STRONG>
<DD>
<PRE>
|- !p. (poly (diff p) = poly []) ==> ?h. poly p = poly [h]
</PRE>

<DT><STRONG><font color="black">POLY_DIFF_ZERO</font></STRONG>
<DD>
<PRE>
|- !p. (poly p = poly []) ==> (poly (diff p) = poly [])
</PRE>

<DT><STRONG><font color="black">POLY_DIFF_WELLDEF</font></STRONG>
<DD>
<PRE>
|- !p q. (poly p = poly q) ==> (poly (diff p) = poly (diff q))
</PRE>

<DT><STRONG><font color="black">POLY_PRIMES</font></STRONG>
<DD>
<PRE>
|- !a p q.
     [a; 1] poly_divides p * q =
     [a; 1] poly_divides p \/ [a; 1] poly_divides q
</PRE>

<DT><STRONG><font color="black">POLY_DIVIDES_REFL</font></STRONG>
<DD>
<PRE>
|- !p. p poly_divides p
</PRE>

<DT><STRONG><font color="black">POLY_DIVIDES_TRANS</font></STRONG>
<DD>
<PRE>
|- !p q r. p poly_divides q /\ q poly_divides r ==> p poly_divides r
</PRE>

<DT><STRONG><font color="black">POLY_DIVIDES_EXP</font></STRONG>
<DD>
<PRE>
|- !p m n. m <= n ==> p poly_exp m poly_divides p poly_exp n
</PRE>

<DT><STRONG><font color="black">POLY_EXP_DIVIDES</font></STRONG>
<DD>
<PRE>
|- !p q m n.
     p poly_exp n poly_divides q /\ m <= n ==> p poly_exp m poly_divides q
</PRE>

<DT><STRONG><font color="black">POLY_DIVIDES_ADD</font></STRONG>
<DD>
<PRE>
|- !p q r. p poly_divides q /\ p poly_divides r ==> p poly_divides q + r
</PRE>

<DT><STRONG><font color="black">POLY_DIVIDES_SUB</font></STRONG>
<DD>
<PRE>
|- !p q r. p poly_divides q /\ p poly_divides q + r ==> p poly_divides r
</PRE>

<DT><STRONG><font color="black">POLY_DIVIDES_SUB2</font></STRONG>
<DD>
<PRE>
|- !p q r. p poly_divides r /\ p poly_divides q + r ==> p poly_divides q
</PRE>

<DT><STRONG><font color="black">POLY_DIVIDES_ZERO</font></STRONG>
<DD>
<PRE>
|- !p q. (poly p = poly []) ==> q poly_divides p
</PRE>

<DT><STRONG><font color="black">POLY_ORDER_EXISTS</font></STRONG>
<DD>
<PRE>
|- !a d p.
     (LENGTH p = d) /\ ~(poly p = poly []) ==>
     ?n.
       [~a; 1] poly_exp n poly_divides p /\
       ~([~a; 1] poly_exp SUC n poly_divides p)
</PRE>

<DT><STRONG><font color="black">POLY_ORDER</font></STRONG>
<DD>
<PRE>
|- !p a.
     ~(poly p = poly []) ==>
     ?!n.
       [~a; 1] poly_exp n poly_divides p /\
       ~([~a; 1] poly_exp SUC n poly_divides p)
</PRE>

<DT><STRONG><font color="black">ORDER</font></STRONG>
<DD>
<PRE>
|- !p a n.
     [~a; 1] poly_exp n poly_divides p /\
     ~([~a; 1] poly_exp SUC n poly_divides p) =
     (n = poly_order a p) /\ ~(poly p = poly [])
</PRE>

<DT><STRONG><font color="black">ORDER_THM</font></STRONG>
<DD>
<PRE>
|- !p a.
     ~(poly p = poly []) ==>
     [~a; 1] poly_exp poly_order a p poly_divides p /\
     ~([~a; 1] poly_exp SUC (poly_order a p) poly_divides p)
</PRE>

<DT><STRONG><font color="black">ORDER_UNIQUE</font></STRONG>
<DD>
<PRE>
|- !p a n.
     ~(poly p = poly []) /\ [~a; 1] poly_exp n poly_divides p /\
     ~([~a; 1] poly_exp SUC n poly_divides p) ==>
     (n = poly_order a p)
</PRE>

<DT><STRONG><font color="black">ORDER_POLY</font></STRONG>
<DD>
<PRE>
|- !p q a. (poly p = poly q) ==> (poly_order a p = poly_order a q)
</PRE>

<DT><STRONG><font color="black">ORDER_ROOT</font></STRONG>
<DD>
<PRE>
|- !p a. (poly p a = 0) = (poly p = poly []) \/ ~(poly_order a p = 0)
</PRE>

<DT><STRONG><font color="black">ORDER_DIVIDES</font></STRONG>
<DD>
<PRE>
|- !p a n.
     [~a; 1] poly_exp n poly_divides p =
     (poly p = poly []) \/ n <= poly_order a p
</PRE>

<DT><STRONG><font color="black">ORDER_DECOMP</font></STRONG>
<DD>
<PRE>
|- !p a.
     ~(poly p = poly []) ==>
     ?q.
       (poly p = poly ([~a; 1] poly_exp poly_order a p * q)) /\
       ~([~a; 1] poly_divides q)
</PRE>

<DT><STRONG><font color="black">ORDER_MUL</font></STRONG>
<DD>
<PRE>
|- !a p q.
     ~(poly (p * q) = poly []) ==>
     (poly_order a (p * q) = poly_order a p + poly_order a q)
</PRE>

<DT><STRONG><font color="black">ORDER_DIFF</font></STRONG>
<DD>
<PRE>
|- !p a.
     ~(poly (diff p) = poly []) /\ ~(poly_order a p = 0) ==>
     (poly_order a p = SUC (poly_order a (diff p)))
</PRE>

<DT><STRONG><font color="black">POLY_SQUAREFREE_DECOMP_ORDER</font></STRONG>
<DD>
<PRE>
|- !p q d e r s.
     ~(poly (diff p) = poly []) /\ (poly p = poly (q * d)) /\
     (poly (diff p) = poly (e * d)) /\
     (poly d = poly (r * p + s * diff p)) ==>
     !a. poly_order a q = (if poly_order a p = 0 then 0 else 1)
</PRE>

<DT><STRONG><font color="black">RSQUAREFREE_ROOTS</font></STRONG>
<DD>
<PRE>
|- !p. rsquarefree p = !a. ~((poly p a = 0) /\ (poly (diff p) a = 0))
</PRE>

<DT><STRONG><font color="black">RSQUAREFREE_DECOMP</font></STRONG>
<DD>
<PRE>
|- !p a.
     rsquarefree p /\ (poly p a = 0) ==>
     ?q. (poly p = poly ([~a; 1] * q)) /\ ~(poly q a = 0)
</PRE>

<DT><STRONG><font color="black">POLY_SQUAREFREE_DECOMP</font></STRONG>
<DD>
<PRE>
|- !p q d e r s.
     ~(poly (diff p) = poly []) /\ (poly p = poly (q * d)) /\
     (poly (diff p) = poly (e * d)) /\
     (poly d = poly (r * p + s * diff p)) ==>
     rsquarefree q /\ !a. (poly q a = 0) = (poly p a = 0)
</PRE>

<DT><STRONG><font color="black">POLY_NORMALIZE</font></STRONG>
<DD>
<PRE>
|- !p. poly (normalize p) = poly p
</PRE>

<DT><STRONG><font color="black">DEGREE_ZERO</font></STRONG>
<DD>
<PRE>
|- !p. (poly p = poly []) ==> (degree p = 0)
</PRE>

<DT><STRONG><font color="black">POLY_ROOTS_FINITE_SET</font></STRONG>
<DD>
<PRE>
|- !p. ~(poly p = poly []) ==> FINITE {x | poly p x = 0}
</PRE>

<DT><STRONG><font color="black">POLY_MONO</font></STRONG>
<DD>
<PRE>
|- !x k p. abs x <= k ==> abs (poly p x) <= poly (MAP abs p) k
</PRE>

</DL>



<HR>
</BODY>
</HTML>
