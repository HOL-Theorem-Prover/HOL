(* x64Script.sml - generated by L3 - Thu Dec 21 10:44:50 2017 *)
open HolKernel boolLib bossLib Import

val () = Import.start "x64"

val _ = Construct
  [("Zreg",
    [("RAX",[]),("RCX",[]),("RDX",[]),("RBX",[]),("RSP",[]),("RBP",[]),
     ("RSI",[]),("RDI",[]),("zR8",[]),("zR9",[]),("zR10",[]),("zR11",[]),
     ("zR12",[]),("zR13",[]),("zR14",[]),("zR15",[])])]
;
val _ = Record
  ("MXCSR",
   [("DAZ",bTy),("DE",bTy),("DM",bTy),("FZ",bTy),("IE",bTy),("IM",bTy),
    ("OE",bTy),("OM",bTy),("PE",bTy),("PM",bTy),("RC",FTy 2),
    ("Reserved",F16),("UE",bTy),("UM",bTy),("ZE",bTy),("ZM",bTy)])
;
val _ = Construct
  [("Zeflags",
    [("Z_CF",[]),("Z_PF",[]),("Z_AF",[]),("Z_ZF",[]),("Z_SF",[]),
     ("Z_OF",[])])]
;
val _ = Construct
  [("Zsize",[("Z16",[]),("Z32",[]),("Z64",[]),("Z8",[bTy])])]
;
val _ = Construct
  [("Zbase",[("ZnoBase",[]),("ZregBase",[CTy"Zreg"]),("ZripBase",[])])]
;
val _ = Construct
  [("Zrm",
    [("Zm",[PTy(OTy(PTy(FTy 2,CTy"Zreg")),PTy(CTy"Zbase",F64))]),
     ("Zr",[CTy"Zreg"])])]
;
val _ = Construct
  [("Zdest_src",
    [("Zr_rm",[PTy(CTy"Zreg",CTy"Zrm")]),("Zrm_i",[PTy(CTy"Zrm",F64)]),
     ("Zrm_r",[PTy(CTy"Zrm",CTy"Zreg")])])]
;
val _ = Construct [("Zimm_rm",[("Zimm",[F64]),("Zrm",[CTy"Zrm"])])]
;
val _ = Construct
  [("Zmonop_name",[("Zdec",[]),("Zinc",[]),("Znot",[]),("Zneg",[])])]
;
val _ = Construct
  [("Zbinop_name",
    [("Zadd",[]),("Zor",[]),("Zadc",[]),("Zsbb",[]),("Zand",[]),
     ("Zsub",[]),("Zxor",[]),("Zcmp",[]),("Zrol",[]),("Zror",[]),
     ("Zrcl",[]),("Zrcr",[]),("Zshl",[]),("Zshr",[]),("Ztest",[]),
     ("Zsar",[])])]
;
val _ = Construct
  [("Zbit_test_name",[("Zbt",[]),("Zbts",[]),("Zbtr",[]),("Zbtc",[])])]
;
val _ = Construct
  [("Zcond",
    [("Z_O",[]),("Z_NO",[]),("Z_B",[]),("Z_NB",[]),("Z_E",[]),("Z_NE",[]),
     ("Z_NA",[]),("Z_A",[]),("Z_S",[]),("Z_NS",[]),("Z_P",[]),("Z_NP",[]),
     ("Z_L",[]),("Z_NL",[]),("Z_NG",[]),("Z_G",[]),("Z_ALWAYS",[])])]
;
val _ = Construct
  [("Zea",
    [("Zea_i",[PTy(CTy"Zsize",F64)]),("Zea_m",[PTy(CTy"Zsize",F64)]),
     ("Zea_r",[PTy(CTy"Zsize",CTy"Zreg")])])]
;
val _ = Construct
  [("sse_binop",
    [("sse_add",[]),("sse_sub",[]),("sse_mul",[]),("sse_div",[]),
     ("sse_max",[]),("sse_min",[])])]
;
val _ = Construct
  [("sse_logic",
    [("sse_and",[]),("sse_andn",[]),("sse_or",[]),("sse_xor",[])])]
;
val _ = Construct
  [("sse_compare",
    [("sse_eq_oq",[]),("sse_lt_os",[]),("sse_le_os",[]),
     ("sse_unord_q",[]),("sse_neq_uq",[]),("sse_nlt_us",[]),
     ("sse_nle_us",[]),("sse_ord_q",[])])]
;
val _ = Construct
  [("xmm_mem",
    [("xmm_mem",[PTy(OTy(PTy(FTy 2,CTy"Zreg")),PTy(CTy"Zbase",F64))]),
     ("xmm_reg",[FTy 3])])]
;
val _ = Construct
  [("SSE",
    [("CMPPD",[PTy(CTy"sse_compare",PTy(FTy 3,CTy"xmm_mem"))]),
     ("CMPPS",[PTy(CTy"sse_compare",PTy(FTy 3,CTy"xmm_mem"))]),
     ("CMPSD",[PTy(CTy"sse_compare",PTy(FTy 3,CTy"xmm_mem"))]),
     ("CMPSS",[PTy(CTy"sse_compare",PTy(FTy 3,CTy"xmm_mem"))]),
     ("COMISD",[PTy(FTy 3,CTy"xmm_mem")]),
     ("COMISS",[PTy(FTy 3,CTy"xmm_mem")]),
     ("CVTDQ2PD",[PTy(FTy 3,CTy"xmm_mem")]),
     ("CVTDQ2PS",[PTy(FTy 3,CTy"xmm_mem")]),
     ("CVTPD2DQ",[PTy(bTy,PTy(FTy 3,CTy"xmm_mem"))]),
     ("CVTPD2PS",[PTy(FTy 3,CTy"xmm_mem")]),
     ("CVTPS2DQ",[PTy(bTy,PTy(FTy 3,CTy"xmm_mem"))]),
     ("CVTPS2PD",[PTy(FTy 3,CTy"xmm_mem")]),
     ("CVTSD2SI",[PTy(bTy,PTy(bTy,PTy(CTy"Zreg",CTy"xmm_mem")))]),
     ("CVTSD2SS",[PTy(FTy 3,CTy"xmm_mem")]),
     ("CVTSI2SD",[PTy(bTy,PTy(FTy 3,CTy"Zrm"))]),
     ("CVTSI2SS",[PTy(bTy,PTy(FTy 3,CTy"Zrm"))]),
     ("CVTSS2SD",[PTy(FTy 3,CTy"xmm_mem")]),
     ("CVTSS2SI",[PTy(bTy,PTy(bTy,PTy(CTy"Zreg",CTy"xmm_mem")))]),
     ("MOVAP_D_S",[PTy(bTy,PTy(CTy"xmm_mem",CTy"xmm_mem"))]),
     ("MOVQ",[PTy(CTy"xmm_mem",CTy"xmm_mem")]),
     ("MOVSD",[PTy(CTy"xmm_mem",CTy"xmm_mem")]),
     ("MOVSS",[PTy(CTy"xmm_mem",CTy"xmm_mem")]),
     ("MOVUP_D_S",[PTy(bTy,PTy(CTy"xmm_mem",CTy"xmm_mem"))]),
     ("MOV_D_Q",[PTy(bTy,PTy(bTy,PTy(FTy 3,CTy"Zrm")))]),
     ("PCMPEQQ",[PTy(FTy 3,CTy"xmm_mem")]),("PSLLDQ",[PTy(FTy 3,F8)]),
     ("PSLLD_imm",[PTy(FTy 3,F8)]),("PSLLQ_imm",[PTy(FTy 3,F8)]),
     ("PSLLW_imm",[PTy(FTy 3,F8)]),("PSRAD_imm",[PTy(FTy 3,F8)]),
     ("PSRAW_imm",[PTy(FTy 3,F8)]),("PSRLDQ",[PTy(FTy 3,F8)]),
     ("PSRLD_imm",[PTy(FTy 3,F8)]),("PSRLQ_imm",[PTy(FTy 3,F8)]),
     ("PSRLW_imm",[PTy(FTy 3,F8)]),("SQRTPD",[PTy(FTy 3,CTy"xmm_mem")]),
     ("SQRTPS",[PTy(FTy 3,CTy"xmm_mem")]),
     ("SQRTSD",[PTy(FTy 3,CTy"xmm_mem")]),
     ("SQRTSS",[PTy(FTy 3,CTy"xmm_mem")]),
     ("bin_PD",[PTy(CTy"sse_binop",PTy(FTy 3,CTy"xmm_mem"))]),
     ("bin_PS",[PTy(CTy"sse_binop",PTy(FTy 3,CTy"xmm_mem"))]),
     ("bin_SD",[PTy(CTy"sse_binop",PTy(FTy 3,CTy"xmm_mem"))]),
     ("bin_SS",[PTy(CTy"sse_binop",PTy(FTy 3,CTy"xmm_mem"))]),
     ("logic_PD",[PTy(CTy"sse_logic",PTy(FTy 3,CTy"xmm_mem"))]),
     ("logic_PS",[PTy(CTy"sse_logic",PTy(FTy 3,CTy"xmm_mem"))])])]
;
val _ = Construct
  [("instruction",
    [("SSE",[CTy"SSE"]),
     ("Zbinop",[PTy(CTy"Zbinop_name",PTy(CTy"Zsize",CTy"Zdest_src"))]),
     ("Zbit_test",
      [PTy(CTy"Zbit_test_name",PTy(CTy"Zsize",CTy"Zdest_src"))]),
     ("Zcall",[CTy"Zimm_rm"]),("Zclc",[]),("Zcmc",[]),
     ("Zcmpxchg",[PTy(CTy"Zsize",PTy(CTy"Zrm",CTy"Zreg"))]),
     ("Zdiv",[PTy(CTy"Zsize",CTy"Zrm")]),
     ("Zidiv",[PTy(CTy"Zsize",CTy"Zrm")]),
     ("Zimul",[PTy(CTy"Zsize",CTy"Zrm")]),
     ("Zimul2",[PTy(CTy"Zsize",PTy(CTy"Zreg",CTy"Zrm"))]),
     ("Zimul3",[PTy(CTy"Zsize",PTy(CTy"Zreg",PTy(CTy"Zrm",F64)))]),
     ("Zjcc",[PTy(CTy"Zcond",F64)]),("Zjmp",[CTy"Zrm"]),
     ("Zlea",[PTy(CTy"Zsize",CTy"Zdest_src")]),("Zleave",[]),
     ("Zloop",[PTy(CTy"Zcond",F64)]),
     ("Zmonop",[PTy(CTy"Zmonop_name",PTy(CTy"Zsize",CTy"Zrm"))]),
     ("Zmov",[PTy(CTy"Zcond",PTy(CTy"Zsize",CTy"Zdest_src"))]),
     ("Zmovsx",[PTy(CTy"Zsize",PTy(CTy"Zdest_src",CTy"Zsize"))]),
     ("Zmovzx",[PTy(CTy"Zsize",PTy(CTy"Zdest_src",CTy"Zsize"))]),
     ("Zmul",[PTy(CTy"Zsize",CTy"Zrm")]),("Znop",[nTy]),
     ("Zpop",[CTy"Zrm"]),("Zpush",[CTy"Zimm_rm"]),("Zret",[F64]),
     ("Zset",[PTy(CTy"Zcond",PTy(bTy,CTy"Zrm"))]),("Zstc",[]),
     ("Zxadd",[PTy(CTy"Zsize",PTy(CTy"Zrm",CTy"Zreg"))]),
     ("Zxchg",[PTy(CTy"Zsize",PTy(CTy"Zrm",CTy"Zreg"))])])]
;
val _ = Construct
  [("Zinst",
    [("Zdec_fail",[sTy]),
     ("Zfull_inst",[PTy(LTy F8,PTy(CTy"instruction",OTy(LTy F8)))])])]
;
val _ = Record ("REX",[("B",bTy),("R",bTy),("W",bTy),("X",bTy)])
;
val _ = Construct
  [("exception",
    [("BadFlagAccess",[sTy]),("FAILURE",[sTy]),
     ("INTERRUPT_EXCEPTION",[F8]),("NoException",[])])]
;
val _ = Record
  ("x64_state",
   [("EFLAGS",ATy(CTy"Zeflags",OTy bTy)),("MEM",ATy(F64,F8)),
    ("MXCSR",CTy"MXCSR"),("REG",ATy(CTy"Zreg",F64)),("RIP",F64),
    ("XMM_REG",ATy(FTy 3,FTy 128)),("exception",CTy"exception")])
;
val qTy = CTy "x64_state";
fun qVar v = Term.mk_var (v, ParseDatatype.pretypeToType qTy);
val raise'exception_def = Def
  ("raise'exception",Var("e",CTy"exception"),
   Close
     (qVar"state",
      TP[LX(VTy"a"),
         ITE(EQ(Dest("exception",CTy"exception",qVar"state"),
                Const("NoException",CTy"exception")),
             Rupd("exception",TP[qVar"state",Var("e",CTy"exception")]),
             qVar"state")]))
;
val DE_exception_def = Def
  ("DE_exception",qVar"state",
   Mop(Snd,
       Apply
         (Call
            ("raise'exception",ATy(qTy,PTy(uTy,qTy)),
             Call("INTERRUPT_EXCEPTION",CTy"exception",LW(0,8))),
          qVar"state")))
;
val UD_exception_def = Def
  ("UD_exception",qVar"state",
   Mop(Snd,
       Apply
         (Call
            ("raise'exception",ATy(qTy,PTy(uTy,qTy)),
             Call("INTERRUPT_EXCEPTION",CTy"exception",LW(6,8))),
          qVar"state")))
;
val GP_exception_def = Def
  ("GP_exception",qVar"state",
   Mop(Snd,
       Apply
         (Call
            ("raise'exception",ATy(qTy,PTy(uTy,qTy)),
             Call("INTERRUPT_EXCEPTION",CTy"exception",LW(13,8))),
          qVar"state")))
;
val XM_exception_def = Def
  ("XM_exception",qVar"state",
   Mop(Snd,
       Apply
         (Call
            ("raise'exception",ATy(qTy,PTy(uTy,qTy)),
             Call("INTERRUPT_EXCEPTION",CTy"exception",LW(19,8))),
          qVar"state")))
;
val rec'MXCSR_def = Def
  ("rec'MXCSR",Var("x",F32),
   Rec(CTy"MXCSR",
       [Bop(Bit,Var("x",F32),LN 6),Bop(Bit,Var("x",F32),LN 1),
        Bop(Bit,Var("x",F32),LN 8),Bop(Bit,Var("x",F32),LN 15),
        Bop(Bit,Var("x",F32),LN 0),Bop(Bit,Var("x",F32),LN 7),
        Bop(Bit,Var("x",F32),LN 3),Bop(Bit,Var("x",F32),LN 10),
        Bop(Bit,Var("x",F32),LN 5),Bop(Bit,Var("x",F32),LN 12),
        EX(Var("x",F32),LN 14,LN 13,FTy 2),
        EX(Var("x",F32),LN 31,LN 16,F16),Bop(Bit,Var("x",F32),LN 4),
        Bop(Bit,Var("x",F32),LN 11),Bop(Bit,Var("x",F32),LN 2),
        Bop(Bit,Var("x",F32),LN 9)]))
;
val reg'MXCSR_def = Def
  ("reg'MXCSR",Var("x",CTy"MXCSR"),
   CS(Var("x",CTy"MXCSR"),
      [(Rec(CTy"MXCSR",
            [bVar"DAZ",bVar"DE",bVar"DM",bVar"FZ",bVar"IE",bVar"IM",
             bVar"OE",bVar"OM",bVar"PE",bVar"PM",Var("RC",FTy 2),
             Var("Reserved",F16),bVar"UE",bVar"UM",bVar"ZE",bVar"ZM"]),
        CC[Var("Reserved",F16),Mop(Cast F1,bVar"FZ"),Var("RC",FTy 2),
           Mop(Cast F1,bVar"PM"),Mop(Cast F1,bVar"UM"),
           Mop(Cast F1,bVar"OM"),Mop(Cast F1,bVar"ZM"),
           Mop(Cast F1,bVar"DM"),Mop(Cast F1,bVar"IM"),
           Mop(Cast F1,bVar"DAZ"),Mop(Cast F1,bVar"PE"),
           Mop(Cast F1,bVar"UE"),Mop(Cast F1,bVar"OE"),
           Mop(Cast F1,bVar"ZE"),Mop(Cast F1,bVar"DE"),
           Mop(Cast F1,bVar"IE")])]))
;
val write'rec'MXCSR_def = Def
  ("write'rec'MXCSR",TP[AVar F32,Var("x",CTy"MXCSR")],
   Call("reg'MXCSR",F32,Var("x",CTy"MXCSR")))
;
val write'reg'MXCSR_def = Def
  ("write'reg'MXCSR",TP[AVar(CTy"MXCSR"),Var("x",F32)],
   Call("rec'MXCSR",CTy"MXCSR",Var("x",F32)))
;
val mem8_def = Def
  ("mem8",Var("addr",F64),
   Close
     (qVar"state",
      Apply(Dest("MEM",ATy(F64,F8),qVar"state"),Var("addr",F64))))
;
val write'mem8_def = Def
  ("write'mem8",TP[Var("b",F8),Var("addr",F64)],
   Close
     (qVar"state",
      Rupd
        ("MEM",
         TP[qVar"state",
            Fupd
              (Dest("MEM",ATy(F64,F8),qVar"state"),Var("addr",F64),
               Var("b",F8))])))
;
val mem16_def = Def
  ("mem16",Var("addr",F64),
   Close
     (qVar"state",
      CC[Apply
           (Call("mem8",ATy(qTy,F8),Bop(Add,Var("addr",F64),LW(1,64))),
            qVar"state"),
         Apply(Call("mem8",ATy(qTy,F8),Var("addr",F64)),qVar"state")]))
;
val write'mem16_def = Def
  ("write'mem16",TP[Var("w",F16),Var("addr",F64)],
   Close
     (qVar"state",
      Apply
        (Call
           ("write'mem8",ATy(qTy,qTy),
            TP[EX(Var("w",F16),LN 15,LN 8,F8),
               Bop(Add,Var("addr",F64),LW(1,64))]),
         Apply
           (Call
              ("write'mem8",ATy(qTy,qTy),
               TP[EX(Var("w",F16),LN 7,LN 0,F8),Var("addr",F64)]),
            qVar"state"))))
;
val mem32_def = Def
  ("mem32",Var("addr",F64),
   Close
     (qVar"state",
      CC[Apply
           (Call("mem16",ATy(qTy,F16),Bop(Add,Var("addr",F64),LW(2,64))),
            qVar"state"),
         Apply(Call("mem16",ATy(qTy,F16),Var("addr",F64)),qVar"state")]))
;
val write'mem32_def = Def
  ("write'mem32",TP[Var("w",F32),Var("addr",F64)],
   Close
     (qVar"state",
      Apply
        (Call
           ("write'mem16",ATy(qTy,qTy),
            TP[EX(Var("w",F32),LN 31,LN 16,F16),
               Bop(Add,Var("addr",F64),LW(2,64))]),
         Apply
           (Call
              ("write'mem16",ATy(qTy,qTy),
               TP[EX(Var("w",F32),LN 15,LN 0,F16),Var("addr",F64)]),
            qVar"state"))))
;
val mem64_def = Def
  ("mem64",Var("addr",F64),
   Close
     (qVar"state",
      CC[Apply
           (Call("mem32",ATy(qTy,F32),Bop(Add,Var("addr",F64),LW(4,64))),
            qVar"state"),
         Apply(Call("mem32",ATy(qTy,F32),Var("addr",F64)),qVar"state")]))
;
val write'mem64_def = Def
  ("write'mem64",TP[Var("w",F64),Var("addr",F64)],
   Close
     (qVar"state",
      Apply
        (Call
           ("write'mem32",ATy(qTy,qTy),
            TP[EX(Var("w",F64),LN 63,LN 32,F32),
               Bop(Add,Var("addr",F64),LW(4,64))]),
         Apply
           (Call
              ("write'mem32",ATy(qTy,qTy),
               TP[EX(Var("w",F64),LN 31,LN 0,F32),Var("addr",F64)]),
            qVar"state"))))
;
val mem128_def = Def
  ("mem128",Var("addr",F64),
   Close
     (qVar"state",
      CC[Apply
           (Call("mem64",ATy(qTy,F64),Bop(Add,Var("addr",F64),LW(8,64))),
            qVar"state"),
         Apply(Call("mem64",ATy(qTy,F64),Var("addr",F64)),qVar"state")]))
;
val write'mem128_def = Def
  ("write'mem128",TP[Var("w",FTy 128),Var("addr",F64)],
   Close
     (qVar"state",
      Apply
        (Call
           ("write'mem64",ATy(qTy,qTy),
            TP[EX(Var("w",FTy 128),LN 127,LN 64,F64),
               Bop(Add,Var("addr",F64),LW(8,64))]),
         Apply
           (Call
              ("write'mem64",ATy(qTy,qTy),
               TP[EX(Var("w",FTy 128),LN 63,LN 0,F64),Var("addr",F64)]),
            qVar"state"))))
;
val Eflag_def = Def
  ("Eflag",Var("flag",CTy"Zeflags"),
   Close
     (qVar"state",
      CS(Apply
           (Dest("EFLAGS",ATy(CTy"Zeflags",OTy bTy),qVar"state"),
            Var("flag",CTy"Zeflags")),
         [(Mop(Some,bVar"b"),TP[bVar"b",qVar"state"]),
          (LO bTy,
           Apply
             (Call
                ("raise'exception",ATy(qTy,PTy(bTy,qTy)),
                 Call
                   ("BadFlagAccess",CTy"exception",
                    Mop(Cast sTy,Var("flag",CTy"Zeflags")))),qVar"state"))])))
;
val write'Eflag_def = Def
  ("write'Eflag",TP[bVar"b",Var("flag",CTy"Zeflags")],
   Close
     (qVar"state",
      Rupd
        ("EFLAGS",
         TP[qVar"state",
            Fupd
              (Dest("EFLAGS",ATy(CTy"Zeflags",OTy bTy),qVar"state"),
               Var("flag",CTy"Zeflags"),Mop(Some,bVar"b"))])))
;
val FlagUnspecified_def = Def
  ("FlagUnspecified",Var("flag",CTy"Zeflags"),
   Close
     (qVar"state",
      Rupd
        ("EFLAGS",
         TP[qVar"state",
            Fupd
              (Dest("EFLAGS",ATy(CTy"Zeflags",OTy bTy),qVar"state"),
               Var("flag",CTy"Zeflags"),LO bTy)])))
;
val CF_def = Def
  ("CF",qVar"state",
   Apply
     (Call("Eflag",ATy(qTy,PTy(bTy,qTy)),LC("Z_CF",CTy"Zeflags")),
      qVar"state"))
;
val write'CF_def = Def
  ("write'CF",bVar"b",
   Close
     (qVar"state",
      Apply
        (Call
           ("write'Eflag",ATy(qTy,qTy),TP[bVar"b",LC("Z_CF",CTy"Zeflags")]),
         qVar"state")))
;
val PF_def = Def
  ("PF",qVar"state",
   Apply
     (Call("Eflag",ATy(qTy,PTy(bTy,qTy)),LC("Z_PF",CTy"Zeflags")),
      qVar"state"))
;
val write'PF_def = Def
  ("write'PF",bVar"b",
   Close
     (qVar"state",
      Apply
        (Call
           ("write'Eflag",ATy(qTy,qTy),TP[bVar"b",LC("Z_PF",CTy"Zeflags")]),
         qVar"state")))
;
val AF_def = Def
  ("AF",qVar"state",
   Apply
     (Call("Eflag",ATy(qTy,PTy(bTy,qTy)),LC("Z_AF",CTy"Zeflags")),
      qVar"state"))
;
val write'AF_def = Def
  ("write'AF",bVar"b",
   Close
     (qVar"state",
      Apply
        (Call
           ("write'Eflag",ATy(qTy,qTy),TP[bVar"b",LC("Z_AF",CTy"Zeflags")]),
         qVar"state")))
;
val ZF_def = Def
  ("ZF",qVar"state",
   Apply
     (Call("Eflag",ATy(qTy,PTy(bTy,qTy)),LC("Z_ZF",CTy"Zeflags")),
      qVar"state"))
;
val write'ZF_def = Def
  ("write'ZF",bVar"b",
   Close
     (qVar"state",
      Apply
        (Call
           ("write'Eflag",ATy(qTy,qTy),TP[bVar"b",LC("Z_ZF",CTy"Zeflags")]),
         qVar"state")))
;
val SF_def = Def
  ("SF",qVar"state",
   Apply
     (Call("Eflag",ATy(qTy,PTy(bTy,qTy)),LC("Z_SF",CTy"Zeflags")),
      qVar"state"))
;
val write'SF_def = Def
  ("write'SF",bVar"b",
   Close
     (qVar"state",
      Apply
        (Call
           ("write'Eflag",ATy(qTy,qTy),TP[bVar"b",LC("Z_SF",CTy"Zeflags")]),
         qVar"state")))
;
val OF_def = Def
  ("OF",qVar"state",
   Apply
     (Call("Eflag",ATy(qTy,PTy(bTy,qTy)),LC("Z_OF",CTy"Zeflags")),
      qVar"state"))
;
val write'OF_def = Def
  ("write'OF",bVar"b",
   Close
     (qVar"state",
      Apply
        (Call
           ("write'Eflag",ATy(qTy,qTy),TP[bVar"b",LC("Z_OF",CTy"Zeflags")]),
         qVar"state")))
;
val ea_index_def = Def
  ("ea_index",Var("index",OTy(PTy(FTy 2,CTy"Zreg"))),
   Close
     (qVar"state",
      CS(Var("index",OTy(PTy(FTy 2,CTy"Zreg"))),
         [(LO(PTy(FTy 2,CTy"Zreg")),LW(0,64)),
          (Mop(Some,TP[Var("scale",FTy 2),Var("idx",CTy"Zreg")]),
           Bop(Mul,Bop(Lsl,LW(1,64),Mop(Cast nTy,Var("scale",FTy 2))),
               Apply
                 (Dest("REG",ATy(CTy"Zreg",F64),qVar"state"),
                  Var("idx",CTy"Zreg"))))])))
;
val ea_base_def = Def
  ("ea_base",Var("base",CTy"Zbase"),
   Close
     (qVar"state",
      CS(Var("base",CTy"Zbase"),
         [(Const("ZnoBase",CTy"Zbase"),LW(0,64)),
          (Const("ZripBase",CTy"Zbase"),Dest("RIP",F64,qVar"state")),
          (Call("ZregBase",CTy"Zbase",Var("b",CTy"Zreg")),
           Apply
             (Dest("REG",ATy(CTy"Zreg",F64),qVar"state"),
              Var("b",CTy"Zreg")))])))
;
val mem_addr_def = Def
  ("mem_addr",Var("m",PTy(OTy(PTy(FTy 2,CTy"Zreg")),PTy(CTy"Zbase",F64))),
   Close
     (qVar"state",
      Let(TP[Var("index",OTy(PTy(FTy 2,CTy"Zreg"))),
             Var("base",CTy"Zbase"),Var("displacement",F64)],
          Var("m",PTy(OTy(PTy(FTy 2,CTy"Zreg")),PTy(CTy"Zbase",F64))),
          Bop(Add,
              Bop(Add,
                  Apply
                    (Call
                       ("ea_index",ATy(qTy,F64),
                        Var("index",OTy(PTy(FTy 2,CTy"Zreg")))),
                     qVar"state"),
                  Apply
                    (Call("ea_base",ATy(qTy,F64),Var("base",CTy"Zbase")),
                     qVar"state")),Var("displacement",F64)))))
;
val ea_Zrm_def = Def
  ("ea_Zrm",TP[Var("size",CTy"Zsize"),Var("rm",CTy"Zrm")],
   Close
     (qVar"state",
      CS(Var("rm",CTy"Zrm"),
         [(Call("Zr",CTy"Zrm",Var("r",CTy"Zreg")),
           Call
             ("Zea_r",CTy"Zea",
              TP[Var("size",CTy"Zsize"),Var("r",CTy"Zreg")])),
          (Call
             ("Zm",CTy"Zrm",
              Var("m",PTy(OTy(PTy(FTy 2,CTy"Zreg")),PTy(CTy"Zbase",F64)))),
           Call
             ("Zea_m",CTy"Zea",
              TP[Var("size",CTy"Zsize"),
                 Apply
                   (Call
                      ("mem_addr",ATy(qTy,F64),
                       Var("m",
                           PTy(OTy(PTy(FTy 2,CTy"Zreg")),
                               PTy(CTy"Zbase",F64)))),qVar"state")]))])))
;
val ea_Zdest_def = Def
  ("ea_Zdest",TP[Var("size",CTy"Zsize"),Var("ds",CTy"Zdest_src")],
   Close
     (qVar"state",
      CS(Var("ds",CTy"Zdest_src"),
         [(Call("Zrm_i",CTy"Zdest_src",TP[Var("rm",CTy"Zrm"),AVar F64]),
           Apply
             (Call
                ("ea_Zrm",ATy(qTy,CTy"Zea"),
                 TP[Var("size",CTy"Zsize"),Var("rm",CTy"Zrm")]),
              qVar"state")),
          (Call
             ("Zrm_r",CTy"Zdest_src",
              TP[Var("rm",CTy"Zrm"),AVar(CTy"Zreg")]),
           Apply
             (Call
                ("ea_Zrm",ATy(qTy,CTy"Zea"),
                 TP[Var("size",CTy"Zsize"),Var("rm",CTy"Zrm")]),
              qVar"state")),
          (Call
             ("Zr_rm",CTy"Zdest_src",TP[Var("r",CTy"Zreg"),AVar(CTy"Zrm")]),
           Call
             ("Zea_r",CTy"Zea",
              TP[Var("size",CTy"Zsize"),Var("r",CTy"Zreg")]))])))
;
val ea_Zsrc_def = Def
  ("ea_Zsrc",TP[Var("size",CTy"Zsize"),Var("ds",CTy"Zdest_src")],
   Close
     (qVar"state",
      CS(Var("ds",CTy"Zdest_src"),
         [(Call("Zrm_i",CTy"Zdest_src",TP[AVar(CTy"Zrm"),Var("i",F64)]),
           Call("Zea_i",CTy"Zea",TP[Var("size",CTy"Zsize"),Var("i",F64)])),
          (Call
             ("Zrm_r",CTy"Zdest_src",TP[AVar(CTy"Zrm"),Var("r",CTy"Zreg")]),
           Call
             ("Zea_r",CTy"Zea",
              TP[Var("size",CTy"Zsize"),Var("r",CTy"Zreg")])),
          (Call
             ("Zr_rm",CTy"Zdest_src",
              TP[AVar(CTy"Zreg"),Var("rm",CTy"Zrm")]),
           Apply
             (Call
                ("ea_Zrm",ATy(qTy,CTy"Zea"),
                 TP[Var("size",CTy"Zsize"),Var("rm",CTy"Zrm")]),
              qVar"state"))])))
;
val ea_Zimm_rm_def = Def
  ("ea_Zimm_rm",Var("imm_rm",CTy"Zimm_rm"),
   Close
     (qVar"state",
      CS(Var("imm_rm",CTy"Zimm_rm"),
         [(Call("Zrm",CTy"Zimm_rm",Var("rm",CTy"Zrm")),
           Apply
             (Call
                ("ea_Zrm",ATy(qTy,CTy"Zea"),
                 TP[Const("Z64",CTy"Zsize"),Var("rm",CTy"Zrm")]),
              qVar"state")),
          (Call("Zimm",CTy"Zimm_rm",Var("imm",F64)),
           Call
             ("Zea_i",CTy"Zea",TP[Const("Z64",CTy"Zsize"),Var("imm",F64)]))])))
;
val modSize_def = Def
  ("modSize",TP[Var("size",CTy"Zsize"),Var("imm",F64)],
   CS(Var("size",CTy"Zsize"),
      [(Call("Z8",CTy"Zsize",AVar bTy),Bop(Mod,Var("imm",F64),LW(8,64))),
       (Const("Z16",CTy"Zsize"),Bop(Mod,Var("imm",F64),LW(16,64))),
       (Const("Z32",CTy"Zsize"),Bop(Mod,Var("imm",F64),LW(32,64))),
       (Const("Z64",CTy"Zsize"),Bop(Mod,Var("imm",F64),LW(64,64)))]))
;
val restrictSize_def = Def
  ("restrictSize",TP[Var("size",CTy"Zsize"),Var("imm",F64)],
   CS(Var("size",CTy"Zsize"),
      [(Call("Z8",CTy"Zsize",AVar bTy),Bop(BAnd,Var("imm",F64),LW(255,64))),
       (Const("Z16",CTy"Zsize"),Bop(BAnd,Var("imm",F64),LW(65535,64))),
       (Const("Z32",CTy"Zsize"),Bop(BAnd,Var("imm",F64),LW(4294967295,64))),
       (Const("Z64",CTy"Zsize"),Var("imm",F64))]))
;
val EA_def = Def
  ("EA",Var("ea",CTy"Zea"),
   Close
     (qVar"state",
      CS(Var("ea",CTy"Zea"),
         [(Call("Zea_i",CTy"Zea",Var("i",PTy(CTy"Zsize",F64))),
           Call("restrictSize",F64,Var("i",PTy(CTy"Zsize",F64)))),
          (Call
             ("Zea_r",CTy"Zea",
              TP[Call("Z8",CTy"Zsize",bVar"have_rex"),Var("r",CTy"Zreg")]),
           Bop(BAnd,
               ITE(Bop(Or,bVar"have_rex",
                       Mop(Not,
                           Bop(In,Var("r",CTy"Zreg"),
                               SL[LC("RSP",CTy"Zreg"),LC("RBP",CTy"Zreg"),
                                  LC("RSI",CTy"Zreg"),LC("RDI",CTy"Zreg")]))),
                   Apply
                     (Dest("REG",ATy(CTy"Zreg",F64),qVar"state"),
                      Var("r",CTy"Zreg")),
                   Bop(Lsr,
                       Apply
                         (Dest("REG",ATy(CTy"Zreg",F64),qVar"state"),
                          Mop(Cast(CTy"Zreg"),
                              Bop(Sub,Mop(Cast nTy,Var("r",CTy"Zreg")),
                                  LN 4))),LN 8)),LW(255,64))),
          (Call
             ("Zea_r",CTy"Zea",TP[Var("s",CTy"Zsize"),Var("r",CTy"Zreg")]),
           Call
             ("restrictSize",F64,
              TP[Var("s",CTy"Zsize"),
                 Apply
                   (Dest("REG",ATy(CTy"Zreg",F64),qVar"state"),
                    Var("r",CTy"Zreg"))])),
          (Call
             ("Zea_m",CTy"Zea",
              TP[Call("Z8",CTy"Zsize",AVar bTy),Var("a",F64)]),
           Mop(Cast F64,
               Apply(Call("mem8",ATy(qTy,F8),Var("a",F64)),qVar"state"))),
          (Call("Zea_m",CTy"Zea",TP[Const("Z16",CTy"Zsize"),Var("a",F64)]),
           Mop(Cast F64,
               Apply(Call("mem16",ATy(qTy,F16),Var("a",F64)),qVar"state"))),
          (Call("Zea_m",CTy"Zea",TP[Const("Z32",CTy"Zsize"),Var("a",F64)]),
           Mop(Cast F64,
               Apply(Call("mem32",ATy(qTy,F32),Var("a",F64)),qVar"state"))),
          (Call("Zea_m",CTy"Zea",TP[Const("Z64",CTy"Zsize"),Var("a",F64)]),
           Apply(Call("mem64",ATy(qTy,F64),Var("a",F64)),qVar"state"))])))
;
val write'EA_def = Def
  ("write'EA",TP[Var("w",F64),Var("ea",CTy"Zea")],
   Close
     (qVar"state",
      CS(Var("ea",CTy"Zea"),
         [(Call("Zea_i",CTy"Zea",Var("i",PTy(CTy"Zsize",F64))),
           Mop(Snd,
               Apply
                 (Call
                    ("raise'exception",ATy(qTy,PTy(uTy,qTy)),
                     Call("FAILURE",CTy"exception",LS"write to constant")),
                  qVar"state"))),
          (Call
             ("Zea_r",CTy"Zea",
              TP[Call("Z8",CTy"Zsize",bVar"have_rex"),Var("r",CTy"Zreg")]),
           ITE(Bop(Or,bVar"have_rex",
                   Mop(Not,
                       Bop(In,Var("r",CTy"Zreg"),
                           SL[LC("RSP",CTy"Zreg"),LC("RBP",CTy"Zreg"),
                              LC("RSI",CTy"Zreg"),LC("RDI",CTy"Zreg")]))),
               Rupd
                 ("REG",
                  TP[qVar"state",
                     Fupd
                       (Dest("REG",ATy(CTy"Zreg",F64),qVar"state"),
                        Var("r",CTy"Zreg"),
                        BFI(LN 7,LN 0,EX(Var("w",F64),LN 7,LN 0,F8),
                            Apply
                              (Dest("REG",ATy(CTy"Zreg",F64),qVar"state"),
                               Var("r",CTy"Zreg"))))]),
               Let(Var("x",CTy"Zreg"),
                   Mop(Cast(CTy"Zreg"),
                       Bop(Sub,Mop(Cast nTy,Var("r",CTy"Zreg")),LN 4)),
                   Rupd
                     ("REG",
                      TP[qVar"state",
                         Fupd
                           (Dest("REG",ATy(CTy"Zreg",F64),qVar"state"),
                            Var("x",CTy"Zreg"),
                            BFI(LN 15,LN 8,EX(Var("w",F64),LN 7,LN 0,F8),
                                Apply
                                  (Dest
                                     ("REG",ATy(CTy"Zreg",F64),qVar"state"),
                                   Var("x",CTy"Zreg"))))])))),
          (Call
             ("Zea_r",CTy"Zea",
              TP[Const("Z16",CTy"Zsize"),Var("r",CTy"Zreg")]),
           Rupd
             ("REG",
              TP[qVar"state",
                 Fupd
                   (Dest("REG",ATy(CTy"Zreg",F64),qVar"state"),
                    Var("r",CTy"Zreg"),
                    BFI(LN 15,LN 0,EX(Var("w",F64),LN 15,LN 0,F16),
                        Apply
                          (Dest("REG",ATy(CTy"Zreg",F64),qVar"state"),
                           Var("r",CTy"Zreg"))))])),
          (Call
             ("Zea_r",CTy"Zea",
              TP[Const("Z32",CTy"Zsize"),Var("r",CTy"Zreg")]),
           Rupd
             ("REG",
              TP[qVar"state",
                 Fupd
                   (Dest("REG",ATy(CTy"Zreg",F64),qVar"state"),
                    Var("r",CTy"Zreg"),
                    Mop(Cast F64,EX(Var("w",F64),LN 31,LN 0,F32)))])),
          (Call
             ("Zea_r",CTy"Zea",
              TP[Const("Z64",CTy"Zsize"),Var("r",CTy"Zreg")]),
           Rupd
             ("REG",
              TP[qVar"state",
                 Fupd
                   (Dest("REG",ATy(CTy"Zreg",F64),qVar"state"),
                    Var("r",CTy"Zreg"),Var("w",F64))])),
          (Call
             ("Zea_m",CTy"Zea",
              TP[Call("Z8",CTy"Zsize",AVar bTy),Var("a",F64)]),
           Apply
             (Call
                ("write'mem8",ATy(qTy,qTy),
                 TP[EX(Var("w",F64),LN 7,LN 0,F8),Var("a",F64)]),
              qVar"state")),
          (Call("Zea_m",CTy"Zea",TP[Const("Z16",CTy"Zsize"),Var("a",F64)]),
           Apply
             (Call
                ("write'mem16",ATy(qTy,qTy),
                 TP[EX(Var("w",F64),LN 15,LN 0,F16),Var("a",F64)]),
              qVar"state")),
          (Call("Zea_m",CTy"Zea",TP[Const("Z32",CTy"Zsize"),Var("a",F64)]),
           Apply
             (Call
                ("write'mem32",ATy(qTy,qTy),
                 TP[EX(Var("w",F64),LN 31,LN 0,F32),Var("a",F64)]),
              qVar"state")),
          (Call("Zea_m",CTy"Zea",TP[Const("Z64",CTy"Zsize"),Var("a",F64)]),
           Apply
             (Call
                ("write'mem64",ATy(qTy,qTy),TP[Var("w",F64),Var("a",F64)]),
              qVar"state"))])))
;
val read_dest_src_ea_def = Def
  ("read_dest_src_ea",Var("sd",PTy(CTy"Zsize",CTy"Zdest_src")),
   Close
     (qVar"state",
      Let(Var("v",CTy"Zea"),
          Apply
            (Call
               ("ea_Zdest",ATy(qTy,CTy"Zea"),
                Var("sd",PTy(CTy"Zsize",CTy"Zdest_src"))),qVar"state"),
          TP[Var("v",CTy"Zea"),
             Apply(Call("EA",ATy(qTy,F64),Var("v",CTy"Zea")),qVar"state"),
             Apply
               (Call
                  ("EA",ATy(qTy,F64),
                   Apply
                     (Call
                        ("ea_Zsrc",ATy(qTy,CTy"Zea"),
                         Var("sd",PTy(CTy"Zsize",CTy"Zdest_src"))),
                      qVar"state")),qVar"state")])))
;
val call_dest_from_ea_def = Def
  ("call_dest_from_ea",Var("ea",CTy"Zea"),
   Close
     (qVar"state",
      CS(Var("ea",CTy"Zea"),
         [(Call("Zea_i",CTy"Zea",TP[AVar(CTy"Zsize"),Var("i",F64)]),
           Bop(Add,Dest("RIP",F64,qVar"state"),Var("i",F64))),
          (Call("Zea_r",CTy"Zea",TP[AVar(CTy"Zsize"),Var("r",CTy"Zreg")]),
           Apply
             (Dest("REG",ATy(CTy"Zreg",F64),qVar"state"),
              Var("r",CTy"Zreg"))),
          (Call("Zea_m",CTy"Zea",TP[AVar(CTy"Zsize"),Var("a",F64)]),
           Apply(Call("mem64",ATy(qTy,F64),Var("a",F64)),qVar"state"))])))
;
val get_ea_address_def = Def
  ("get_ea_address",Var("ea",CTy"Zea"),
   CS(Var("ea",CTy"Zea"),
      [(Call("Zea_i",CTy"Zea",TP[AVar(CTy"Zsize"),Var("i",F64)]),LW(0,64)),
       (Call("Zea_r",CTy"Zea",TP[AVar(CTy"Zsize"),Var("r",CTy"Zreg")]),
        LW(0,64)),
       (Call("Zea_m",CTy"Zea",TP[AVar(CTy"Zsize"),Var("a",F64)]),
        Var("a",F64))]))
;
val jump_to_ea_def = Def
  ("jump_to_ea",Var("ea",CTy"Zea"),
   Close
     (qVar"state",
      Rupd
        ("RIP",
         TP[qVar"state",
            Apply
              (Call("call_dest_from_ea",ATy(qTy,F64),Var("ea",CTy"Zea")),
               qVar"state")])))
;
val ByteParity_def = Def
  ("ByteParity",Var("b",F8),
   EQ(Bop(Mod,
          Bop(Add,
              Bop(Add,
                  Bop(Add,
                      Bop(Add,
                          Bop(Add,
                              Bop(Add,
                                  Bop(Add,
                                      Mop(Cast nTy,
                                          Bop(Bit,Var("b",F8),LN 7)),
                                      Mop(Cast nTy,
                                          Bop(Bit,Var("b",F8),LN 6))),
                                  Mop(Cast nTy,Bop(Bit,Var("b",F8),LN 5))),
                              Mop(Cast nTy,Bop(Bit,Var("b",F8),LN 4))),
                          Mop(Cast nTy,Bop(Bit,Var("b",F8),LN 3))),
                      Mop(Cast nTy,Bop(Bit,Var("b",F8),LN 2))),
                  Mop(Cast nTy,Bop(Bit,Var("b",F8),LN 1))),
              Mop(Cast nTy,Bop(Bit,Var("b",F8),LN 0))),LN 2),LN 0))
;
val Zsize_width_def = Def
  ("Zsize_width",Var("size",CTy"Zsize"),
   CS(Var("size",CTy"Zsize"),
      [(Call("Z8",CTy"Zsize",AVar bTy),LN 8),
       (Const("Z16",CTy"Zsize"),LN 16),(Const("Z32",CTy"Zsize"),LN 32),
       (Const("Z64",CTy"Zsize"),LN 64)]))
;
val word_size_msb_def = Def
  ("word_size_msb",TP[Var("size",CTy"Zsize"),Var("w",F64)],
   Bop(Bit,Var("w",F64),
       Bop(Sub,Call("Zsize_width",nTy,Var("size",CTy"Zsize")),LN 1)))
;
val write_PF_def = Def
  ("write_PF",Var("w",F64),
   Close
     (qVar"state",
      Apply
        (Call
           ("write'PF",ATy(qTy,qTy),
            Call("ByteParity",bTy,EX(Var("w",F64),LN 7,LN 0,F8))),
         qVar"state")))
;
val write_SF_def = Def
  ("write_SF",Var("s_w",PTy(CTy"Zsize",F64)),
   Close
     (qVar"state",
      Apply
        (Call
           ("write'SF",ATy(qTy,qTy),
            Call("word_size_msb",bTy,Var("s_w",PTy(CTy"Zsize",F64)))),
         qVar"state")))
;
val write_ZF_def = Def
  ("write_ZF",TP[Var("size",CTy"Zsize"),Var("w",F64)],
   Close
     (qVar"state",
      Apply
        (Call
           ("write'ZF",ATy(qTy,qTy),
            CS(Var("size",CTy"Zsize"),
               [(Call("Z8",CTy"Zsize",AVar bTy),
                 EQ(Mop(Cast F8,Var("w",F64)),LW(0,8))),
                (Const("Z16",CTy"Zsize"),
                 EQ(Mop(Cast F16,Var("w",F64)),LW(0,16))),
                (Const("Z32",CTy"Zsize"),
                 EQ(Mop(Cast F32,Var("w",F64)),LW(0,32))),
                (Const("Z64",CTy"Zsize"),EQ(Var("w",F64),LW(0,64)))])),
         qVar"state")))
;
val write_arith_eflags_except_CF_OF_def = Def
  ("write_arith_eflags_except_CF_OF",
   TP[Var("size",CTy"Zsize"),Var("w",F64)],
   Close
     (qVar"state",
      Apply
        (Call("FlagUnspecified",ATy(qTy,qTy),LC("Z_AF",CTy"Zeflags")),
         Apply
           (Call
              ("write_ZF",ATy(qTy,qTy),
               TP[Var("size",CTy"Zsize"),Var("w",F64)]),
            Apply
              (Call
                 ("write_SF",ATy(qTy,qTy),
                  TP[Var("size",CTy"Zsize"),Var("w",F64)]),
               Apply
                 (Call("write_PF",ATy(qTy,qTy),Var("w",F64)),qVar"state"))))))
;
val write_arith_eflags_def = Def
  ("write_arith_eflags",
   TP[Var("size",CTy"Zsize"),Var("w",F64),bVar"c",bVar"x"],
   Close
     (qVar"state",
      Apply
        (Call
           ("write_arith_eflags_except_CF_OF",ATy(qTy,qTy),
            TP[Var("size",CTy"Zsize"),Var("w",F64)]),
         Apply
           (Call("write'OF",ATy(qTy,qTy),bVar"x"),
            Apply(Call("write'CF",ATy(qTy,qTy),bVar"c"),qVar"state")))))
;
val write_logical_eflags_def = Def
  ("write_logical_eflags",TP[Var("size",CTy"Zsize"),Var("w",F64)],
   Close
     (qVar"state",
      Apply
        (Call
           ("write_arith_eflags",ATy(qTy,qTy),
            TP[Var("size",CTy"Zsize"),Var("w",F64),LF,LF]),qVar"state")))
;
val erase_eflags_def = Def
  ("erase_eflags",qVar"state",
   Rupd("EFLAGS",TP[qVar"state",Mop(K1(CTy"Zeflags"),LO bTy)]))
;
val value_width_def = Def
  ("value_width",Var("s",CTy"Zsize"),
   Bop(Exp,LN 2,Call("Zsize_width",nTy,Var("s",CTy"Zsize"))))
;
val word_signed_overflow_add_def = Def
  ("word_signed_overflow_add",
   TP[Var("size",CTy"Zsize"),Var("a",F64),Var("b",F64)],
   Bop(And,
       EQ(Call
            ("word_size_msb",bTy,TP[Var("size",CTy"Zsize"),Var("a",F64)]),
          Call
            ("word_size_msb",bTy,TP[Var("size",CTy"Zsize"),Var("b",F64)])),
       Mop(Not,
           EQ(Call
                ("word_size_msb",bTy,
                 TP[Var("size",CTy"Zsize"),
                    Bop(Add,Var("a",F64),Var("b",F64))]),
              Call
                ("word_size_msb",bTy,
                 TP[Var("size",CTy"Zsize"),Var("a",F64)])))))
;
val word_signed_overflow_sub_def = Def
  ("word_signed_overflow_sub",
   TP[Var("size",CTy"Zsize"),Var("a",F64),Var("b",F64)],
   Bop(And,
       Mop(Not,
           EQ(Call
                ("word_size_msb",bTy,
                 TP[Var("size",CTy"Zsize"),Var("a",F64)]),
              Call
                ("word_size_msb",bTy,
                 TP[Var("size",CTy"Zsize"),Var("b",F64)]))),
       Mop(Not,
           EQ(Call
                ("word_size_msb",bTy,
                 TP[Var("size",CTy"Zsize"),
                    Bop(Sub,Var("a",F64),Var("b",F64))]),
              Call
                ("word_size_msb",bTy,
                 TP[Var("size",CTy"Zsize"),Var("a",F64)])))))
;
val add_with_carry_out_def = Def
  ("add_with_carry_out",
   TP[Var("size",CTy"Zsize"),Var("x",F64),Var("y",F64)],
   TP[Bop(Add,Var("x",F64),Var("y",F64)),
      Bop(Le,Call("value_width",nTy,Var("size",CTy"Zsize")),
          Bop(Add,Mop(Cast nTy,Var("x",F64)),Mop(Cast nTy,Var("y",F64)))),
      Call
        ("word_signed_overflow_add",bTy,
         TP[Var("size",CTy"Zsize"),Var("x",F64),Var("y",F64)])])
;
val sub_with_borrow_def = Def
  ("sub_with_borrow",TP[Var("size",CTy"Zsize"),Var("x",F64),Var("y",F64)],
   TP[Bop(Sub,Var("x",F64),Var("y",F64)),
      Bop(Ult,Var("x",F64),Var("y",F64)),
      Call
        ("word_signed_overflow_sub",bTy,
         TP[Var("size",CTy"Zsize"),Var("x",F64),Var("y",F64)])])
;
val write_arith_result_def = Def
  ("write_arith_result",
   TP[Var("size",CTy"Zsize"),Var("r",PTy(F64,PTy(bTy,bTy))),
      Var("ea",CTy"Zea")],
   Close
     (qVar"state",
      Apply
        (Call
           ("write'EA",ATy(qTy,qTy),
            TP[Mop(Fst,Var("r",PTy(F64,PTy(bTy,bTy)))),Var("ea",CTy"Zea")]),
         Apply
           (Call
              ("write_arith_eflags",ATy(qTy,qTy),
               TP[Var("size",CTy"Zsize"),Var("r",PTy(F64,PTy(bTy,bTy)))]),
            qVar"state"))))
;
val write_arith_result_no_CF_OF_def = Def
  ("write_arith_result_no_CF_OF",
   TP[Var("size",CTy"Zsize"),Var("w",F64),Var("ea",CTy"Zea")],
   Close
     (qVar"state",
      Apply
        (Call("write'EA",ATy(qTy,qTy),TP[Var("w",F64),Var("ea",CTy"Zea")]),
         Apply
           (Call
              ("write_arith_eflags_except_CF_OF",ATy(qTy,qTy),
               TP[Var("size",CTy"Zsize"),Var("w",F64)]),qVar"state"))))
;
val write_logical_result_def = Def
  ("write_logical_result",
   TP[Var("size",CTy"Zsize"),Var("w",F64),Var("ea",CTy"Zea")],
   Close
     (qVar"state",
      Apply
        (Call("write'EA",ATy(qTy,qTy),TP[Var("w",F64),Var("ea",CTy"Zea")]),
         Apply
           (Call
              ("write_logical_eflags",ATy(qTy,qTy),
               TP[Var("size",CTy"Zsize"),Var("w",F64)]),qVar"state"))))
;
val write_result_erase_eflags_def = Def
  ("write_result_erase_eflags",TP[Var("w",F64),Var("ea",CTy"Zea")],
   Close
     (qVar"state",
      Apply
        (Call("write'EA",ATy(qTy,qTy),TP[Var("w",F64),Var("ea",CTy"Zea")]),
         Apply(Const("erase_eflags",ATy(qTy,qTy)),qVar"state"))))
;
val SignExtension_def = Def
  ("SignExtension",
   TP[Var("w",F64),Var("size1",CTy"Zsize"),Var("size2",CTy"Zsize")],
   Close
     (qVar"state",
      Let(TP[Var("r",F64),Var("s1",PTy(F64,qTy))],
          Let(Var("s",PTy(F64,qTy)),
              CS(TP[Var("size1",CTy"Zsize"),Var("size2",CTy"Zsize")],
                 [(TP[Call("Z8",CTy"Zsize",AVar bTy),
                      Const("Z16",CTy"Zsize")],
                   TP[BFI(LN 15,LN 0,
                          Mop(SE F16,EX(Var("w",F64),LN 7,LN 0,F8)),
                          Var("w",F64)),qVar"state"]),
                  (TP[Call("Z8",CTy"Zsize",AVar bTy),
                      Const("Z32",CTy"Zsize")],
                   TP[BFI(LN 31,LN 0,
                          Mop(SE F32,EX(Var("w",F64),LN 7,LN 0,F8)),
                          Var("w",F64)),qVar"state"]),
                  (TP[Call("Z8",CTy"Zsize",AVar bTy),
                      Const("Z64",CTy"Zsize")],
                   TP[Mop(SE F64,EX(Var("w",F64),LN 7,LN 0,F8)),
                      qVar"state"]),
                  (TP[Const("Z16",CTy"Zsize"),Const("Z32",CTy"Zsize")],
                   TP[BFI(LN 31,LN 0,
                          Mop(SE F32,EX(Var("w",F64),LN 15,LN 0,F16)),
                          Var("w",F64)),qVar"state"]),
                  (TP[Const("Z16",CTy"Zsize"),Const("Z64",CTy"Zsize")],
                   TP[Mop(SE F64,EX(Var("w",F64),LN 15,LN 0,F16)),
                      qVar"state"]),
                  (TP[Const("Z32",CTy"Zsize"),Const("Z64",CTy"Zsize")],
                   TP[Mop(SE F64,EX(Var("w",F64),LN 31,LN 0,F32)),
                      qVar"state"]),
                  (AVar(PTy(CTy"Zsize",CTy"Zsize")),
                   TP[Var("w",F64),
                      Mop(Snd,
                          Apply
                            (Call
                               ("raise'exception",ATy(qTy,PTy(uTy,qTy)),
                                Call
                                  ("FAILURE",CTy"exception",
                                   LS"SignExtension")),qVar"state"))])]),
              TP[Mop(Fst,Var("s",PTy(F64,qTy))),Var("s",PTy(F64,qTy))]),
          TP[Var("r",F64),Mop(Snd,Var("s1",PTy(F64,qTy)))])))
;
val SignExtension64_def = Def
  ("SignExtension64",TP[Var("w",F64),Var("size",CTy"Zsize")],
   Close
     (qVar"state",
      ITE(EQ(Var("size",CTy"Zsize"),Const("Z64",CTy"Zsize")),
          TP[Var("w",F64),qVar"state"],
          Apply
            (Call
               ("SignExtension",ATy(qTy,PTy(F64,qTy)),
                TP[Var("w",F64),Var("size",CTy"Zsize"),
                   Const("Z64",CTy"Zsize")]),qVar"state"))))
;
val maskShift_def = Def
  ("maskShift",TP[Var("size",CTy"Zsize"),Var("w",F64)],
   ITE(EQ(Var("size",CTy"Zsize"),Const("Z64",CTy"Zsize")),
       Mop(Cast nTy,EX(Var("w",F64),LN 5,LN 0,FTy 6)),
       Mop(Cast nTy,EX(Var("w",F64),LN 4,LN 0,FTy 5))))
;
val ROL_def = Def
  ("ROL",TP[Var("size",CTy"Zsize"),Var("x",F64),Var("y",F64)],
   CS(Var("size",CTy"Zsize"),
      [(Call("Z8",CTy"Zsize",AVar bTy),
        Mop(Cast F64,
            Bop(Rol,EX(Var("x",F64),LN 7,LN 0,F8),
                Mop(Cast nTy,EX(Var("y",F64),LN 4,LN 0,FTy 5))))),
       (Const("Z16",CTy"Zsize"),
        Mop(Cast F64,
            Bop(Rol,EX(Var("x",F64),LN 15,LN 0,F16),
                Mop(Cast nTy,EX(Var("y",F64),LN 4,LN 0,FTy 5))))),
       (Const("Z32",CTy"Zsize"),
        Mop(Cast F64,
            Bop(Rol,EX(Var("x",F64),LN 31,LN 0,F32),
                Mop(Cast nTy,EX(Var("y",F64),LN 4,LN 0,FTy 5))))),
       (Const("Z64",CTy"Zsize"),
        Bop(Rol,Var("x",F64),
            Mop(Cast nTy,EX(Var("y",F64),LN 5,LN 0,FTy 6))))]))
;
val ROR_def = Def
  ("ROR",TP[Var("size",CTy"Zsize"),Var("x",F64),Var("y",F64)],
   CS(Var("size",CTy"Zsize"),
      [(Call("Z8",CTy"Zsize",AVar bTy),
        Mop(Cast F64,
            Bop(Ror,EX(Var("x",F64),LN 7,LN 0,F8),
                Mop(Cast nTy,EX(Var("y",F64),LN 4,LN 0,FTy 5))))),
       (Const("Z16",CTy"Zsize"),
        Mop(Cast F64,
            Bop(Ror,EX(Var("x",F64),LN 15,LN 0,F16),
                Mop(Cast nTy,EX(Var("y",F64),LN 4,LN 0,FTy 5))))),
       (Const("Z32",CTy"Zsize"),
        Mop(Cast F64,
            Bop(Ror,EX(Var("x",F64),LN 31,LN 0,F32),
                Mop(Cast nTy,EX(Var("y",F64),LN 4,LN 0,FTy 5))))),
       (Const("Z64",CTy"Zsize"),
        Bop(Ror,Var("x",F64),
            Mop(Cast nTy,EX(Var("y",F64),LN 5,LN 0,FTy 6))))]))
;
val SAR_def = Def
  ("SAR",TP[Var("size",CTy"Zsize"),Var("x",F64),Var("y",F64)],
   CS(Var("size",CTy"Zsize"),
      [(Call("Z8",CTy"Zsize",AVar bTy),
        Mop(Cast F64,
            Bop(Asr,EX(Var("x",F64),LN 7,LN 0,F8),
                Mop(Cast nTy,EX(Var("y",F64),LN 4,LN 0,FTy 5))))),
       (Const("Z16",CTy"Zsize"),
        Mop(Cast F64,
            Bop(Asr,EX(Var("x",F64),LN 15,LN 0,F16),
                Mop(Cast nTy,EX(Var("y",F64),LN 4,LN 0,FTy 5))))),
       (Const("Z32",CTy"Zsize"),
        Mop(Cast F64,
            Bop(Asr,EX(Var("x",F64),LN 31,LN 0,F32),
                Mop(Cast nTy,EX(Var("y",F64),LN 4,LN 0,FTy 5))))),
       (Const("Z64",CTy"Zsize"),
        Bop(Asr,Var("x",F64),
            Mop(Cast nTy,EX(Var("y",F64),LN 5,LN 0,FTy 6))))]))
;
val write_binop_def = Def
  ("write_binop",
   TP[Var("s",CTy"Zsize"),Var("bop",CTy"Zbinop_name"),Var("x",F64),
      Var("y",F64),Var("ea",CTy"Zea")],
   Close
     (qVar"state",
      CS(Var("bop",CTy"Zbinop_name"),
         [(LC("Zadd",CTy"Zbinop_name"),
           Apply
             (Call
                ("write_arith_result",ATy(qTy,qTy),
                 TP[Var("s",CTy"Zsize"),
                    Call
                      ("add_with_carry_out",PTy(F64,PTy(bTy,bTy)),
                       TP[Var("s",CTy"Zsize"),Var("x",F64),Var("y",F64)]),
                    Var("ea",CTy"Zea")]),qVar"state")),
          (LC("Zsub",CTy"Zbinop_name"),
           Apply
             (Call
                ("write_arith_result",ATy(qTy,qTy),
                 TP[Var("s",CTy"Zsize"),
                    Call
                      ("sub_with_borrow",PTy(F64,PTy(bTy,bTy)),
                       TP[Var("s",CTy"Zsize"),Var("x",F64),Var("y",F64)]),
                    Var("ea",CTy"Zea")]),qVar"state")),
          (LC("Zcmp",CTy"Zbinop_name"),
           Apply
             (Call
                ("write_arith_eflags",ATy(qTy,qTy),
                 TP[Var("s",CTy"Zsize"),
                    Call
                      ("sub_with_borrow",PTy(F64,PTy(bTy,bTy)),
                       TP[Var("s",CTy"Zsize"),Var("x",F64),Var("y",F64)])]),
              qVar"state")),
          (LC("Ztest",CTy"Zbinop_name"),
           Apply
             (Call
                ("write_logical_eflags",ATy(qTy,qTy),
                 TP[Var("s",CTy"Zsize"),
                    Bop(BAnd,Var("x",F64),Var("y",F64))]),qVar"state")),
          (LC("Zand",CTy"Zbinop_name"),
           Apply
             (Call
                ("write_logical_result",ATy(qTy,qTy),
                 TP[Var("s",CTy"Zsize"),
                    Bop(BAnd,Var("x",F64),Var("y",F64)),Var("ea",CTy"Zea")]),
              qVar"state")),
          (LC("Zxor",CTy"Zbinop_name"),
           Apply
             (Call
                ("write_logical_result",ATy(qTy,qTy),
                 TP[Var("s",CTy"Zsize"),
                    Bop(BXor,Var("x",F64),Var("y",F64)),Var("ea",CTy"Zea")]),
              qVar"state")),
          (LC("Zor",CTy"Zbinop_name"),
           Apply
             (Call
                ("write_logical_result",ATy(qTy,qTy),
                 TP[Var("s",CTy"Zsize"),
                    Bop(BOr,Var("x",F64),Var("y",F64)),Var("ea",CTy"Zea")]),
              qVar"state")),
          (LC("Zrol",CTy"Zbinop_name"),
           Apply
             (Call
                ("write_result_erase_eflags",ATy(qTy,qTy),
                 TP[Call
                      ("ROL",F64,
                       TP[Var("s",CTy"Zsize"),Var("x",F64),Var("y",F64)]),
                    Var("ea",CTy"Zea")]),qVar"state")),
          (LC("Zror",CTy"Zbinop_name"),
           Apply
             (Call
                ("write_result_erase_eflags",ATy(qTy,qTy),
                 TP[Call
                      ("ROR",F64,
                       TP[Var("s",CTy"Zsize"),Var("x",F64),Var("y",F64)]),
                    Var("ea",CTy"Zea")]),qVar"state")),
          (LC("Zsar",CTy"Zbinop_name"),
           Apply
             (Call
                ("write_result_erase_eflags",ATy(qTy,qTy),
                 TP[Call
                      ("SAR",F64,
                       TP[Var("s",CTy"Zsize"),Var("x",F64),Var("y",F64)]),
                    Var("ea",CTy"Zea")]),qVar"state")),
          (LC("Zshl",CTy"Zbinop_name"),
           Apply
             (Call
                ("write_result_erase_eflags",ATy(qTy,qTy),
                 TP[Bop(Lsl,Var("x",F64),
                        Call
                          ("maskShift",nTy,
                           TP[Var("s",CTy"Zsize"),Var("y",F64)])),
                    Var("ea",CTy"Zea")]),qVar"state")),
          (LC("Zshr",CTy"Zbinop_name"),
           Apply
             (Call
                ("write_result_erase_eflags",ATy(qTy,qTy),
                 TP[Bop(Lsr,Var("x",F64),
                        Call
                          ("maskShift",nTy,
                           TP[Var("s",CTy"Zsize"),Var("y",F64)])),
                    Var("ea",CTy"Zea")]),qVar"state")),
          (LC("Zadc",CTy"Zbinop_name"),
           Let(TP[bVar"v",qVar"s0"],
               Apply(Const("CF",ATy(qTy,PTy(bTy,qTy))),qVar"state"),
               Apply
                 (Call
                    ("write_arith_result_no_CF_OF",ATy(qTy,qTy),
                     TP[Var("s",CTy"Zsize"),
                        Bop(Add,Bop(Add,Var("x",F64),Var("y",F64)),
                            Mop(Cast F64,bVar"v")),Var("ea",CTy"Zea")]),
                  Apply
                    (Call
                       ("FlagUnspecified",ATy(qTy,qTy),
                        LC("Z_OF",CTy"Zeflags")),
                     Apply
                       (Call
                          ("write'CF",ATy(qTy,qTy),
                           Bop(Le,
                               Call("value_width",nTy,Var("s",CTy"Zsize")),
                               Bop(Add,
                                   Bop(Add,Mop(Cast nTy,Var("x",F64)),
                                       Mop(Cast nTy,Var("y",F64))),
                                   Mop(Cast nTy,bVar"v")))),qVar"s0"))))),
          (LC("Zsbb",CTy"Zbinop_name"),
           Let(TP[bVar"v",qVar"s0"],
               Apply(Const("CF",ATy(qTy,PTy(bTy,qTy))),qVar"state"),
               Apply
                 (Call
                    ("write_arith_result_no_CF_OF",ATy(qTy,qTy),
                     TP[Var("s",CTy"Zsize"),
                        Bop(Sub,Var("x",F64),
                            Bop(Add,Var("y",F64),Mop(Cast F64,bVar"v"))),
                        Var("ea",CTy"Zea")]),
                  Apply
                    (Call
                       ("FlagUnspecified",ATy(qTy,qTy),
                        LC("Z_OF",CTy"Zeflags")),
                     Apply
                       (Call
                          ("write'CF",ATy(qTy,qTy),
                           Bop(Lt,Mop(Cast nTy,Var("x",F64)),
                               Bop(Add,Mop(Cast nTy,Var("y",F64)),
                                   Mop(Cast nTy,bVar"v")))),qVar"s0"))))),
          (AVar(CTy"Zbinop_name"),
           Mop(Snd,
               Apply
                 (Call
                    ("raise'exception",ATy(qTy,PTy(uTy,qTy)),
                     Call
                       ("FAILURE",CTy"exception",
                        CC[LS"Binary op not implemented: ",
                           Mop(Cast sTy,Var("bop",CTy"Zbinop_name"))])),
                  qVar"state")))])))
;
val write_monop_def = Def
  ("write_monop",
   TP[Var("s",CTy"Zsize"),Var("mop",CTy"Zmonop_name"),Var("x",F64),
      Var("ea",CTy"Zea")],
   Close
     (qVar"state",
      CS(Var("mop",CTy"Zmonop_name"),
         [(LC("Znot",CTy"Zmonop_name"),
           Apply
             (Call
                ("write'EA",ATy(qTy,qTy),
                 TP[Mop(BNot,Var("x",F64)),Var("ea",CTy"Zea")]),
              qVar"state")),
          (LC("Zdec",CTy"Zmonop_name"),
           Apply
             (Call
                ("write_arith_result_no_CF_OF",ATy(qTy,qTy),
                 TP[Var("s",CTy"Zsize"),Bop(Sub,Var("x",F64),LW(1,64)),
                    Var("ea",CTy"Zea")]),qVar"state")),
          (LC("Zinc",CTy"Zmonop_name"),
           Apply
             (Call
                ("write_arith_result_no_CF_OF",ATy(qTy,qTy),
                 TP[Var("s",CTy"Zsize"),Bop(Add,Var("x",F64),LW(1,64)),
                    Var("ea",CTy"Zea")]),qVar"state")),
          (LC("Zneg",CTy"Zmonop_name"),
           Apply
             (Call("FlagUnspecified",ATy(qTy,qTy),LC("Z_CF",CTy"Zeflags")),
              Apply
                (Call
                   ("write_arith_result_no_CF_OF",ATy(qTy,qTy),
                    TP[Var("s",CTy"Zsize"),Mop(Neg,Var("x",F64)),
                       Var("ea",CTy"Zea")]),qVar"state")))])))
;
val bit_test_def = Def
  ("bit_test",
   TP[Var("bt",CTy"Zbit_test_name"),Var("base",CTy"Zea"),nVar"offset"],
   Close
     (qVar"state",
      Let(bVar"v",
          Bop(Bit,
              Apply
                (Call("EA",ATy(qTy,F64),Var("base",CTy"Zea")),qVar"state"),
              nVar"offset"),
          Let(qVar"s",
              Apply(Call("write'CF",ATy(qTy,qTy),bVar"v"),qVar"state"),
              CS(Var("bt",CTy"Zbit_test_name"),
                 [(LC("Zbt",CTy"Zbit_test_name"),qVar"s"),
                  (LC("Zbtc",CTy"Zbit_test_name"),
                   Apply
                     (Call
                        ("write'EA",ATy(qTy,qTy),
                         TP[BFI(nVar"offset",nVar"offset",
                                Mop(Cast F1,Mop(Not,bVar"v")),
                                Apply
                                  (Call
                                     ("EA",ATy(qTy,F64),
                                      Var("base",CTy"Zea")),qVar"s")),
                            Var("base",CTy"Zea")]),qVar"s")),
                  (LC("Zbtr",CTy"Zbit_test_name"),
                   Apply
                     (Call
                        ("write'EA",ATy(qTy,qTy),
                         TP[BFI(nVar"offset",nVar"offset",Mop(Cast F1,LF),
                                Apply
                                  (Call
                                     ("EA",ATy(qTy,F64),
                                      Var("base",CTy"Zea")),qVar"s")),
                            Var("base",CTy"Zea")]),qVar"s")),
                  (LC("Zbts",CTy"Zbit_test_name"),
                   Apply
                     (Call
                        ("write'EA",ATy(qTy,qTy),
                         TP[BFI(nVar"offset",nVar"offset",Mop(Cast F1,LT),
                                Apply
                                  (Call
                                     ("EA",ATy(qTy,F64),
                                      Var("base",CTy"Zea")),qVar"s")),
                            Var("base",CTy"Zea")]),qVar"s"))])))))
;
val read_cond_def = Def
  ("read_cond",Var("c",CTy"Zcond"),
   Close
     (qVar"state",
      CS(Var("c",CTy"Zcond"),
         [(LC("Z_A",CTy"Zcond"),
           CS(TP[Apply
                   (Dest("EFLAGS",ATy(CTy"Zeflags",OTy bTy),qVar"state"),
                    LC("Z_CF",CTy"Zeflags")),
                 Apply
                   (Dest("EFLAGS",ATy(CTy"Zeflags",OTy bTy),qVar"state"),
                    LC("Z_ZF",CTy"Zeflags"))],
              [(TP[Mop(Some,LF),Mop(Some,LF)],TP[LT,qVar"state"]),
               (TP[Mop(Some,LT),AVar(OTy bTy)],TP[LF,qVar"state"]),
               (TP[AVar(OTy bTy),Mop(Some,LT)],TP[LF,qVar"state"]),
               (AVar(PTy(OTy bTy,OTy bTy)),
                Apply
                  (Call
                     ("raise'exception",ATy(qTy,PTy(bTy,qTy)),
                      Call
                        ("BadFlagAccess",CTy"exception",
                         CC[LS"read_cond: ",
                            Mop(Cast sTy,Var("c",CTy"Zcond"))])),
                   qVar"state"))])),
          (LC("Z_NB",CTy"Zcond"),
           Let(TP[bVar"v",qVar"s"],
               Apply(Const("CF",ATy(qTy,PTy(bTy,qTy))),qVar"state"),
               TP[Mop(Not,bVar"v"),qVar"s"])),
          (LC("Z_B",CTy"Zcond"),
           Apply(Const("CF",ATy(qTy,PTy(bTy,qTy))),qVar"state")),
          (LC("Z_NA",CTy"Zcond"),
           CS(TP[Apply
                   (Dest("EFLAGS",ATy(CTy"Zeflags",OTy bTy),qVar"state"),
                    LC("Z_CF",CTy"Zeflags")),
                 Apply
                   (Dest("EFLAGS",ATy(CTy"Zeflags",OTy bTy),qVar"state"),
                    LC("Z_ZF",CTy"Zeflags"))],
              [(TP[Mop(Some,LT),AVar(OTy bTy)],TP[LT,qVar"state"]),
               (TP[AVar(OTy bTy),Mop(Some,LT)],TP[LT,qVar"state"]),
               (TP[Mop(Some,LF),Mop(Some,LF)],TP[LF,qVar"state"]),
               (AVar(PTy(OTy bTy,OTy bTy)),
                Apply
                  (Call
                     ("raise'exception",ATy(qTy,PTy(bTy,qTy)),
                      Call
                        ("BadFlagAccess",CTy"exception",
                         CC[LS"read_cond: ",
                            Mop(Cast sTy,Var("c",CTy"Zcond"))])),
                   qVar"state"))])),
          (LC("Z_E",CTy"Zcond"),
           Apply(Const("ZF",ATy(qTy,PTy(bTy,qTy))),qVar"state")),
          (LC("Z_G",CTy"Zcond"),
           CS(TP[Apply
                   (Dest("EFLAGS",ATy(CTy"Zeflags",OTy bTy),qVar"state"),
                    LC("Z_SF",CTy"Zeflags")),
                 Apply
                   (Dest("EFLAGS",ATy(CTy"Zeflags",OTy bTy),qVar"state"),
                    LC("Z_OF",CTy"Zeflags"))],
              [(TP[Mop(Some,bVar"a"),Mop(Some,bVar"b")],
                ITE(EQ(bVar"a",bVar"b"),
                    Let(TP[bVar"v",qVar"s"],
                        Apply
                          (Const("ZF",ATy(qTy,PTy(bTy,qTy))),qVar"state"),
                        TP[Mop(Not,bVar"v"),qVar"s"]),TP[LF,qVar"state"])),
               (AVar(PTy(OTy bTy,OTy bTy)),
                CS(Apply
                     (Dest("EFLAGS",ATy(CTy"Zeflags",OTy bTy),qVar"state"),
                      LC("Z_ZF",CTy"Zeflags")),
                   [(Mop(Some,LT),TP[LF,qVar"state"]),
                    (AVar(OTy bTy),
                     Apply
                       (Call
                          ("raise'exception",ATy(qTy,PTy(bTy,qTy)),
                           Call
                             ("BadFlagAccess",CTy"exception",
                              CC[LS"read_cond: ",
                                 Mop(Cast sTy,Var("c",CTy"Zcond"))])),
                        qVar"state"))]))])),
          (LC("Z_NL",CTy"Zcond"),
           Let(TP[bVar"v",qVar"s"],
               Apply(Const("SF",ATy(qTy,PTy(bTy,qTy))),qVar"state"),
               Let(TP[bVar"v0",qVar"s"],
                   Apply(Const("OF",ATy(qTy,PTy(bTy,qTy))),qVar"s"),
                   TP[EQ(bVar"v",bVar"v0"),qVar"s"]))),
          (LC("Z_L",CTy"Zcond"),
           Let(TP[bVar"v",qVar"s"],
               Apply(Const("SF",ATy(qTy,PTy(bTy,qTy))),qVar"state"),
               Let(TP[bVar"v",qVar"s"],
                   Let(TP[bVar"v0",qVar"s"],
                       Apply(Const("OF",ATy(qTy,PTy(bTy,qTy))),qVar"s"),
                       TP[EQ(bVar"v",bVar"v0"),qVar"s"]),
                   TP[Mop(Not,bVar"v"),qVar"s"]))),
          (LC("Z_NG",CTy"Zcond"),
           CS(TP[Apply
                   (Dest("EFLAGS",ATy(CTy"Zeflags",OTy bTy),qVar"state"),
                    LC("Z_SF",CTy"Zeflags")),
                 Apply
                   (Dest("EFLAGS",ATy(CTy"Zeflags",OTy bTy),qVar"state"),
                    LC("Z_OF",CTy"Zeflags"))],
              [(TP[Mop(Some,bVar"a"),Mop(Some,bVar"b")],
                ITE(Mop(Not,EQ(bVar"a",bVar"b")),TP[LT,qVar"state"],
                    Apply(Const("ZF",ATy(qTy,PTy(bTy,qTy))),qVar"state"))),
               (AVar(PTy(OTy bTy,OTy bTy)),
                CS(Apply
                     (Dest("EFLAGS",ATy(CTy"Zeflags",OTy bTy),qVar"state"),
                      LC("Z_ZF",CTy"Zeflags")),
                   [(Mop(Some,LT),TP[LT,qVar"state"]),
                    (AVar(OTy bTy),
                     Apply
                       (Call
                          ("raise'exception",ATy(qTy,PTy(bTy,qTy)),
                           Call
                             ("BadFlagAccess",CTy"exception",
                              CC[LS"read_cond: ",
                                 Mop(Cast sTy,Var("c",CTy"Zcond"))])),
                        qVar"state"))]))])),
          (LC("Z_NE",CTy"Zcond"),
           Let(TP[bVar"v",qVar"s"],
               Apply(Const("ZF",ATy(qTy,PTy(bTy,qTy))),qVar"state"),
               TP[Mop(Not,bVar"v"),qVar"s"])),
          (LC("Z_NO",CTy"Zcond"),
           Let(TP[bVar"v",qVar"s"],
               Apply(Const("OF",ATy(qTy,PTy(bTy,qTy))),qVar"state"),
               TP[Mop(Not,bVar"v"),qVar"s"])),
          (LC("Z_NP",CTy"Zcond"),
           Let(TP[bVar"v",qVar"s"],
               Apply(Const("PF",ATy(qTy,PTy(bTy,qTy))),qVar"state"),
               TP[Mop(Not,bVar"v"),qVar"s"])),
          (LC("Z_NS",CTy"Zcond"),
           Let(TP[bVar"v",qVar"s"],
               Apply(Const("SF",ATy(qTy,PTy(bTy,qTy))),qVar"state"),
               TP[Mop(Not,bVar"v"),qVar"s"])),
          (LC("Z_O",CTy"Zcond"),
           Apply(Const("OF",ATy(qTy,PTy(bTy,qTy))),qVar"state")),
          (LC("Z_P",CTy"Zcond"),
           Apply(Const("PF",ATy(qTy,PTy(bTy,qTy))),qVar"state")),
          (LC("Z_S",CTy"Zcond"),
           Apply(Const("SF",ATy(qTy,PTy(bTy,qTy))),qVar"state")),
          (LC("Z_ALWAYS",CTy"Zcond"),TP[LT,qVar"state"])])))
;
val x64_pop_aux_def = Def
  ("x64_pop_aux",qVar"state",
   Let(Var("v",F64),
       Apply
         (Dest("REG",ATy(CTy"Zreg",F64),qVar"state"),LC("RSP",CTy"Zreg")),
       TP[Apply(Call("mem64",ATy(qTy,F64),Var("v",F64)),qVar"state"),
          Rupd
            ("REG",
             TP[qVar"state",
                Fupd
                  (Dest("REG",ATy(CTy"Zreg",F64),qVar"state"),
                   LC("RSP",CTy"Zreg"),Bop(Add,Var("v",F64),LW(8,64)))])]))
;
val x64_pop_def = Def
  ("x64_pop",Var("rm",CTy"Zrm"),
   Close
     (qVar"state",
      Let(TP[Var("v0",F64),qVar"s"],
          Apply(Const("x64_pop_aux",ATy(qTy,PTy(F64,qTy))),qVar"state"),
          Apply
            (Call
               ("write'EA",ATy(qTy,qTy),
                TP[Var("v0",F64),
                   Apply
                     (Call
                        ("ea_Zrm",ATy(qTy,CTy"Zea"),
                         TP[Const("Z64",CTy"Zsize"),Var("rm",CTy"Zrm")]),
                      qVar"state")]),qVar"s"))))
;
val x64_pop_rip_def = Def
  ("x64_pop_rip",qVar"state",
   Let(TP[Var("v",F64),qVar"s"],
       Apply(Const("x64_pop_aux",ATy(qTy,PTy(F64,qTy))),qVar"state"),
       Rupd("RIP",TP[qVar"s",Var("v",F64)])))
;
val x64_push_aux_def = Def
  ("x64_push_aux",Var("w",F64),
   Close
     (qVar"state",
      Let(Var("v",F64),
          Bop(Sub,
              Apply
                (Dest("REG",ATy(CTy"Zreg",F64),qVar"state"),
                 LC("RSP",CTy"Zreg")),LW(8,64)),
          Apply
            (Call
               ("write'mem64",ATy(qTy,qTy),TP[Var("w",F64),Var("v",F64)]),
             Rupd
               ("REG",
                TP[qVar"state",
                   Fupd
                     (Dest("REG",ATy(CTy"Zreg",F64),qVar"state"),
                      LC("RSP",CTy"Zreg"),Var("v",F64))])))))
;
val x64_push_def = Def
  ("x64_push",Var("imm_rm",CTy"Zimm_rm"),
   Close
     (qVar"state",
      Apply
        (Call
           ("x64_push_aux",ATy(qTy,qTy),
            Apply
              (Call
                 ("EA",ATy(qTy,F64),
                  Apply
                    (Call
                       ("ea_Zimm_rm",ATy(qTy,CTy"Zea"),
                        Var("imm_rm",CTy"Zimm_rm")),qVar"state")),
               qVar"state")),qVar"state")))
;
val x64_push_rip_def = Def
  ("x64_push_rip",qVar"state",
   Apply
     (Call("x64_push_aux",ATy(qTy,qTy),Dest("RIP",F64,qVar"state")),
      qVar"state"))
;
val x64_drop_def = Def
  ("x64_drop",Var("imm",F64),
   Close
     (qVar"state",
      Let(qVar"s",
          ITE(Mop(Not,EQ(EX(Var("imm",F64),LN 7,LN 0,F8),LW(0,8))),
              Mop(Snd,
                  Apply
                    (Call
                       ("raise'exception",ATy(qTy,PTy(uTy,qTy)),
                        Call("FAILURE",CTy"exception",LS"x64_drop")),
                     qVar"state")),qVar"state"),
          Rupd
            ("REG",
             TP[qVar"s",
                Fupd
                  (Dest("REG",ATy(CTy"Zreg",F64),qVar"s"),
                   LC("RSP",CTy"Zreg"),
                   Bop(Add,
                       Apply
                         (Dest("REG",ATy(CTy"Zreg",F64),qVar"s"),
                          LC("RSP",CTy"Zreg")),Var("imm",F64)))]))))
;
val initial_ieee_flags_def = Def
  ("initial_ieee_flags",bVar"invalid",
   Rupd
     ("Underflow",
      TP[Rupd
           ("Precision",
            TP[Rupd
                 ("Overflow",
                  TP[Rupd
                       ("InvalidOp",
                        TP[Rupd("DivideByZero",TP[LX fTy,LF]),
                           bVar"invalid"]),LF]),LF]),LF]))
;
val set_precision_def = Def
  ("set_precision",TP[Var("flags",fTy),bVar"b"],
   Rupd("Precision",TP[Var("flags",fTy),bVar"b"]))
;
val zero32_def = Def
  ("zero32",Var("a",F32),ITE(Mop(Msb,Var("a",F32)),NEGZERO32,POSZERO32))
;
val zero64_def = Def
  ("zero64",Var("a",F64),ITE(Mop(Msb,Var("a",F64)),NEGZERO64,POSZERO64))
;
val denormal_to_zero32_def = Def
  ("denormal_to_zero32",Var("a",F32),
   Close
     (qVar"state",
      ITE(Bop(And,Dest("DAZ",bTy,Dest("MXCSR",CTy"MXCSR",qVar"state")),
              Mop(FPIsSubnormal 32,Var("a",F32))),
          Call("zero32",F32,Var("a",F32)),Var("a",F32))))
;
val denormal_to_zero64_def = Def
  ("denormal_to_zero64",Var("a",F64),
   Close
     (qVar"state",
      ITE(Bop(And,Dest("DAZ",bTy,Dest("MXCSR",CTy"MXCSR",qVar"state")),
              Mop(FPIsSubnormal 64,Var("a",F64))),
          Call("zero64",F64,Var("a",F64)),Var("a",F64))))
;
val flush_to_zero32_def = Def
  ("flush_to_zero32",TP[Var("flags",fTy),Var("a",F32)],
   Close
     (qVar"state",
      ITE(Bop(And,Dest("FZ",bTy,Dest("MXCSR",CTy"MXCSR",qVar"state")),
              Bop(And,Dest("UM",bTy,Dest("MXCSR",CTy"MXCSR",qVar"state")),
                  Dest("Underflow",bTy,Var("flags",fTy)))),
          TP[Call("set_precision",fTy,TP[Var("flags",fTy),LT]),
             Call("zero32",F32,Var("a",F32))],
          TP[Var("flags",fTy),Var("a",F32)])))
;
val flush_to_zero64_def = Def
  ("flush_to_zero64",TP[Var("flags",fTy),Var("a",F64)],
   Close
     (qVar"state",
      ITE(Bop(And,Dest("FZ",bTy,Dest("MXCSR",CTy"MXCSR",qVar"state")),
              Bop(And,Dest("UM",bTy,Dest("MXCSR",CTy"MXCSR",qVar"state")),
                  Dest("Underflow",bTy,Var("flags",fTy)))),
          TP[Call("set_precision",fTy,TP[Var("flags",fTy),LT]),
             Call("zero64",F64,Var("a",F64))],
          TP[Var("flags",fTy),Var("a",F64)])))
;
val sse_from_int64_def = Def
  ("sse_from_int64",TP[Var("m",rTy),Var("w",BTy"N")],
   Let(iVar"i",Mop(Cast iTy,Var("w",BTy"N")),
       Let(Var("q",F64),Mop(FPFromInt 64,TP[Var("m",rTy),iVar"i"]),
           TP[Call
                ("set_precision",fTy,
                 TP[Call("initial_ieee_flags",fTy,LF),
                    Mop(Not,
                        EQ(Mop(FPToInt 64,TP[Var("m",rTy),Var("q",F64)]),
                           Mop(Some,iVar"i")))]),Var("q",F64)])))
;
val sse_from_int32_def = Def
  ("sse_from_int32",TP[Var("m",rTy),Var("w",BTy"N")],
   Let(iVar"i",Mop(Cast iTy,Var("w",BTy"N")),
       Let(Var("d",F32),Mop(FPFromInt 32,TP[Var("m",rTy),iVar"i"]),
           TP[Call
                ("set_precision",fTy,
                 TP[Call("initial_ieee_flags",fTy,LF),
                    Mop(Not,
                        EQ(Mop(FPToInt 32,TP[Var("m",rTy),Var("d",F32)]),
                           Mop(Some,iVar"i")))]),Var("d",F32)])))
;
val sse_to_int64_def = Def
  ("sse_to_int64",TP[Var("m",rTy),Var("a",F64)],
   CS(Mop(FPToInt 64,TP[Var("m",rTy),Var("a",F64)]),
      [(Mop(Some,iVar"i"),
        ITE(Bop(And,
                Bop(Le,
                    Mop(Neg,
                        Bop(Exp,LI 2,Bop(Sub,Mop(Size,LY(0,"N")),LN 1))),
                    iVar"i"),
                Bop(Le,iVar"i",
                    Bop(Sub,
                        Bop(Exp,LI 2,Bop(Sub,Mop(Size,LY(0,"N")),LN 1)),
                        LI 1))),
            Let(Var("w",BTy"N"),Mop(Cast(BTy"N"),iVar"i"),
                TP[Call
                     ("set_precision",fTy,
                      TP[Call("initial_ieee_flags",fTy,LF),
                         Mop(Not,
                             Mop(FPEq 64,
                                 TP[Mop(FPFromInt 64,
                                        TP[Var("m",rTy),
                                           Mop(Cast iTy,Var("w",BTy"N"))]),
                                    Var("a",F64)]))]),Var("w",BTy"N")]),
            TP[Call("initial_ieee_flags",fTy,LT),Bop(Ror,LY(1,"N"),LN 1)])),
       (LO iTy,
        TP[Call("initial_ieee_flags",fTy,LT),Bop(Ror,LY(1,"N"),LN 1)])]))
;
val sse_to_int32_def = Def
  ("sse_to_int32",TP[Var("m",rTy),Var("a",F32)],
   CS(Mop(FPToInt 32,TP[Var("m",rTy),Var("a",F32)]),
      [(Mop(Some,iVar"i"),
        ITE(Bop(And,
                Bop(Le,
                    Mop(Neg,
                        Bop(Exp,LI 2,Bop(Sub,Mop(Size,LY(0,"N")),LN 1))),
                    iVar"i"),
                Bop(Le,iVar"i",
                    Bop(Sub,
                        Bop(Exp,LI 2,Bop(Sub,Mop(Size,LY(0,"N")),LN 1)),
                        LI 1))),
            Let(Var("w",BTy"N"),Mop(Cast(BTy"N"),iVar"i"),
                TP[Call
                     ("set_precision",fTy,
                      TP[Call("initial_ieee_flags",fTy,LF),
                         Mop(Not,
                             Mop(FPEq 32,
                                 TP[Mop(FPFromInt 32,
                                        TP[Var("m",rTy),
                                           Mop(Cast iTy,Var("w",BTy"N"))]),
                                    Var("a",F32)]))]),Var("w",BTy"N")]),
            TP[Call("initial_ieee_flags",fTy,LT),Bop(Ror,LY(1,"N"),LN 1)])),
       (LO iTy,
        TP[Call("initial_ieee_flags",fTy,LT),Bop(Ror,LY(1,"N"),LN 1)])]))
;
val float_min32_def = Def
  ("float_min32",TP[Var("a",F32),Var("b",F32)],
   Let(Var("flags",fTy),
       Call
         ("initial_ieee_flags",fTy,
          EQ(Mop(FPCmp 32,TP[Var("a",F32),Var("b",F32)]),
             binary_ieeeSyntax.UN_tm)),
       TP[Var("flags",fTy),
          ITE(Bop(And,Mop(Not,Dest("InvalidOp",bTy,Var("flags",fTy))),
                  Mop(FPLt 32,TP[Var("a",F32),Var("b",F32)])),
              Var("a",F32),Var("b",F32))]))
;
val float_max32_def = Def
  ("float_max32",TP[Var("a",F32),Var("b",F32)],
   Let(Var("flags",fTy),
       Call
         ("initial_ieee_flags",fTy,
          EQ(Mop(FPCmp 32,TP[Var("a",F32),Var("b",F32)]),
             binary_ieeeSyntax.UN_tm)),
       TP[Var("flags",fTy),
          ITE(Bop(Or,Dest("InvalidOp",bTy,Var("flags",fTy)),
                  Mop(FPLe 32,TP[Var("a",F32),Var("b",F32)])),
              Var("b",F32),Var("a",F32))]))
;
val float_min64_def = Def
  ("float_min64",TP[Var("a",F64),Var("b",F64)],
   Let(Var("flags",fTy),
       Call
         ("initial_ieee_flags",fTy,
          EQ(Mop(FPCmp 64,TP[Var("a",F64),Var("b",F64)]),
             binary_ieeeSyntax.UN_tm)),
       TP[Var("flags",fTy),
          ITE(Bop(And,Mop(Not,Dest("InvalidOp",bTy,Var("flags",fTy))),
                  Mop(FPLt 64,TP[Var("a",F64),Var("b",F64)])),
              Var("a",F64),Var("b",F64))]))
;
val float_max64_def = Def
  ("float_max64",TP[Var("a",F64),Var("b",F64)],
   Let(Var("flags",fTy),
       Call
         ("initial_ieee_flags",fTy,
          EQ(Mop(FPCmp 64,TP[Var("a",F64),Var("b",F64)]),
             binary_ieeeSyntax.UN_tm)),
       TP[Var("flags",fTy),
          ITE(Bop(Or,Dest("InvalidOp",bTy,Var("flags",fTy)),
                  Mop(FPLe 64,TP[Var("a",F64),Var("b",F64)])),
              Var("b",F64),Var("a",F64))]))
;
val process_float_flags_def = Def
  ("process_float_flags",Var("l",LTy(PTy(bTy,fTy))),
   Close
     (qVar"state",
      Let(Var("s",PTy(fTy,PTy(bTy,qTy))),
          Mop(Snd,
              Apply
                (Foreach
                   (TP[Var("l",LTy(PTy(bTy,fTy))),
                       Close
                         (Var("x",PTy(bTy,fTy)),
                          Close
                            (Var("state",PTy(fTy,PTy(bTy,qTy))),
                             Let(TP[bVar"d",Var("flags",fTy)],
                                 Var("x",PTy(bTy,fTy)),
                                 Let(Var("s0",fTy),
                                     Mop(Fst,
                                         Var("state",PTy(fTy,PTy(bTy,qTy)))),
                                     Let(Var("s0",fTy),
                                         Rupd
                                           ("DivideByZero",
                                            TP[Var("s0",fTy),
                                               Bop(Or,
                                                   Dest
                                                     ("DivideByZero",bTy,
                                                      Var("s0",fTy)),
                                                   Dest
                                                     ("DivideByZero",bTy,
                                                      Var("flags",fTy)))]),
                                         Let(Var("s0",fTy),
                                             Rupd
                                               ("InvalidOp",
                                                TP[Var("s0",fTy),
                                                   Bop(Or,
                                                       Dest
                                                         ("InvalidOp",bTy,
                                                          Var("s0",fTy)),
                                                       Dest
                                                         ("InvalidOp",bTy,
                                                          Var("flags",fTy)))]),
                                             Let(Var("s0",fTy),
                                                 Rupd
                                                   ("Overflow",
                                                    TP[Var("s0",fTy),
                                                       Bop(Or,
                                                           Dest
                                                             ("Overflow",
                                                              bTy,
                                                              Var("s0",fTy)),
                                                           Dest
                                                             ("Overflow",
                                                              bTy,
                                                              Var("flags",
                                                                  fTy)))]),
                                                 Let(Var("s0",fTy),
                                                     Rupd
                                                       ("Precision",
                                                        TP[Var("s0",fTy),
                                                           Bop(Or,
                                                               Dest
                                                                 ("Precision",
                                                                  bTy,
                                                                  Var("s0",
                                                                      fTy)),
                                                               Dest
                                                                 ("Precision",
                                                                  bTy,
                                                                  Var("flags",
                                                                      fTy)))]),
                                                     TP[LU,
                                                        Rupd
                                                          ("Underflow",
                                                           TP[Var("s0",fTy),
                                                              Bop(Or,
                                                                  Dest
                                                                    ("Underflow",
                                                                     bTy,
                                                                     Var("s0",
                                                                         fTy)),
                                                                  Dest
                                                                    ("Underflow",
                                                                     bTy,
                                                                     Var("flags",
                                                                         fTy)))]),
                                                        Bop(Or,
                                                            Mop(Fst,
                                                                Mop(Snd,
                                                                    Var("state",
                                                                        PTy(fTy,
                                                                            PTy(bTy,
                                                                                qTy))))),
                                                            bVar"d"),
                                                        Mop(Snd,
                                                            Mop(Snd,
                                                                Var("state",
                                                                    PTy(fTy,
                                                                        PTy(bTy,
                                                                            qTy)))))]))))))))]),
                 TP[Call("initial_ieee_flags",fTy,LF),LF,qVar"state"])),
          Let(Var("s",PTy(fTy,PTy(bTy,qTy))),
              TP[Mop(Fst,Var("s",PTy(fTy,PTy(bTy,qTy)))),
                 Let(Var("s0",PTy(bTy,qTy)),
                     Mop(Snd,Var("s",PTy(fTy,PTy(bTy,qTy)))),
                     TP[Mop(Fst,Var("s0",PTy(bTy,qTy))),
                        Rupd
                          ("MXCSR",
                           TP[Mop(Snd,Var("s0",PTy(bTy,qTy))),
                              Rupd
                                ("IE",
                                 TP[Dest
                                      ("MXCSR",CTy"MXCSR",
                                       Mop(Snd,
                                           Mop(Snd,
                                               Var("s",
                                                   PTy(fTy,PTy(bTy,qTy)))))),
                                    Bop(Or,
                                        Dest
                                          ("IE",bTy,
                                           Dest
                                             ("MXCSR",CTy"MXCSR",
                                              Mop(Snd,
                                                  Mop(Snd,
                                                      Var("s",
                                                          PTy(fTy,
                                                              PTy(bTy,qTy))))))),
                                        Dest
                                          ("InvalidOp",bTy,
                                           Mop(Fst,
                                               Var("s",
                                                   PTy(fTy,PTy(bTy,qTy))))))])])])],
              Let(Var("s",PTy(fTy,PTy(bTy,qTy))),
                  TP[Mop(Fst,Var("s",PTy(fTy,PTy(bTy,qTy)))),
                     Let(Var("s0",PTy(bTy,qTy)),
                         Mop(Snd,Var("s",PTy(fTy,PTy(bTy,qTy)))),
                         TP[Mop(Fst,Var("s0",PTy(bTy,qTy))),
                            Rupd
                              ("MXCSR",
                               TP[Mop(Snd,Var("s0",PTy(bTy,qTy))),
                                  Rupd
                                    ("DE",
                                     TP[Dest
                                          ("MXCSR",CTy"MXCSR",
                                           Mop(Snd,
                                               Mop(Snd,
                                                   Var("s",
                                                       PTy(fTy,
                                                           PTy(bTy,qTy)))))),
                                        Bop(Or,
                                            Dest
                                              ("DE",bTy,
                                               Dest
                                                 ("MXCSR",CTy"MXCSR",
                                                  Mop(Snd,
                                                      Mop(Snd,
                                                          Var("s",
                                                              PTy(fTy,
                                                                  PTy(bTy,
                                                                      qTy))))))),
                                            Mop(Fst,
                                                Mop(Snd,
                                                    Var("s",
                                                        PTy(fTy,
                                                            PTy(bTy,qTy))))))])])])],
                  Let(Var("s",PTy(fTy,PTy(bTy,qTy))),
                      TP[Mop(Fst,Var("s",PTy(fTy,PTy(bTy,qTy)))),
                         Let(Var("s0",PTy(bTy,qTy)),
                             Mop(Snd,Var("s",PTy(fTy,PTy(bTy,qTy)))),
                             TP[Mop(Fst,Var("s0",PTy(bTy,qTy))),
                                Rupd
                                  ("MXCSR",
                                   TP[Mop(Snd,Var("s0",PTy(bTy,qTy))),
                                      Rupd
                                        ("ZE",
                                         TP[Dest
                                              ("MXCSR",CTy"MXCSR",
                                               Mop(Snd,
                                                   Mop(Snd,
                                                       Var("s",
                                                           PTy(fTy,
                                                               PTy(bTy,qTy)))))),
                                            Bop(Or,
                                                Dest
                                                  ("ZE",bTy,
                                                   Dest
                                                     ("MXCSR",CTy"MXCSR",
                                                      Mop(Snd,
                                                          Mop(Snd,
                                                              Var("s",
                                                                  PTy(fTy,
                                                                      PTy(bTy,
                                                                          qTy))))))),
                                                Dest
                                                  ("DivideByZero",bTy,
                                                   Mop(Fst,
                                                       Var("s",
                                                           PTy(fTy,
                                                               PTy(bTy,qTy))))))])])])],
                      Let(Var("s",PTy(fTy,PTy(bTy,qTy))),
                          ITE(Bop(Or,
                                  Bop(And,
                                      Dest
                                        ("InvalidOp",bTy,
                                         Mop(Fst,
                                             Var("s",PTy(fTy,PTy(bTy,qTy))))),
                                      Mop(Not,
                                          Dest
                                            ("IM",bTy,
                                             Dest
                                               ("MXCSR",CTy"MXCSR",
                                                Mop(Snd,
                                                    Mop(Snd,
                                                        Var("s",
                                                            PTy(fTy,
                                                                PTy(bTy,
                                                                    qTy))))))))),
                                  Bop(Or,
                                      Bop(And,
                                          Mop(Fst,
                                              Mop(Snd,
                                                  Var("s",
                                                      PTy(fTy,PTy(bTy,qTy))))),
                                          Mop(Not,
                                              Dest
                                                ("DM",bTy,
                                                 Dest
                                                   ("MXCSR",CTy"MXCSR",
                                                    Mop(Snd,
                                                        Mop(Snd,
                                                            Var("s",
                                                                PTy(fTy,
                                                                    PTy(bTy,
                                                                        qTy))))))))),
                                      Bop(And,
                                          Dest
                                            ("DivideByZero",bTy,
                                             Mop(Fst,
                                                 Var("s",
                                                     PTy(fTy,PTy(bTy,qTy))))),
                                          Mop(Not,
                                              Dest
                                                ("ZM",bTy,
                                                 Dest
                                                   ("MXCSR",CTy"MXCSR",
                                                    Mop(Snd,
                                                        Mop(Snd,
                                                            Var("s",
                                                                PTy(fTy,
                                                                    PTy(bTy,
                                                                        qTy))))))))))),
                              TP[Mop(Fst,Var("s",PTy(fTy,PTy(bTy,qTy)))),
                                 Mop(Fst,
                                     Mop(Snd,
                                         Var("s",PTy(fTy,PTy(bTy,qTy))))),
                                 Apply
                                   (Const("XM_exception",ATy(qTy,qTy)),
                                    Mop(Snd,
                                        Mop(Snd,
                                            Var("s",PTy(fTy,PTy(bTy,qTy))))))],
                              Var("s",PTy(fTy,PTy(bTy,qTy)))),
                          Let(Var("s",PTy(fTy,PTy(bTy,qTy))),
                              TP[Mop(Fst,Var("s",PTy(fTy,PTy(bTy,qTy)))),
                                 Let(Var("s0",PTy(bTy,qTy)),
                                     Mop(Snd,
                                         Var("s",PTy(fTy,PTy(bTy,qTy)))),
                                     TP[Mop(Fst,Var("s0",PTy(bTy,qTy))),
                                        Rupd
                                          ("MXCSR",
                                           TP[Mop(Snd,
                                                  Var("s0",PTy(bTy,qTy))),
                                              Rupd
                                                ("OE",
                                                 TP[Dest
                                                      ("MXCSR",CTy"MXCSR",
                                                       Mop(Snd,
                                                           Mop(Snd,
                                                               Var("s",
                                                                   PTy(fTy,
                                                                       PTy(bTy,
                                                                           qTy)))))),
                                                    Bop(Or,
                                                        Dest
                                                          ("OE",bTy,
                                                           Dest
                                                             ("MXCSR",
                                                              CTy"MXCSR",
                                                              Mop(Snd,
                                                                  Mop(Snd,
                                                                      Var("s",
                                                                          PTy(fTy,
                                                                              PTy(bTy,
                                                                                  qTy))))))),
                                                        Dest
                                                          ("Overflow",bTy,
                                                           Mop(Fst,
                                                               Var("s",
                                                                   PTy(fTy,
                                                                       PTy(bTy,
                                                                           qTy))))))])])])],
                              Let(Var("s",PTy(fTy,PTy(bTy,qTy))),
                                  TP[Mop(Fst,
                                         Var("s",PTy(fTy,PTy(bTy,qTy)))),
                                     Let(Var("s0",PTy(bTy,qTy)),
                                         Mop(Snd,
                                             Var("s",PTy(fTy,PTy(bTy,qTy)))),
                                         TP[Mop(Fst,Var("s0",PTy(bTy,qTy))),
                                            Rupd
                                              ("MXCSR",
                                               TP[Mop(Snd,
                                                      Var("s0",
                                                          PTy(bTy,qTy))),
                                                  Rupd
                                                    ("PE",
                                                     TP[Dest
                                                          ("MXCSR",
                                                           CTy"MXCSR",
                                                           Mop(Snd,
                                                               Mop(Snd,
                                                                   Var("s",
                                                                       PTy(fTy,
                                                                           PTy(bTy,
                                                                               qTy)))))),
                                                        Bop(Or,
                                                            Dest
                                                              ("PE",bTy,
                                                               Dest
                                                                 ("MXCSR",
                                                                  CTy"MXCSR",
                                                                  Mop(Snd,
                                                                      Mop(Snd,
                                                                          Var("s",
                                                                              PTy(fTy,
                                                                                  PTy(bTy,
                                                                                      qTy))))))),
                                                            Dest
                                                              ("Precision",
                                                               bTy,
                                                               Mop(Fst,
                                                                   Var("s",
                                                                       PTy(fTy,
                                                                           PTy(bTy,
                                                                               qTy))))))])])])],
                                  Let(Var("s",PTy(fTy,PTy(bTy,qTy))),
                                      TP[Mop(Fst,
                                             Var("s",PTy(fTy,PTy(bTy,qTy)))),
                                         Let(Var("s0",PTy(bTy,qTy)),
                                             Mop(Snd,
                                                 Var("s",
                                                     PTy(fTy,PTy(bTy,qTy)))),
                                             TP[Mop(Fst,
                                                    Var("s0",PTy(bTy,qTy))),
                                                Rupd
                                                  ("MXCSR",
                                                   TP[Mop(Snd,
                                                          Var("s0",
                                                              PTy(bTy,qTy))),
                                                      Rupd
                                                        ("UE",
                                                         TP[Dest
                                                              ("MXCSR",
                                                               CTy"MXCSR",
                                                               Mop(Snd,
                                                                   Mop(Snd,
                                                                       Var("s",
                                                                           PTy(fTy,
                                                                               PTy(bTy,
                                                                                   qTy)))))),
                                                            Bop(Or,
                                                                Dest
                                                                  ("UE",
                                                                   bTy,
                                                                   Dest
                                                                     ("MXCSR",
                                                                      CTy"MXCSR",
                                                                      Mop(Snd,
                                                                          Mop(Snd,
                                                                              Var("s",
                                                                                  PTy(fTy,
                                                                                      PTy(bTy,
                                                                                          qTy))))))),
                                                                Dest
                                                                  ("Underflow",
                                                                   bTy,
                                                                   Mop(Fst,
                                                                       Var("s",
                                                                           PTy(fTy,
                                                                               PTy(bTy,
                                                                                   qTy))))))])])])],
                                      ITE(Bop(Or,
                                              Bop(And,
                                                  Dest
                                                    ("Overflow",bTy,
                                                     Mop(Fst,
                                                         Var("s",
                                                             PTy(fTy,
                                                                 PTy(bTy,
                                                                     qTy))))),
                                                  Mop(Not,
                                                      Dest
                                                        ("OM",bTy,
                                                         Dest
                                                           ("MXCSR",
                                                            CTy"MXCSR",
                                                            Mop(Snd,
                                                                Mop(Snd,
                                                                    Var("s",
                                                                        PTy(fTy,
                                                                            PTy(bTy,
                                                                                qTy))))))))),
                                              Bop(Or,
                                                  Bop(And,
                                                      Dest
                                                        ("Precision",bTy,
                                                         Mop(Fst,
                                                             Var("s",
                                                                 PTy(fTy,
                                                                     PTy(bTy,
                                                                         qTy))))),
                                                      Mop(Not,
                                                          Dest
                                                            ("PM",bTy,
                                                             Dest
                                                               ("MXCSR",
                                                                CTy"MXCSR",
                                                                Mop(Snd,
                                                                    Mop(Snd,
                                                                        Var("s",
                                                                            PTy(fTy,
                                                                                PTy(bTy,
                                                                                    qTy))))))))),
                                                  Bop(And,
                                                      Dest
                                                        ("Underflow",bTy,
                                                         Mop(Fst,
                                                             Var("s",
                                                                 PTy(fTy,
                                                                     PTy(bTy,
                                                                         qTy))))),
                                                      Mop(Not,
                                                          Dest
                                                            ("UM",bTy,
                                                             Dest
                                                               ("MXCSR",
                                                                CTy"MXCSR",
                                                                Mop(Snd,
                                                                    Mop(Snd,
                                                                        Var("s",
                                                                            PTy(fTy,
                                                                                PTy(bTy,
                                                                                    qTy))))))))))),
                                          Apply
                                            (Const
                                               ("XM_exception",
                                                ATy(qTy,qTy)),
                                             Mop(Snd,
                                                 Mop(Snd,
                                                     Var("s",
                                                         PTy(fTy,
                                                             PTy(bTy,qTy)))))),
                                          Mop(Snd,
                                              Mop(Snd,
                                                  Var("s",
                                                      PTy(fTy,PTy(bTy,qTy))))))))))))))))
;
val RoundingMode_def = Def
  ("RoundingMode",qVar"state",
   CS(Dest("RC",FTy 2,Dest("MXCSR",CTy"MXCSR",qVar"state")),
      [(LW(0,2),binary_ieeeSyntax.roundTiesToEven_tm),
       (LW(1,2),binary_ieeeSyntax.roundTowardNegative_tm),
       (LW(2,2),binary_ieeeSyntax.roundTowardPositive_tm),
       (LW(3,2),binary_ieeeSyntax.roundTowardZero_tm)]))
;
val sse_binop32_def = Def
  ("sse_binop32",TP[Var("bop",CTy"sse_binop"),Var("a",F32),Var("b",F32)],
   Close
     (qVar"state",
      Let(Var("v",F32),
          Apply
            (Call("denormal_to_zero32",ATy(qTy,F32),Var("a",F32)),
             qVar"state"),
          Let(Var("v0",F32),
              Apply
                (Call("denormal_to_zero32",ATy(qTy,F32),Var("b",F32)),
                 qVar"state"),
              Let(TP[Var("v",PTy(fTy,F32)),qVar"s"],
                  CS(Var("bop",CTy"sse_binop"),
                     [(LC("sse_add",CTy"sse_binop"),
                       TP[Apply
                            (Call
                               ("flush_to_zero32",ATy(qTy,PTy(fTy,F32)),
                                Mop(FPAdd_ 32,
                                    TP[Apply
                                         (Const
                                            ("RoundingMode",ATy(qTy,rTy)),
                                          qVar"state"),Var("v",F32),
                                       Var("v0",F32)])),qVar"state"),
                          qVar"state"]),
                      (LC("sse_sub",CTy"sse_binop"),
                       TP[Apply
                            (Call
                               ("flush_to_zero32",ATy(qTy,PTy(fTy,F32)),
                                Mop(FPSub_ 32,
                                    TP[Apply
                                         (Const
                                            ("RoundingMode",ATy(qTy,rTy)),
                                          qVar"state"),Var("v",F32),
                                       Var("v0",F32)])),qVar"state"),
                          qVar"state"]),
                      (LC("sse_mul",CTy"sse_binop"),
                       TP[Apply
                            (Call
                               ("flush_to_zero32",ATy(qTy,PTy(fTy,F32)),
                                Mop(FPMul_ 32,
                                    TP[Apply
                                         (Const
                                            ("RoundingMode",ATy(qTy,rTy)),
                                          qVar"state"),Var("v",F32),
                                       Var("v0",F32)])),qVar"state"),
                          qVar"state"]),
                      (LC("sse_div",CTy"sse_binop"),
                       TP[Apply
                            (Call
                               ("flush_to_zero32",ATy(qTy,PTy(fTy,F32)),
                                Mop(FPDiv_ 32,
                                    TP[Apply
                                         (Const
                                            ("RoundingMode",ATy(qTy,rTy)),
                                          qVar"state"),Var("v",F32),
                                       Var("v0",F32)])),qVar"state"),
                          qVar"state"]),
                      (LC("sse_max",CTy"sse_binop"),
                       TP[Call
                            ("float_max32",PTy(fTy,F32),
                             TP[Var("v",F32),Var("v0",F32)]),qVar"state"]),
                      (LC("sse_min",CTy"sse_binop"),
                       TP[Call
                            ("float_min32",PTy(fTy,F32),
                             TP[Var("v",F32),Var("v0",F32)]),qVar"state"])]),
                  CS(Var("v",PTy(fTy,F32)),
                     [(TP[Var("f",fTy),Var("r",F32)],
                       TP[TP[Bop(Or,Mop(FPIsSubnormal 32,Var("a",F32)),
                                 Mop(FPIsSubnormal 32,Var("b",F32))),
                             Var("f",fTy)],Var("r",F32)])]))))))
;
val sse_binop64_def = Def
  ("sse_binop64",TP[Var("bop",CTy"sse_binop"),Var("a",F64),Var("b",F64)],
   Close
     (qVar"state",
      Let(Var("v",F64),
          Apply
            (Call("denormal_to_zero64",ATy(qTy,F64),Var("a",F64)),
             qVar"state"),
          Let(Var("v0",F64),
              Apply
                (Call("denormal_to_zero64",ATy(qTy,F64),Var("b",F64)),
                 qVar"state"),
              Let(TP[Var("v",PTy(fTy,F64)),qVar"s"],
                  CS(Var("bop",CTy"sse_binop"),
                     [(LC("sse_add",CTy"sse_binop"),
                       TP[Apply
                            (Call
                               ("flush_to_zero64",ATy(qTy,PTy(fTy,F64)),
                                Mop(FPAdd_ 64,
                                    TP[Apply
                                         (Const
                                            ("RoundingMode",ATy(qTy,rTy)),
                                          qVar"state"),Var("v",F64),
                                       Var("v0",F64)])),qVar"state"),
                          qVar"state"]),
                      (LC("sse_sub",CTy"sse_binop"),
                       TP[Apply
                            (Call
                               ("flush_to_zero64",ATy(qTy,PTy(fTy,F64)),
                                Mop(FPSub_ 64,
                                    TP[Apply
                                         (Const
                                            ("RoundingMode",ATy(qTy,rTy)),
                                          qVar"state"),Var("v",F64),
                                       Var("v0",F64)])),qVar"state"),
                          qVar"state"]),
                      (LC("sse_mul",CTy"sse_binop"),
                       TP[Apply
                            (Call
                               ("flush_to_zero64",ATy(qTy,PTy(fTy,F64)),
                                Mop(FPMul_ 64,
                                    TP[Apply
                                         (Const
                                            ("RoundingMode",ATy(qTy,rTy)),
                                          qVar"state"),Var("v",F64),
                                       Var("v0",F64)])),qVar"state"),
                          qVar"state"]),
                      (LC("sse_div",CTy"sse_binop"),
                       TP[Apply
                            (Call
                               ("flush_to_zero64",ATy(qTy,PTy(fTy,F64)),
                                Mop(FPDiv_ 64,
                                    TP[Apply
                                         (Const
                                            ("RoundingMode",ATy(qTy,rTy)),
                                          qVar"state"),Var("v",F64),
                                       Var("v0",F64)])),qVar"state"),
                          qVar"state"]),
                      (LC("sse_max",CTy"sse_binop"),
                       TP[Call
                            ("float_max64",PTy(fTy,F64),
                             TP[Var("v",F64),Var("v0",F64)]),qVar"state"]),
                      (LC("sse_min",CTy"sse_binop"),
                       TP[Call
                            ("float_min64",PTy(fTy,F64),
                             TP[Var("v",F64),Var("v0",F64)]),qVar"state"])]),
                  CS(Var("v",PTy(fTy,F64)),
                     [(TP[Var("f",fTy),Var("r",F64)],
                       TP[TP[Bop(Or,Mop(FPIsSubnormal 64,Var("a",F64)),
                                 Mop(FPIsSubnormal 64,Var("b",F64))),
                             Var("f",fTy)],Var("r",F64)])]))))))
;
val sse_sqrt32_def = Def
  ("sse_sqrt32",Var("a",F32),
   Close
     (qVar"state",
      CS(Mop(FPSqrt_ 32,
             TP[Apply(Const("RoundingMode",ATy(qTy,rTy)),qVar"state"),
                Apply
                  (Call("denormal_to_zero32",ATy(qTy,F32),Var("a",F32)),
                   qVar"state")]),
         [(TP[Var("f",fTy),Var("r",F32)],
           TP[TP[Mop(FPIsSubnormal 32,Var("a",F32)),Var("f",fTy)],
              Var("r",F32)])])))
;
val sse_sqrt64_def = Def
  ("sse_sqrt64",Var("a",F64),
   Close
     (qVar"state",
      CS(Mop(FPSqrt_ 64,
             TP[Apply(Const("RoundingMode",ATy(qTy,rTy)),qVar"state"),
                Apply
                  (Call("denormal_to_zero64",ATy(qTy,F64),Var("a",F64)),
                   qVar"state")]),
         [(TP[Var("f",fTy),Var("r",F64)],
           TP[TP[Mop(FPIsSubnormal 64,Var("a",F64)),Var("f",fTy)],
              Var("r",F64)])])))
;
val sse_logic_def = Def
  ("sse_logic",
   TP[Var("bop",CTy"sse_logic"),Var("a",BTy"N"),Var("b",BTy"N")],
   CS(Var("bop",CTy"sse_logic"),
      [(LC("sse_and",CTy"sse_logic"),
        Bop(BAnd,Var("a",BTy"N"),Var("b",BTy"N"))),
       (LC("sse_or",CTy"sse_logic"),
        Bop(BOr,Var("a",BTy"N"),Var("b",BTy"N"))),
       (LC("sse_xor",CTy"sse_logic"),
        Bop(BXor,Var("a",BTy"N"),Var("b",BTy"N"))),
       (LC("sse_andn",CTy"sse_logic"),
        Bop(BAnd,Mop(BNot,Var("a",BTy"N")),Var("b",BTy"N")))]))
;
val sse_compare_signalling_def = Def
  ("sse_compare_signalling",Var("cmp",CTy"sse_compare"),
   Bop(In,Var("cmp",CTy"sse_compare"),
       SL[LC("sse_lt_os",CTy"sse_compare"),
          LC("sse_le_os",CTy"sse_compare"),
          LC("sse_nlt_us",CTy"sse_compare"),
          LC("sse_nle_us",CTy"sse_compare")]))
;
val sse_compare32_def = Def
  ("sse_compare32",
   TP[Var("cmp",CTy"sse_compare"),Var("a",F32),Var("b",F32)],
   Let(bVar"unordered",
       EQ(Mop(FPCmp 32,TP[Var("a",F32),Var("b",F32)]),
          binary_ieeeSyntax.UN_tm),
       TP[TP[Bop(Or,Mop(FPIsSubnormal 32,Var("a",F32)),
                 Mop(FPIsSubnormal 32,Var("b",F32))),
             Call
               ("initial_ieee_flags",fTy,
                Bop(Or,Mop(FPIsSignallingNan 32,Var("a",F32)),
                    Bop(Or,Mop(FPIsSignallingNan 32,Var("b",F32)),
                        Bop(And,bVar"unordered",
                            Call
                              ("sse_compare_signalling",bTy,
                               Var("cmp",CTy"sse_compare"))))))],
          Mop(SE F32,
              Mop(Cast F1,
                  CS(Var("cmp",CTy"sse_compare"),
                     [(LC("sse_eq_oq",CTy"sse_compare"),
                       Mop(FPEq 32,TP[Var("a",F32),Var("b",F32)])),
                      (LC("sse_lt_os",CTy"sse_compare"),
                       Mop(FPLt 32,TP[Var("a",F32),Var("b",F32)])),
                      (LC("sse_le_os",CTy"sse_compare"),
                       Mop(FPLe 32,TP[Var("a",F32),Var("b",F32)])),
                      (LC("sse_unord_q",CTy"sse_compare"),bVar"unordered"),
                      (LC("sse_neq_uq",CTy"sse_compare"),
                       Bop(Or,bVar"unordered",
                           Mop(Not,
                               Mop(FPEq 32,TP[Var("a",F32),Var("b",F32)])))),
                      (LC("sse_nlt_us",CTy"sse_compare"),
                       Bop(Or,bVar"unordered",
                           Mop(Not,
                               Mop(FPLt 32,TP[Var("a",F32),Var("b",F32)])))),
                      (LC("sse_nle_us",CTy"sse_compare"),
                       Bop(Or,bVar"unordered",
                           Mop(Not,
                               Mop(FPLe 32,TP[Var("a",F32),Var("b",F32)])))),
                      (Var("sss_ord_q",CTy"sse_compare"),
                       Mop(Not,bVar"unordered"))])))]))
;
val sse_compare64_def = Def
  ("sse_compare64",
   TP[Var("cmp",CTy"sse_compare"),Var("a",F64),Var("b",F64)],
   Let(bVar"unordered",
       EQ(Mop(FPCmp 64,TP[Var("a",F64),Var("b",F64)]),
          binary_ieeeSyntax.UN_tm),
       TP[TP[Bop(Or,Mop(FPIsSubnormal 64,Var("a",F64)),
                 Mop(FPIsSubnormal 64,Var("b",F64))),
             Call
               ("initial_ieee_flags",fTy,
                Bop(Or,Mop(FPIsSignallingNan 64,Var("a",F64)),
                    Bop(Or,Mop(FPIsSignallingNan 64,Var("b",F64)),
                        Bop(And,bVar"unordered",
                            Call
                              ("sse_compare_signalling",bTy,
                               Var("cmp",CTy"sse_compare"))))))],
          Mop(SE F64,
              Mop(Cast F1,
                  CS(Var("cmp",CTy"sse_compare"),
                     [(LC("sse_eq_oq",CTy"sse_compare"),
                       Mop(FPEq 64,TP[Var("a",F64),Var("b",F64)])),
                      (LC("sse_lt_os",CTy"sse_compare"),
                       Mop(FPLt 64,TP[Var("a",F64),Var("b",F64)])),
                      (LC("sse_le_os",CTy"sse_compare"),
                       Mop(FPLe 64,TP[Var("a",F64),Var("b",F64)])),
                      (LC("sse_unord_q",CTy"sse_compare"),bVar"unordered"),
                      (LC("sse_neq_uq",CTy"sse_compare"),
                       Bop(Or,bVar"unordered",
                           Mop(Not,
                               Mop(FPEq 64,TP[Var("a",F64),Var("b",F64)])))),
                      (LC("sse_nlt_us",CTy"sse_compare"),
                       Bop(Or,bVar"unordered",
                           Mop(Not,
                               Mop(FPLt 64,TP[Var("a",F64),Var("b",F64)])))),
                      (LC("sse_nle_us",CTy"sse_compare"),
                       Bop(Or,bVar"unordered",
                           Mop(Not,
                               Mop(FPLe 64,TP[Var("a",F64),Var("b",F64)])))),
                      (Var("sss_ord_q",CTy"sse_compare"),
                       Mop(Not,bVar"unordered"))])))]))
;
val rm_to_xmm_mem_def = Def
  ("rm_to_xmm_mem",Var("rm",CTy"Zrm"),
   CS(Var("rm",CTy"Zrm"),
      [(Call("Zr",CTy"Zrm",Var("r",CTy"Zreg")),
        Call("xmm_reg",CTy"xmm_mem",Mop(Cast(FTy 3),Var("r",CTy"Zreg")))),
       (Call
          ("Zm",CTy"Zrm",
           Var("m",PTy(OTy(PTy(FTy 2,CTy"Zreg")),PTy(CTy"Zbase",F64)))),
        Call
          ("xmm_mem",CTy"xmm_mem",
           Var("m",PTy(OTy(PTy(FTy 2,CTy"Zreg")),PTy(CTy"Zbase",F64)))))]))
;
val XMM_def = Def
  ("XMM",Var("xm",CTy"xmm_mem"),
   Close
     (qVar"state",
      CS(Var("xm",CTy"xmm_mem"),
         [(Call("xmm_reg",CTy"xmm_mem",Var("r",FTy 3)),
           Apply
             (Dest("XMM_REG",ATy(FTy 3,FTy 128),qVar"state"),
              Var("r",FTy 3))),
          (Call
             ("xmm_mem",CTy"xmm_mem",
              Var("m",PTy(OTy(PTy(FTy 2,CTy"Zreg")),PTy(CTy"Zbase",F64)))),
           Apply
             (Call
                ("mem128",ATy(qTy,FTy 128),
                 Apply
                   (Call
                      ("mem_addr",ATy(qTy,F64),
                       Var("m",
                           PTy(OTy(PTy(FTy 2,CTy"Zreg")),
                               PTy(CTy"Zbase",F64)))),qVar"state")),
              qVar"state"))])))
;
val write'XMM_def = Def
  ("write'XMM",TP[Var("dqw",FTy 128),Var("xm",CTy"xmm_mem")],
   Close
     (qVar"state",
      CS(Var("xm",CTy"xmm_mem"),
         [(Call("xmm_reg",CTy"xmm_mem",Var("r",FTy 3)),
           Rupd
             ("XMM_REG",
              TP[qVar"state",
                 Fupd
                   (Dest("XMM_REG",ATy(FTy 3,FTy 128),qVar"state"),
                    Var("r",FTy 3),Var("dqw",FTy 128))])),
          (Call
             ("xmm_mem",CTy"xmm_mem",
              Var("m",PTy(OTy(PTy(FTy 2,CTy"Zreg")),PTy(CTy"Zbase",F64)))),
           Apply
             (Call
                ("write'mem128",ATy(qTy,qTy),
                 TP[Var("dqw",FTy 128),
                    Apply
                      (Call
                         ("mem_addr",ATy(qTy,F64),
                          Var("m",
                              PTy(OTy(PTy(FTy 2,CTy"Zreg")),
                                  PTy(CTy"Zbase",F64)))),qVar"state")]),
              qVar"state"))])))
;
val CheckAlignedXMM_def = Def
  ("CheckAlignedXMM",TP[Var("xm",CTy"xmm_mem"),nVar"n"],
   Close
     (qVar"state",
      CS(Var("xm",CTy"xmm_mem"),
         [(Call("xmm_reg",CTy"xmm_mem",Var("r",FTy 3)),qVar"state"),
          (Call
             ("xmm_mem",CTy"xmm_mem",
              Var("m",PTy(OTy(PTy(FTy 2,CTy"Zreg")),PTy(CTy"Zbase",F64)))),
           Let(Var("v",F64),
               Apply
                 (Call
                    ("mem_addr",ATy(qTy,F64),
                     Var("m",
                         PTy(OTy(PTy(FTy 2,CTy"Zreg")),PTy(CTy"Zbase",F64)))),
                  qVar"state"),
               ITE(Mop(Not,
                       EQ(Bop(Lsl,Bop(Lsr,Var("v",F64),nVar"n"),nVar"n"),
                          Var("v",F64))),
                   Apply(Const("GP_exception",ATy(qTy,qTy)),qVar"state"),
                   qVar"state")))])))
;
val dfn'bin_PD_def = Def
  ("dfn'bin_PD",
   TP[Var("bop",CTy"sse_binop"),Var("dst",FTy 3),Var("src",CTy"xmm_mem")],
   Close
     (qVar"state",
      Let(Var("dst",CTy"xmm_mem"),
          Call("xmm_reg",CTy"xmm_mem",Var("dst",FTy 3)),
          Let(Var("v",FTy 128),
              Apply
                (Call("XMM",ATy(qTy,FTy 128),Var("dst",CTy"xmm_mem")),
                 qVar"state"),
              Let(Var("v0",FTy 128),
                  Apply
                    (Call("XMM",ATy(qTy,FTy 128),Var("src",CTy"xmm_mem")),
                     qVar"state"),
                  Let(TP[Var("f1",PTy(bTy,fTy)),Var("r1",F64)],
                      Apply
                        (Call
                           ("sse_binop64",ATy(qTy,PTy(PTy(bTy,fTy),F64)),
                            TP[Var("bop",CTy"sse_binop"),
                               EX(Var("v",FTy 128),LN 127,LN 64,F64),
                               EX(Var("v0",FTy 128),LN 127,LN 64,F64)]),
                         qVar"state"),
                      Let(TP[Var("f2",PTy(bTy,fTy)),Var("r2",F64)],
                          Apply
                            (Call
                               ("sse_binop64",
                                ATy(qTy,PTy(PTy(bTy,fTy),F64)),
                                TP[Var("bop",CTy"sse_binop"),
                                   EX(Var("v",FTy 128),LN 63,LN 0,F64),
                                   EX(Var("v0",FTy 128),LN 63,LN 0,F64)]),
                             qVar"state"),
                          Apply
                            (Call
                               ("write'XMM",ATy(qTy,qTy),
                                TP[CC[Var("r1",F64),Var("r2",F64)],
                                   Var("dst",CTy"xmm_mem")]),
                             Apply
                               (Call
                                  ("process_float_flags",ATy(qTy,qTy),
                                   LL[Var("f1",PTy(bTy,fTy)),
                                      Var("f2",PTy(bTy,fTy))]),qVar"state")))))))))
;
val dfn'bin_PS_def = Def
  ("dfn'bin_PS",
   TP[Var("bop",CTy"sse_binop"),Var("dst",FTy 3),Var("src",CTy"xmm_mem")],
   Close
     (qVar"state",
      Let(Var("dst",CTy"xmm_mem"),
          Call("xmm_reg",CTy"xmm_mem",Var("dst",FTy 3)),
          Let(Var("v",FTy 128),
              Apply
                (Call("XMM",ATy(qTy,FTy 128),Var("dst",CTy"xmm_mem")),
                 qVar"state"),
              Let(Var("v0",FTy 128),
                  Apply
                    (Call("XMM",ATy(qTy,FTy 128),Var("src",CTy"xmm_mem")),
                     qVar"state"),
                  Let(TP[Var("f1",PTy(bTy,fTy)),Var("r1",F32)],
                      Apply
                        (Call
                           ("sse_binop32",ATy(qTy,PTy(PTy(bTy,fTy),F32)),
                            TP[Var("bop",CTy"sse_binop"),
                               EX(Var("v",FTy 128),LN 127,LN 96,F32),
                               EX(Var("v0",FTy 128),LN 127,LN 96,F32)]),
                         qVar"state"),
                      Let(TP[Var("f2",PTy(bTy,fTy)),Var("r2",F32)],
                          Apply
                            (Call
                               ("sse_binop32",
                                ATy(qTy,PTy(PTy(bTy,fTy),F32)),
                                TP[Var("bop",CTy"sse_binop"),
                                   EX(Var("v",FTy 128),LN 95,LN 64,F32),
                                   EX(Var("v0",FTy 128),LN 95,LN 64,F32)]),
                             qVar"state"),
                          Let(TP[Var("f3",PTy(bTy,fTy)),Var("r3",F32)],
                              Apply
                                (Call
                                   ("sse_binop32",
                                    ATy(qTy,PTy(PTy(bTy,fTy),F32)),
                                    TP[Var("bop",CTy"sse_binop"),
                                       EX(Var("v",FTy 128),LN 63,LN 32,F32),
                                       EX(Var("v0",FTy 128),LN 63,LN 32,
                                          F32)]),qVar"state"),
                              Let(TP[Var("f4",PTy(bTy,fTy)),Var("r4",F32)],
                                  Apply
                                    (Call
                                       ("sse_binop32",
                                        ATy(qTy,PTy(PTy(bTy,fTy),F32)),
                                        TP[Var("bop",CTy"sse_binop"),
                                           EX(Var("v",FTy 128),LN 31,LN 0,
                                              F32),
                                           EX(Var("v0",FTy 128),LN 31,
                                              LN 0,F32)]),qVar"state"),
                                  Apply
                                    (Call
                                       ("write'XMM",ATy(qTy,qTy),
                                        TP[CC[Var("r1",F32),Var("r2",F32),
                                              Var("r3",F32),Var("r4",F32)],
                                           Var("dst",CTy"xmm_mem")]),
                                     Apply
                                       (Call
                                          ("process_float_flags",
                                           ATy(qTy,qTy),
                                           LL[Var("f1",PTy(bTy,fTy)),
                                              Var("f2",PTy(bTy,fTy)),
                                              Var("f3",PTy(bTy,fTy)),
                                              Var("f4",PTy(bTy,fTy))]),
                                        qVar"state")))))))))))
;
val dfn'bin_SD_def = Def
  ("dfn'bin_SD",
   TP[Var("bop",CTy"sse_binop"),Var("dst",FTy 3),Var("src",CTy"xmm_mem")],
   Close
     (qVar"state",
      Let(Var("dst",CTy"xmm_mem"),
          Call("xmm_reg",CTy"xmm_mem",Var("dst",FTy 3)),
          Let(TP[Var("f",PTy(bTy,fTy)),Var("r",F64)],
              Apply
                (Call
                   ("sse_binop64",ATy(qTy,PTy(PTy(bTy,fTy),F64)),
                    TP[Var("bop",CTy"sse_binop"),
                       EX(Apply
                            (Call
                               ("XMM",ATy(qTy,FTy 128),
                                Var("dst",CTy"xmm_mem")),qVar"state"),
                          LN 63,LN 0,F64),
                       EX(Apply
                            (Call
                               ("XMM",ATy(qTy,FTy 128),
                                Var("src",CTy"xmm_mem")),qVar"state"),
                          LN 63,LN 0,F64)]),qVar"state"),
              Let(TP[Var("v",FTy 128),qVar"s"],
                  Let(qVar"s0",
                      Apply
                        (Call
                           ("process_float_flags",ATy(qTy,qTy),
                            LL[Var("f",PTy(bTy,fTy))]),qVar"state"),
                      TP[Apply
                           (Call
                              ("XMM",ATy(qTy,FTy 128),
                               Var("dst",CTy"xmm_mem")),qVar"s0"),qVar"s0"]),
                  Apply
                    (Call
                       ("write'XMM",ATy(qTy,qTy),
                        TP[BFI(LN 63,LN 0,Var("r",F64),Var("v",FTy 128)),
                           Var("dst",CTy"xmm_mem")]),qVar"s"))))))
;
val dfn'bin_SS_def = Def
  ("dfn'bin_SS",
   TP[Var("bop",CTy"sse_binop"),Var("dst",FTy 3),Var("src",CTy"xmm_mem")],
   Close
     (qVar"state",
      Let(Var("dst",CTy"xmm_mem"),
          Call("xmm_reg",CTy"xmm_mem",Var("dst",FTy 3)),
          Let(TP[Var("f",PTy(bTy,fTy)),Var("r",F32)],
              Apply
                (Call
                   ("sse_binop32",ATy(qTy,PTy(PTy(bTy,fTy),F32)),
                    TP[Var("bop",CTy"sse_binop"),
                       EX(Apply
                            (Call
                               ("XMM",ATy(qTy,FTy 128),
                                Var("dst",CTy"xmm_mem")),qVar"state"),
                          LN 31,LN 0,F32),
                       EX(Apply
                            (Call
                               ("XMM",ATy(qTy,FTy 128),
                                Var("src",CTy"xmm_mem")),qVar"state"),
                          LN 31,LN 0,F32)]),qVar"state"),
              Let(TP[Var("v",FTy 128),qVar"s"],
                  Let(qVar"s0",
                      Apply
                        (Call
                           ("process_float_flags",ATy(qTy,qTy),
                            LL[Var("f",PTy(bTy,fTy))]),qVar"state"),
                      TP[Apply
                           (Call
                              ("XMM",ATy(qTy,FTy 128),
                               Var("dst",CTy"xmm_mem")),qVar"s0"),qVar"s0"]),
                  Apply
                    (Call
                       ("write'XMM",ATy(qTy,qTy),
                        TP[BFI(LN 31,LN 0,Var("r",F32),Var("v",FTy 128)),
                           Var("dst",CTy"xmm_mem")]),qVar"s"))))))
;
val dfn'logic_PD_def = Def
  ("dfn'logic_PD",
   TP[Var("bop",CTy"sse_logic"),Var("dst",FTy 3),Var("src",CTy"xmm_mem")],
   Close
     (qVar"state",
      Let(Var("dst",CTy"xmm_mem"),
          Call("xmm_reg",CTy"xmm_mem",Var("dst",FTy 3)),
          Let(Var("v",FTy 128),
              Apply
                (Call("XMM",ATy(qTy,FTy 128),Var("dst",CTy"xmm_mem")),
                 qVar"state"),
              Let(Var("v0",FTy 128),
                  Apply
                    (Call("XMM",ATy(qTy,FTy 128),Var("src",CTy"xmm_mem")),
                     qVar"state"),
                  Apply
                    (Call
                       ("write'XMM",ATy(qTy,qTy),
                        TP[CC[Call
                                ("sse_logic",F64,
                                 TP[Var("bop",CTy"sse_logic"),
                                    EX(Var("v",FTy 128),LN 127,LN 64,F64),
                                    EX(Var("v0",FTy 128),LN 127,LN 64,F64)]),
                              Call
                                ("sse_logic",F64,
                                 TP[Var("bop",CTy"sse_logic"),
                                    EX(Var("v",FTy 128),LN 63,LN 0,F64),
                                    EX(Var("v0",FTy 128),LN 63,LN 0,F64)])],
                           Var("dst",CTy"xmm_mem")]),qVar"state"))))))
;
val dfn'logic_PS_def = Def
  ("dfn'logic_PS",
   TP[Var("bop",CTy"sse_logic"),Var("dst",FTy 3),Var("src",CTy"xmm_mem")],
   Close
     (qVar"state",
      Let(Var("dst",CTy"xmm_mem"),
          Call("xmm_reg",CTy"xmm_mem",Var("dst",FTy 3)),
          Let(Var("v",FTy 128),
              Apply
                (Call("XMM",ATy(qTy,FTy 128),Var("dst",CTy"xmm_mem")),
                 qVar"state"),
              Let(Var("v0",FTy 128),
                  Apply
                    (Call("XMM",ATy(qTy,FTy 128),Var("src",CTy"xmm_mem")),
                     qVar"state"),
                  Apply
                    (Call
                       ("write'XMM",ATy(qTy,qTy),
                        TP[CC[Call
                                ("sse_logic",F32,
                                 TP[Var("bop",CTy"sse_logic"),
                                    EX(Var("v",FTy 128),LN 127,LN 96,F32),
                                    EX(Var("v0",FTy 128),LN 127,LN 96,F32)]),
                              Call
                                ("sse_logic",F32,
                                 TP[Var("bop",CTy"sse_logic"),
                                    EX(Var("v",FTy 128),LN 95,LN 64,F32),
                                    EX(Var("v0",FTy 128),LN 95,LN 64,F32)]),
                              Call
                                ("sse_logic",F32,
                                 TP[Var("bop",CTy"sse_logic"),
                                    EX(Var("v",FTy 128),LN 63,LN 32,F32),
                                    EX(Var("v0",FTy 128),LN 63,LN 32,F32)]),
                              Call
                                ("sse_logic",F32,
                                 TP[Var("bop",CTy"sse_logic"),
                                    EX(Var("v",FTy 128),LN 31,LN 0,F32),
                                    EX(Var("v0",FTy 128),LN 31,LN 0,F32)])],
                           Var("dst",CTy"xmm_mem")]),qVar"state"))))))
;
val dfn'CMPPD_def = Def
  ("dfn'CMPPD",
   TP[Var("cmp",CTy"sse_compare"),Var("dst",FTy 3),Var("src",CTy"xmm_mem")],
   Close
     (qVar"state",
      Let(Var("dst",CTy"xmm_mem"),
          Call("xmm_reg",CTy"xmm_mem",Var("dst",FTy 3)),
          Let(Var("v",FTy 128),
              Apply
                (Call("XMM",ATy(qTy,FTy 128),Var("dst",CTy"xmm_mem")),
                 qVar"state"),
              Let(Var("v0",FTy 128),
                  Apply
                    (Call("XMM",ATy(qTy,FTy 128),Var("src",CTy"xmm_mem")),
                     qVar"state"),
                  Let(TP[Var("f1",PTy(bTy,fTy)),Var("r1",F64)],
                      Call
                        ("sse_compare64",PTy(PTy(bTy,fTy),F64),
                         TP[Var("cmp",CTy"sse_compare"),
                            EX(Var("v",FTy 128),LN 127,LN 64,F64),
                            EX(Var("v0",FTy 128),LN 127,LN 64,F64)]),
                      Let(TP[Var("f2",PTy(bTy,fTy)),Var("r2",F64)],
                          Call
                            ("sse_compare64",PTy(PTy(bTy,fTy),F64),
                             TP[Var("cmp",CTy"sse_compare"),
                                EX(Var("v",FTy 128),LN 63,LN 0,F64),
                                EX(Var("v0",FTy 128),LN 63,LN 0,F64)]),
                          Apply
                            (Call
                               ("write'XMM",ATy(qTy,qTy),
                                TP[CC[Var("r1",F64),Var("r2",F64)],
                                   Var("dst",CTy"xmm_mem")]),
                             Apply
                               (Call
                                  ("process_float_flags",ATy(qTy,qTy),
                                   LL[Var("f1",PTy(bTy,fTy)),
                                      Var("f2",PTy(bTy,fTy))]),qVar"state")))))))))
;
val dfn'CMPPS_def = Def
  ("dfn'CMPPS",
   TP[Var("cmp",CTy"sse_compare"),Var("dst",FTy 3),Var("src",CTy"xmm_mem")],
   Close
     (qVar"state",
      Let(Var("dst",CTy"xmm_mem"),
          Call("xmm_reg",CTy"xmm_mem",Var("dst",FTy 3)),
          Let(Var("v",FTy 128),
              Apply
                (Call("XMM",ATy(qTy,FTy 128),Var("dst",CTy"xmm_mem")),
                 qVar"state"),
              Let(Var("v0",FTy 128),
                  Apply
                    (Call("XMM",ATy(qTy,FTy 128),Var("src",CTy"xmm_mem")),
                     qVar"state"),
                  Let(TP[Var("f1",PTy(bTy,fTy)),Var("r1",F32)],
                      Call
                        ("sse_compare32",PTy(PTy(bTy,fTy),F32),
                         TP[Var("cmp",CTy"sse_compare"),
                            EX(Var("v",FTy 128),LN 127,LN 96,F32),
                            EX(Var("v0",FTy 128),LN 127,LN 96,F32)]),
                      Let(TP[Var("f2",PTy(bTy,fTy)),Var("r2",F32)],
                          Call
                            ("sse_compare32",PTy(PTy(bTy,fTy),F32),
                             TP[Var("cmp",CTy"sse_compare"),
                                EX(Var("v",FTy 128),LN 95,LN 64,F32),
                                EX(Var("v0",FTy 128),LN 95,LN 64,F32)]),
                          Let(TP[Var("f3",PTy(bTy,fTy)),Var("r3",F32)],
                              Call
                                ("sse_compare32",PTy(PTy(bTy,fTy),F32),
                                 TP[Var("cmp",CTy"sse_compare"),
                                    EX(Var("v",FTy 128),LN 63,LN 32,F32),
                                    EX(Var("v0",FTy 128),LN 63,LN 32,F32)]),
                              Let(TP[Var("f4",PTy(bTy,fTy)),Var("r4",F32)],
                                  Call
                                    ("sse_compare32",
                                     PTy(PTy(bTy,fTy),F32),
                                     TP[Var("cmp",CTy"sse_compare"),
                                        EX(Var("v",FTy 128),LN 31,LN 0,F32),
                                        EX(Var("v0",FTy 128),LN 31,LN 0,
                                           F32)]),
                                  Apply
                                    (Call
                                       ("write'XMM",ATy(qTy,qTy),
                                        TP[CC[Var("r1",F32),Var("r2",F32),
                                              Var("r3",F32),Var("r4",F32)],
                                           Var("dst",CTy"xmm_mem")]),
                                     Apply
                                       (Call
                                          ("process_float_flags",
                                           ATy(qTy,qTy),
                                           LL[Var("f1",PTy(bTy,fTy)),
                                              Var("f2",PTy(bTy,fTy)),
                                              Var("f3",PTy(bTy,fTy)),
                                              Var("f4",PTy(bTy,fTy))]),
                                        qVar"state")))))))))))
;
val dfn'CMPSD_def = Def
  ("dfn'CMPSD",
   TP[Var("cmp",CTy"sse_compare"),Var("dst",FTy 3),Var("src",CTy"xmm_mem")],
   Close
     (qVar"state",
      Let(Var("dst",CTy"xmm_mem"),
          Call("xmm_reg",CTy"xmm_mem",Var("dst",FTy 3)),
          Let(TP[Var("f",PTy(bTy,fTy)),Var("r",F64)],
              Call
                ("sse_compare64",PTy(PTy(bTy,fTy),F64),
                 TP[Var("cmp",CTy"sse_compare"),
                    EX(Apply
                         (Call
                            ("XMM",ATy(qTy,FTy 128),
                             Var("dst",CTy"xmm_mem")),qVar"state"),LN 63,
                       LN 0,F64),
                    EX(Apply
                         (Call
                            ("XMM",ATy(qTy,FTy 128),
                             Var("src",CTy"xmm_mem")),qVar"state"),LN 63,
                       LN 0,F64)]),
              Let(TP[Var("v",FTy 128),qVar"s"],
                  Let(qVar"s0",
                      Apply
                        (Call
                           ("process_float_flags",ATy(qTy,qTy),
                            LL[Var("f",PTy(bTy,fTy))]),qVar"state"),
                      TP[Apply
                           (Call
                              ("XMM",ATy(qTy,FTy 128),
                               Var("dst",CTy"xmm_mem")),qVar"s0"),qVar"s0"]),
                  Apply
                    (Call
                       ("write'XMM",ATy(qTy,qTy),
                        TP[BFI(LN 63,LN 0,Var("r",F64),Var("v",FTy 128)),
                           Var("dst",CTy"xmm_mem")]),qVar"s"))))))
;
val dfn'CMPSS_def = Def
  ("dfn'CMPSS",
   TP[Var("cmp",CTy"sse_compare"),Var("dst",FTy 3),Var("src",CTy"xmm_mem")],
   Close
     (qVar"state",
      Let(Var("dst",CTy"xmm_mem"),
          Call("xmm_reg",CTy"xmm_mem",Var("dst",FTy 3)),
          Let(TP[Var("f",PTy(bTy,fTy)),Var("r",F32)],
              Call
                ("sse_compare32",PTy(PTy(bTy,fTy),F32),
                 TP[Var("cmp",CTy"sse_compare"),
                    EX(Apply
                         (Call
                            ("XMM",ATy(qTy,FTy 128),
                             Var("dst",CTy"xmm_mem")),qVar"state"),LN 31,
                       LN 0,F32),
                    EX(Apply
                         (Call
                            ("XMM",ATy(qTy,FTy 128),
                             Var("src",CTy"xmm_mem")),qVar"state"),LN 31,
                       LN 0,F32)]),
              Let(TP[Var("v",FTy 128),qVar"s"],
                  Let(qVar"s0",
                      Apply
                        (Call
                           ("process_float_flags",ATy(qTy,qTy),
                            LL[Var("f",PTy(bTy,fTy))]),qVar"state"),
                      TP[Apply
                           (Call
                              ("XMM",ATy(qTy,FTy 128),
                               Var("dst",CTy"xmm_mem")),qVar"s0"),qVar"s0"]),
                  Apply
                    (Call
                       ("write'XMM",ATy(qTy,qTy),
                        TP[BFI(LN 31,LN 0,Var("r",F32),Var("v",FTy 128)),
                           Var("dst",CTy"xmm_mem")]),qVar"s"))))))
;
val dfn'COMISD_def = Def
  ("dfn'COMISD",TP[Var("src1",FTy 3),Var("src2",CTy"xmm_mem")],
   Close
     (qVar"state",
      Apply
        (Call("write'SF",ATy(qTy,qTy),LF),
         Apply
           (Call("write'AF",ATy(qTy,qTy),LF),
            Apply
              (Call("write'OF",ATy(qTy,qTy),LF),
               CS(Mop(FPCmp 64,
                      TP[EX(Apply
                              (Call
                                 ("XMM",ATy(qTy,FTy 128),
                                  Call
                                    ("xmm_reg",CTy"xmm_mem",
                                     Var("src1",FTy 3))),qVar"state"),
                            LN 63,LN 0,F64),
                         EX(Apply
                              (Call
                                 ("XMM",ATy(qTy,FTy 128),
                                  Var("src2",CTy"xmm_mem")),qVar"state"),
                            LN 63,LN 0,F64)]),
                  [(binary_ieeeSyntax.UN_tm,
                    Apply
                      (Call("write'CF",ATy(qTy,qTy),LT),
                       Apply
                         (Call("write'PF",ATy(qTy,qTy),LT),
                          Apply
                            (Call("write'ZF",ATy(qTy,qTy),LT),qVar"state")))),
                   (binary_ieeeSyntax.GT_tm,
                    Apply
                      (Call("write'CF",ATy(qTy,qTy),LF),
                       Apply
                         (Call("write'PF",ATy(qTy,qTy),LF),
                          Apply
                            (Call("write'ZF",ATy(qTy,qTy),LF),qVar"state")))),
                   (binary_ieeeSyntax.LT_tm,
                    Apply
                      (Call("write'CF",ATy(qTy,qTy),LT),
                       Apply
                         (Call("write'PF",ATy(qTy,qTy),LF),
                          Apply
                            (Call("write'ZF",ATy(qTy,qTy),LF),qVar"state")))),
                   (binary_ieeeSyntax.EQ_tm,
                    Apply
                      (Call("write'CF",ATy(qTy,qTy),LF),
                       Apply
                         (Call("write'PF",ATy(qTy,qTy),LF),
                          Apply
                            (Call("write'ZF",ATy(qTy,qTy),LT),qVar"state"))))]))))))
;
val dfn'COMISS_def = Def
  ("dfn'COMISS",TP[Var("src1",FTy 3),Var("src2",CTy"xmm_mem")],
   Close
     (qVar"state",
      Apply
        (Call("write'SF",ATy(qTy,qTy),LF),
         Apply
           (Call("write'AF",ATy(qTy,qTy),LF),
            Apply
              (Call("write'OF",ATy(qTy,qTy),LF),
               CS(Mop(FPCmp 32,
                      TP[EX(Apply
                              (Call
                                 ("XMM",ATy(qTy,FTy 128),
                                  Call
                                    ("xmm_reg",CTy"xmm_mem",
                                     Var("src1",FTy 3))),qVar"state"),
                            LN 31,LN 0,F32),
                         EX(Apply
                              (Call
                                 ("XMM",ATy(qTy,FTy 128),
                                  Var("src2",CTy"xmm_mem")),qVar"state"),
                            LN 31,LN 0,F32)]),
                  [(binary_ieeeSyntax.UN_tm,
                    Apply
                      (Call("write'CF",ATy(qTy,qTy),LT),
                       Apply
                         (Call("write'PF",ATy(qTy,qTy),LT),
                          Apply
                            (Call("write'ZF",ATy(qTy,qTy),LT),qVar"state")))),
                   (binary_ieeeSyntax.GT_tm,
                    Apply
                      (Call("write'CF",ATy(qTy,qTy),LF),
                       Apply
                         (Call("write'PF",ATy(qTy,qTy),LF),
                          Apply
                            (Call("write'ZF",ATy(qTy,qTy),LF),qVar"state")))),
                   (binary_ieeeSyntax.LT_tm,
                    Apply
                      (Call("write'CF",ATy(qTy,qTy),LT),
                       Apply
                         (Call("write'PF",ATy(qTy,qTy),LF),
                          Apply
                            (Call("write'ZF",ATy(qTy,qTy),LF),qVar"state")))),
                   (binary_ieeeSyntax.EQ_tm,
                    Apply
                      (Call("write'CF",ATy(qTy,qTy),LF),
                       Apply
                         (Call("write'PF",ATy(qTy,qTy),LF),
                          Apply
                            (Call("write'ZF",ATy(qTy,qTy),LT),qVar"state"))))]))))))
;
val dfn'CVTDQ2PD_def = Def
  ("dfn'CVTDQ2PD",TP[Var("dst",FTy 3),Var("src",CTy"xmm_mem")],
   Close
     (qVar"state",
      Let(Var("v",FTy 128),
          Apply
            (Call("XMM",ATy(qTy,FTy 128),Var("src",CTy"xmm_mem")),
             qVar"state"),
          Let(Var("v0",rTy),
              Apply(Const("RoundingMode",ATy(qTy,rTy)),qVar"state"),
              Apply
                (Call
                   ("write'XMM",ATy(qTy,qTy),
                    TP[CC[Mop(FPFromInt 64,
                              TP[Var("v0",rTy),
                                 Mop(Cast iTy,
                                     EX(Var("v",FTy 128),LN 63,LN 32,F32))]),
                          Mop(FPFromInt 64,
                              TP[Var("v0",rTy),
                                 Mop(Cast iTy,
                                     EX(Var("v",FTy 128),LN 31,LN 0,F32))])],
                       Call("xmm_reg",CTy"xmm_mem",Var("dst",FTy 3))]),
                 qVar"state")))))
;
val dfn'CVTDQ2PS_def = Def
  ("dfn'CVTDQ2PS",TP[Var("dst",FTy 3),Var("src",CTy"xmm_mem")],
   Close
     (qVar"state",
      Let(Var("v",FTy 128),
          Apply
            (Call("XMM",ATy(qTy,FTy 128),Var("src",CTy"xmm_mem")),
             qVar"state"),
          Let(Var("v0",rTy),
              Apply(Const("RoundingMode",ATy(qTy,rTy)),qVar"state"),
              Let(TP[Var("f1",fTy),Var("d1",F32)],
                  Call
                    ("sse_from_int32",PTy(fTy,F32),
                     TP[Var("v0",rTy),
                        EX(Var("v",FTy 128),LN 127,LN 96,F32)]),
                  Let(TP[Var("f2",fTy),Var("d2",F32)],
                      Call
                        ("sse_from_int32",PTy(fTy,F32),
                         TP[Var("v0",rTy),
                            EX(Var("v",FTy 128),LN 95,LN 64,F32)]),
                      Let(TP[Var("f3",fTy),Var("d3",F32)],
                          Call
                            ("sse_from_int32",PTy(fTy,F32),
                             TP[Var("v0",rTy),
                                EX(Var("v",FTy 128),LN 63,LN 32,F32)]),
                          Let(TP[Var("f4",fTy),Var("d4",F32)],
                              Call
                                ("sse_from_int32",PTy(fTy,F32),
                                 TP[Var("v0",rTy),
                                    EX(Var("v",FTy 128),LN 31,LN 0,F32)]),
                              Apply
                                (Call
                                   ("write'XMM",ATy(qTy,qTy),
                                    TP[CC[Var("d1",F32),Var("d2",F32),
                                          Var("d3",F32),Var("d4",F32)],
                                       Call
                                         ("xmm_reg",CTy"xmm_mem",
                                          Var("dst",FTy 3))]),
                                 Apply
                                   (Call
                                      ("process_float_flags",ATy(qTy,qTy),
                                       LL[TP[LF,Var("f1",fTy)],
                                          TP[LF,Var("f2",fTy)],
                                          TP[LF,Var("f3",fTy)],
                                          TP[LF,Var("f4",fTy)]]),
                                    qVar"state"))))))))))
;
val dfn'CVTPD2DQ_def = Def
  ("dfn'CVTPD2DQ",
   TP[bVar"truncate",Var("dst",FTy 3),Var("src",CTy"xmm_mem")],
   Close
     (qVar"state",
      Let(Var("v",FTy 128),
          Apply
            (Call("XMM",ATy(qTy,FTy 128),Var("src",CTy"xmm_mem")),
             qVar"state"),
          Let(Var("v0",rTy),
              ITE(bVar"truncate",binary_ieeeSyntax.roundTowardZero_tm,
                  Apply(Const("RoundingMode",ATy(qTy,rTy)),qVar"state")),
              Let(TP[Var("f1",fTy),Var("w1",F32)],
                  Call
                    ("sse_to_int64",PTy(fTy,F32),
                     TP[Var("v0",rTy),
                        EX(Var("v",FTy 128),LN 127,LN 64,F64)]),
                  Let(TP[Var("f2",fTy),Var("w2",F32)],
                      Call
                        ("sse_to_int64",PTy(fTy,F32),
                         TP[Var("v0",rTy),
                            EX(Var("v",FTy 128),LN 63,LN 0,F64)]),
                      Let(Var("x",CTy"xmm_mem"),
                          Call("xmm_reg",CTy"xmm_mem",Var("dst",FTy 3)),
                          Let(TP[Var("v",FTy 128),qVar"s"],
                              Let(qVar"s0",
                                  Apply
                                    (Call
                                       ("process_float_flags",
                                        ATy(qTy,qTy),
                                        LL[TP[LF,Var("f1",fTy)],
                                           TP[LF,Var("f2",fTy)]]),
                                     qVar"state"),
                                  TP[Apply
                                       (Call
                                          ("XMM",ATy(qTy,FTy 128),
                                           Var("x",CTy"xmm_mem")),qVar"s0"),
                                     qVar"s0"]),
                              Apply
                                (Call
                                   ("write'XMM",ATy(qTy,qTy),
                                    TP[BFI(LN 63,LN 0,
                                           CC[Var("w1",F32),Var("w2",F32)],
                                           Var("v",FTy 128)),
                                       Var("x",CTy"xmm_mem")]),qVar"s")))))))))
;
val dfn'CVTPD2PS_def = Def
  ("dfn'CVTPD2PS",TP[Var("dst",FTy 3),Var("src",CTy"xmm_mem")],
   Close
     (qVar"state",
      Let(Var("v",FTy 128),
          Apply
            (Call("XMM",ATy(qTy,FTy 128),Var("src",CTy"xmm_mem")),
             qVar"state"),
          Let(Var("q1",F64),EX(Var("v",FTy 128),LN 127,LN 64,F64),
              Let(Var("v0",rTy),
                  Apply(Const("RoundingMode",ATy(qTy,rTy)),qVar"state"),
                  Let(TP[Var("f1",fTy),Var("r1",F32)],
                      Mop(FP64To32_,TP[Var("v0",rTy),Var("q1",F64)]),
                      Let(TP[Var("f2",fTy),Var("r2",F32)],
                          Mop(FP64To32_,TP[Var("v0",rTy),Var("q1",F64)]),
                          Let(Var("x0",CTy"xmm_mem"),
                              Call
                                ("xmm_reg",CTy"xmm_mem",Var("dst",FTy 3)),
                              Let(TP[Var("v",FTy 128),qVar"s"],
                                  Let(qVar"s0",
                                      Apply
                                        (Call
                                           ("process_float_flags",
                                            ATy(qTy,qTy),
                                            LL[TP[Mop(FPIsSubnormal 64,
                                                      Var("q1",F64)),
                                                  Var("f1",fTy)],
                                               TP[Mop(FPIsSubnormal 64,
                                                      EX(Var("v",FTy 128),
                                                         LN 63,LN 0,F64)),
                                                  Var("f2",fTy)]]),
                                         qVar"state"),
                                      TP[Apply
                                           (Call
                                              ("XMM",ATy(qTy,FTy 128),
                                               Var("x0",CTy"xmm_mem")),
                                            qVar"s0"),qVar"s0"]),
                                  Apply
                                    (Call
                                       ("write'XMM",ATy(qTy,qTy),
                                        TP[BFI(LN 63,LN 0,
                                               CC[Var("r1",F32),
                                                  Var("r2",F32)],
                                               Var("v",FTy 128)),
                                           Var("x0",CTy"xmm_mem")]),
                                     qVar"s"))))))))))
;
val dfn'CVTPS2DQ_def = Def
  ("dfn'CVTPS2DQ",
   TP[bVar"truncate",Var("dst",FTy 3),Var("src",CTy"xmm_mem")],
   Close
     (qVar"state",
      Let(Var("v",FTy 128),
          Apply
            (Call("XMM",ATy(qTy,FTy 128),Var("src",CTy"xmm_mem")),
             qVar"state"),
          Let(Var("v0",rTy),
              ITE(bVar"truncate",binary_ieeeSyntax.roundTowardZero_tm,
                  Apply(Const("RoundingMode",ATy(qTy,rTy)),qVar"state")),
              Let(TP[Var("f1",fTy),Var("w1",F32)],
                  Call
                    ("sse_to_int32",PTy(fTy,F32),
                     TP[Var("v0",rTy),
                        EX(Var("v",FTy 128),LN 127,LN 96,F32)]),
                  Let(TP[Var("f2",fTy),Var("w2",F32)],
                      Call
                        ("sse_to_int32",PTy(fTy,F32),
                         TP[Var("v0",rTy),
                            EX(Var("v",FTy 128),LN 95,LN 64,F32)]),
                      Let(TP[Var("f3",fTy),Var("w3",F32)],
                          Call
                            ("sse_to_int32",PTy(fTy,F32),
                             TP[Var("v0",rTy),
                                EX(Var("v",FTy 128),LN 63,LN 32,F32)]),
                          Let(TP[Var("f4",fTy),Var("w4",F32)],
                              Call
                                ("sse_to_int32",PTy(fTy,F32),
                                 TP[Var("v0",rTy),
                                    EX(Var("v",FTy 128),LN 31,LN 0,F32)]),
                              Apply
                                (Call
                                   ("write'XMM",ATy(qTy,qTy),
                                    TP[CC[Var("w1",F32),Var("w2",F32),
                                          Var("w3",F32),Var("w4",F32)],
                                       Call
                                         ("xmm_reg",CTy"xmm_mem",
                                          Var("dst",FTy 3))]),
                                 Apply
                                   (Call
                                      ("process_float_flags",ATy(qTy,qTy),
                                       LL[TP[LF,Var("f1",fTy)],
                                          TP[LF,Var("f2",fTy)],
                                          TP[LF,Var("f3",fTy)],
                                          TP[LF,Var("f4",fTy)]]),
                                    qVar"state"))))))))))
;
val dfn'CVTPS2PD_def = Def
  ("dfn'CVTPS2PD",TP[Var("dst",FTy 3),Var("src",CTy"xmm_mem")],
   Close
     (qVar"state",
      Let(Var("v",FTy 128),
          Apply
            (Call("XMM",ATy(qTy,FTy 128),Var("src",CTy"xmm_mem")),
             qVar"state"),
          Let(Var("d1",F32),EX(Var("v",FTy 128),LN 63,LN 32,F32),
              Let(Var("d2",F32),EX(Var("v",FTy 128),LN 31,LN 0,F32),
                  Apply
                    (Call
                       ("write'XMM",ATy(qTy,qTy),
                        TP[CC[Mop(FP32To64,Var("d1",F32)),
                              Mop(FP32To64,Var("d2",F32))],
                           Call("xmm_reg",CTy"xmm_mem",Var("dst",FTy 3))]),
                     Apply
                       (Call
                          ("process_float_flags",ATy(qTy,qTy),
                           LL[TP[Mop(FPIsSubnormal 32,Var("d1",F32)),
                                 Call
                                   ("initial_ieee_flags",fTy,
                                    Mop(FPIsSignallingNan 32,Var("d1",F32)))],
                              TP[Mop(FPIsSubnormal 32,Var("d2",F32)),
                                 Call
                                   ("initial_ieee_flags",fTy,
                                    Mop(FPIsSignallingNan 32,Var("d2",F32)))]]),
                        qVar"state")))))))
;
val dfn'CVTSD2SI_def = Def
  ("dfn'CVTSD2SI",
   TP[bVar"truncate",bVar"quad",Var("dst",CTy"Zreg"),
      Var("src",CTy"xmm_mem")],
   Close
     (qVar"state",
      Let(Var("q",F64),
          EX(Apply
               (Call("XMM",ATy(qTy,FTy 128),Var("src",CTy"xmm_mem")),
                qVar"state"),LN 63,LN 0,F64),
          Let(Var("v",rTy),
              ITE(bVar"truncate",binary_ieeeSyntax.roundTowardZero_tm,
                  Apply(Const("RoundingMode",ATy(qTy,rTy)),qVar"state")),
              ITE(bVar"quad",
                  Let(TP[Var("f",fTy),Var("w",F64)],
                      Call
                        ("sse_to_int64",PTy(fTy,F64),
                         TP[Var("v",rTy),Var("q",F64)]),
                      Apply
                        (Call
                           ("write'EA",ATy(qTy,qTy),
                            TP[Var("w",F64),
                               Call
                                 ("Zea_r",CTy"Zea",
                                  TP[Const("Z64",CTy"Zsize"),
                                     Var("dst",CTy"Zreg")])]),
                         Apply
                           (Call
                              ("process_float_flags",ATy(qTy,qTy),
                               LL[TP[LF,Var("f",fTy)]]),qVar"state"))),
                  Let(TP[Var("f",fTy),Var("w",F32)],
                      Call
                        ("sse_to_int64",PTy(fTy,F32),
                         TP[Var("v",rTy),Var("q",F64)]),
                      Apply
                        (Call
                           ("write'EA",ATy(qTy,qTy),
                            TP[Mop(Cast F64,Var("w",F32)),
                               Call
                                 ("Zea_r",CTy"Zea",
                                  TP[Const("Z32",CTy"Zsize"),
                                     Var("dst",CTy"Zreg")])]),
                         Apply
                           (Call
                              ("process_float_flags",ATy(qTy,qTy),
                               LL[TP[LF,Var("f",fTy)]]),qVar"state"))))))))
;
val dfn'CVTSD2SS_def = Def
  ("dfn'CVTSD2SS",TP[Var("dst",FTy 3),Var("src",CTy"xmm_mem")],
   Close
     (qVar"state",
      Let(Var("q",F64),
          EX(Apply
               (Call("XMM",ATy(qTy,FTy 128),Var("src",CTy"xmm_mem")),
                qVar"state"),LN 63,LN 0,F64),
          Let(TP[Var("f",fTy),Var("r",F32)],
              Mop(FP64To32_,
                  TP[Apply(Const("RoundingMode",ATy(qTy,rTy)),qVar"state"),
                     Var("q",F64)]),
              Let(Var("x",CTy"xmm_mem"),
                  Call("xmm_reg",CTy"xmm_mem",Var("dst",FTy 3)),
                  Let(TP[Var("v",FTy 128),qVar"s"],
                      Let(qVar"s0",
                          Apply
                            (Call
                               ("process_float_flags",ATy(qTy,qTy),
                                LL[TP[Mop(FPIsSubnormal 64,Var("q",F64)),
                                      Var("f",fTy)]]),qVar"state"),
                          TP[Apply
                               (Call
                                  ("XMM",ATy(qTy,FTy 128),
                                   Var("x",CTy"xmm_mem")),qVar"s0"),
                             qVar"s0"]),
                      Apply
                        (Call
                           ("write'XMM",ATy(qTy,qTy),
                            TP[BFI(LN 31,LN 0,Var("r",F32),
                                   Var("v",FTy 128)),Var("x",CTy"xmm_mem")]),
                         qVar"s")))))))
;
val dfn'CVTSI2SD_def = Def
  ("dfn'CVTSI2SD",TP[bVar"quad",Var("dst",FTy 3),Var("src",CTy"Zrm")],
   Close
     (qVar"state",
      Let(TP[Var("f",fTy),Var("q",F64)],
          Call
            ("sse_from_int64",PTy(fTy,F64),
             TP[Apply(Const("RoundingMode",ATy(qTy,rTy)),qVar"state"),
                Apply
                  (Call
                     ("EA",ATy(qTy,F64),
                      Apply
                        (Call
                           ("ea_Zrm",ATy(qTy,CTy"Zea"),
                            TP[ITE(bVar"quad",Const("Z64",CTy"Zsize"),
                                   Const("Z32",CTy"Zsize")),
                               Var("src",CTy"Zrm")]),qVar"state")),
                   qVar"state")]),
          Let(Var("x",CTy"xmm_mem"),
              Call("xmm_reg",CTy"xmm_mem",Var("dst",FTy 3)),
              Let(TP[Var("v",FTy 128),qVar"s"],
                  Let(qVar"s0",
                      Apply
                        (Call
                           ("process_float_flags",ATy(qTy,qTy),
                            LL[TP[LF,Var("f",fTy)]]),qVar"state"),
                      TP[Apply
                           (Call
                              ("XMM",ATy(qTy,FTy 128),
                               Var("x",CTy"xmm_mem")),qVar"s0"),qVar"s0"]),
                  Apply
                    (Call
                       ("write'XMM",ATy(qTy,qTy),
                        TP[BFI(LN 63,LN 0,Var("q",F64),Var("v",FTy 128)),
                           Var("x",CTy"xmm_mem")]),qVar"s"))))))
;
val dfn'CVTSI2SS_def = Def
  ("dfn'CVTSI2SS",TP[bVar"quad",Var("dst",FTy 3),Var("src",CTy"Zrm")],
   Close
     (qVar"state",
      Let(TP[Var("f",fTy),Var("d",F32)],
          Call
            ("sse_from_int32",PTy(fTy,F32),
             TP[Apply(Const("RoundingMode",ATy(qTy,rTy)),qVar"state"),
                Apply
                  (Call
                     ("EA",ATy(qTy,F64),
                      Apply
                        (Call
                           ("ea_Zrm",ATy(qTy,CTy"Zea"),
                            TP[ITE(bVar"quad",Const("Z64",CTy"Zsize"),
                                   Const("Z32",CTy"Zsize")),
                               Var("src",CTy"Zrm")]),qVar"state")),
                   qVar"state")]),
          Let(Var("x",CTy"xmm_mem"),
              Call("xmm_reg",CTy"xmm_mem",Var("dst",FTy 3)),
              Let(TP[Var("v",FTy 128),qVar"s"],
                  Let(qVar"s0",
                      Apply
                        (Call
                           ("process_float_flags",ATy(qTy,qTy),
                            LL[TP[LF,Var("f",fTy)]]),qVar"state"),
                      TP[Apply
                           (Call
                              ("XMM",ATy(qTy,FTy 128),
                               Var("x",CTy"xmm_mem")),qVar"s0"),qVar"s0"]),
                  Apply
                    (Call
                       ("write'XMM",ATy(qTy,qTy),
                        TP[BFI(LN 31,LN 0,Var("d",F32),Var("v",FTy 128)),
                           Var("x",CTy"xmm_mem")]),qVar"s"))))))
;
val dfn'CVTSS2SD_def = Def
  ("dfn'CVTSS2SD",TP[Var("dst",FTy 3),Var("src",CTy"xmm_mem")],
   Close
     (qVar"state",
      Let(Var("d",F32),
          EX(Apply
               (Call("XMM",ATy(qTy,FTy 128),Var("src",CTy"xmm_mem")),
                qVar"state"),LN 31,LN 0,F32),
          Let(Var("x",CTy"xmm_mem"),
              Call("xmm_reg",CTy"xmm_mem",Var("dst",FTy 3)),
              Let(TP[Var("v",FTy 128),qVar"s"],
                  Let(qVar"s0",
                      Apply
                        (Call
                           ("process_float_flags",ATy(qTy,qTy),
                            LL[TP[Mop(FPIsSubnormal 32,Var("d",F32)),
                                  Call
                                    ("initial_ieee_flags",fTy,
                                     Mop(FPIsSignallingNan 32,Var("d",F32)))]]),
                         qVar"state"),
                      TP[Apply
                           (Call
                              ("XMM",ATy(qTy,FTy 128),
                               Var("x",CTy"xmm_mem")),qVar"s0"),qVar"s0"]),
                  Apply
                    (Call
                       ("write'XMM",ATy(qTy,qTy),
                        TP[BFI(LN 63,LN 0,Mop(FP32To64,Var("d",F32)),
                               Var("v",FTy 128)),Var("x",CTy"xmm_mem")]),
                     qVar"s"))))))
;
val dfn'CVTSS2SI_def = Def
  ("dfn'CVTSS2SI",
   TP[bVar"truncate",bVar"quad",Var("dst",CTy"Zreg"),
      Var("src",CTy"xmm_mem")],
   Close
     (qVar"state",
      Let(Var("d",F32),
          EX(Apply
               (Call("XMM",ATy(qTy,FTy 128),Var("src",CTy"xmm_mem")),
                qVar"state"),LN 31,LN 0,F32),
          Let(Var("v",rTy),
              ITE(bVar"truncate",binary_ieeeSyntax.roundTowardZero_tm,
                  Apply(Const("RoundingMode",ATy(qTy,rTy)),qVar"state")),
              ITE(bVar"quad",
                  Let(TP[Var("f",fTy),Var("w",F64)],
                      Call
                        ("sse_to_int32",PTy(fTy,F64),
                         TP[Var("v",rTy),Var("d",F32)]),
                      Apply
                        (Call
                           ("write'EA",ATy(qTy,qTy),
                            TP[Var("w",F64),
                               Call
                                 ("Zea_r",CTy"Zea",
                                  TP[Const("Z64",CTy"Zsize"),
                                     Var("dst",CTy"Zreg")])]),
                         Apply
                           (Call
                              ("process_float_flags",ATy(qTy,qTy),
                               LL[TP[LF,Var("f",fTy)]]),qVar"state"))),
                  Let(TP[Var("f",fTy),Var("w",F32)],
                      Call
                        ("sse_to_int32",PTy(fTy,F32),
                         TP[Var("v",rTy),Var("d",F32)]),
                      Apply
                        (Call
                           ("write'EA",ATy(qTy,qTy),
                            TP[Mop(Cast F64,Var("w",F32)),
                               Call
                                 ("Zea_r",CTy"Zea",
                                  TP[Const("Z32",CTy"Zsize"),
                                     Var("dst",CTy"Zreg")])]),
                         Apply
                           (Call
                              ("process_float_flags",ATy(qTy,qTy),
                               LL[TP[LF,Var("f",fTy)]]),qVar"state"))))))))
;
val dfn'MOVAP_D_S_def = Def
  ("dfn'MOVAP_D_S",
   TP[bVar"double",Var("dst",CTy"xmm_mem"),Var("src",CTy"xmm_mem")],
   Close
     (qVar"state",
      Let(TP[Var("v",FTy 128),qVar"s"],
          Let(qVar"s",
              Apply
                (Call
                   ("CheckAlignedXMM",ATy(qTy,qTy),
                    TP[Var("src",CTy"xmm_mem"),LN 4]),
                 Apply
                   (Call
                      ("CheckAlignedXMM",ATy(qTy,qTy),
                       TP[Var("dst",CTy"xmm_mem"),LN 4]),qVar"state")),
              TP[Apply
                   (Call("XMM",ATy(qTy,FTy 128),Var("src",CTy"xmm_mem")),
                    qVar"s"),qVar"s"]),
          Apply
            (Call
               ("write'XMM",ATy(qTy,qTy),
                TP[Var("v",FTy 128),Var("dst",CTy"xmm_mem")]),qVar"s"))))
;
val dfn'MOVUP_D_S_def = Def
  ("dfn'MOVUP_D_S",
   TP[bVar"double",Var("dst",CTy"xmm_mem"),Var("src",CTy"xmm_mem")],
   Close
     (qVar"state",
      Apply
        (Call
           ("write'XMM",ATy(qTy,qTy),
            TP[Apply
                 (Call("XMM",ATy(qTy,FTy 128),Var("src",CTy"xmm_mem")),
                  qVar"state"),Var("dst",CTy"xmm_mem")]),qVar"state")))
;
val dfn'MOV_D_Q_def = Def
  ("dfn'MOV_D_Q",
   TP[bVar"to_xmm",bVar"quad",Var("xmm",FTy 3),Var("rm",CTy"Zrm")],
   Close
     (qVar"state",
      CS(TP[bVar"to_xmm",bVar"quad"],
         [(TP[LF,LF],
           Apply
             (Call
                ("write'EA",ATy(qTy,qTy),
                 TP[Mop(Cast F64,
                        EX(Apply
                             (Call
                                ("XMM",ATy(qTy,FTy 128),
                                 Call
                                   ("xmm_reg",CTy"xmm_mem",
                                    Var("xmm",FTy 3))),qVar"state"),LN 31,
                           LN 0,F32)),
                    Apply
                      (Call
                         ("ea_Zrm",ATy(qTy,CTy"Zea"),
                          TP[Const("Z32",CTy"Zsize"),Var("rm",CTy"Zrm")]),
                       qVar"state")]),qVar"state")),
          (TP[LF,LT],
           Apply
             (Call
                ("write'EA",ATy(qTy,qTy),
                 TP[EX(Apply
                         (Call
                            ("XMM",ATy(qTy,FTy 128),
                             Call("xmm_reg",CTy"xmm_mem",Var("xmm",FTy 3))),
                          qVar"state"),LN 63,LN 0,F64),
                    Apply
                      (Call
                         ("ea_Zrm",ATy(qTy,CTy"Zea"),
                          TP[Const("Z64",CTy"Zsize"),Var("rm",CTy"Zrm")]),
                       qVar"state")]),qVar"state")),
          (TP[LT,LF],
           Apply
             (Call
                ("write'XMM",ATy(qTy,qTy),
                 TP[Mop(Cast(FTy 128),
                        EX(Apply
                             (Call
                                ("EA",ATy(qTy,F64),
                                 Apply
                                   (Call
                                      ("ea_Zrm",ATy(qTy,CTy"Zea"),
                                       TP[Const("Z32",CTy"Zsize"),
                                          Var("rm",CTy"Zrm")]),qVar"state")),
                              qVar"state"),LN 31,LN 0,F32)),
                    Call("xmm_reg",CTy"xmm_mem",Var("xmm",FTy 3))]),
              qVar"state")),
          (TP[LT,LT],
           Apply
             (Call
                ("write'XMM",ATy(qTy,qTy),
                 TP[Mop(Cast(FTy 128),
                        Apply
                          (Call
                             ("EA",ATy(qTy,F64),
                              Apply
                                (Call
                                   ("ea_Zrm",ATy(qTy,CTy"Zea"),
                                    TP[Const("Z64",CTy"Zsize"),
                                       Var("rm",CTy"Zrm")]),qVar"state")),
                           qVar"state")),
                    Call("xmm_reg",CTy"xmm_mem",Var("xmm",FTy 3))]),
              qVar"state"))])))
;
val dfn'MOVQ_def = Def
  ("dfn'MOVQ",TP[Var("dst",CTy"xmm_mem"),Var("src",CTy"xmm_mem")],
   Close
     (qVar"state",
      CS(Var("dst",CTy"xmm_mem"),
         [(Call("xmm_reg",CTy"xmm_mem",AVar(FTy 3)),
           Apply
             (Call
                ("write'XMM",ATy(qTy,qTy),
                 TP[Mop(Cast(FTy 128),
                        EX(Apply
                             (Call
                                ("XMM",ATy(qTy,FTy 128),
                                 Var("src",CTy"xmm_mem")),qVar"state"),
                           LN 63,LN 0,F64)),Var("dst",CTy"xmm_mem")]),
              qVar"state")),
          (Call
             ("xmm_mem",CTy"xmm_mem",
              Var("m",PTy(OTy(PTy(FTy 2,CTy"Zreg")),PTy(CTy"Zbase",F64)))),
           Apply
             (Call
                ("write'EA",ATy(qTy,qTy),
                 TP[EX(Apply
                         (Call
                            ("XMM",ATy(qTy,FTy 128),
                             Var("src",CTy"xmm_mem")),qVar"state"),LN 63,
                       LN 0,F64),
                    Apply
                      (Call
                         ("ea_Zrm",ATy(qTy,CTy"Zea"),
                          TP[Const("Z64",CTy"Zsize"),
                             Call
                               ("Zm",CTy"Zrm",
                                Var("m",
                                    PTy(OTy(PTy(FTy 2,CTy"Zreg")),
                                        PTy(CTy"Zbase",F64))))]),
                       qVar"state")]),qVar"state"))])))
;
val dfn'MOVSD_def = Def
  ("dfn'MOVSD",TP[Var("dst",CTy"xmm_mem"),Var("src",CTy"xmm_mem")],
   Close
     (qVar"state",
      CS(Var("src",CTy"xmm_mem"),
         [(Call("xmm_reg",CTy"xmm_mem",AVar(FTy 3)),
           Apply
             (Call
                ("write'XMM",ATy(qTy,qTy),
                 TP[BFI(LN 63,LN 0,
                        EX(Apply
                             (Call
                                ("XMM",ATy(qTy,FTy 128),
                                 Var("src",CTy"xmm_mem")),qVar"state"),
                           LN 63,LN 0,F64),
                        Apply
                          (Call
                             ("XMM",ATy(qTy,FTy 128),
                              Var("dst",CTy"xmm_mem")),qVar"state")),
                    Var("dst",CTy"xmm_mem")]),qVar"state")),
          (Call
             ("xmm_mem",CTy"xmm_mem",
              AVar(PTy(OTy(PTy(FTy 2,CTy"Zreg")),PTy(CTy"Zbase",F64)))),
           Apply
             (Call
                ("write'XMM",ATy(qTy,qTy),
                 TP[Mop(Cast(FTy 128),
                        EX(Apply
                             (Call
                                ("XMM",ATy(qTy,FTy 128),
                                 Var("src",CTy"xmm_mem")),qVar"state"),
                           LN 63,LN 0,F64)),Var("dst",CTy"xmm_mem")]),
              qVar"state"))])))
;
val dfn'MOVSS_def = Def
  ("dfn'MOVSS",TP[Var("dst",CTy"xmm_mem"),Var("src",CTy"xmm_mem")],
   Close
     (qVar"state",
      CS(Var("src",CTy"xmm_mem"),
         [(Call("xmm_reg",CTy"xmm_mem",AVar(FTy 3)),
           Apply
             (Call
                ("write'XMM",ATy(qTy,qTy),
                 TP[BFI(LN 31,LN 0,
                        EX(Apply
                             (Call
                                ("XMM",ATy(qTy,FTy 128),
                                 Var("src",CTy"xmm_mem")),qVar"state"),
                           LN 31,LN 0,F32),
                        Apply
                          (Call
                             ("XMM",ATy(qTy,FTy 128),
                              Var("dst",CTy"xmm_mem")),qVar"state")),
                    Var("dst",CTy"xmm_mem")]),qVar"state")),
          (Call
             ("xmm_mem",CTy"xmm_mem",
              AVar(PTy(OTy(PTy(FTy 2,CTy"Zreg")),PTy(CTy"Zbase",F64)))),
           Apply
             (Call
                ("write'XMM",ATy(qTy,qTy),
                 TP[Mop(Cast(FTy 128),
                        EX(Apply
                             (Call
                                ("XMM",ATy(qTy,FTy 128),
                                 Var("src",CTy"xmm_mem")),qVar"state"),
                           LN 31,LN 0,F32)),Var("dst",CTy"xmm_mem")]),
              qVar"state"))])))
;
val dfn'PCMPEQQ_def = Def
  ("dfn'PCMPEQQ",TP[Var("dst",FTy 3),Var("src",CTy"xmm_mem")],
   Close
     (qVar"state",
      Let(Var("dst",CTy"xmm_mem"),
          Call("xmm_reg",CTy"xmm_mem",Var("dst",FTy 3)),
          Let(Var("v",FTy 128),
              Apply
                (Call("XMM",ATy(qTy,FTy 128),Var("dst",CTy"xmm_mem")),
                 qVar"state"),
              Let(Var("v0",FTy 128),
                  Apply
                    (Call("XMM",ATy(qTy,FTy 128),Var("src",CTy"xmm_mem")),
                     qVar"state"),
                  Apply
                    (Call
                       ("write'XMM",ATy(qTy,qTy),
                        TP[CC[ITE(EQ(EX(Var("v",FTy 128),LN 127,LN 64,F64),
                                     EX(Var("v0",FTy 128),LN 127,LN 64,F64)),
                                  Mop(Neg,LW(1,64)),LW(0,64)),
                              ITE(EQ(EX(Var("v",FTy 128),LN 63,LN 0,F64),
                                     EX(Var("v0",FTy 128),LN 63,LN 0,F64)),
                                  Mop(Neg,LW(1,64)),LW(0,64))],
                           Var("dst",CTy"xmm_mem")]),qVar"state"))))))
;
val dfn'PSLLDQ_def = Def
  ("dfn'PSLLDQ",TP[Var("dst",FTy 3),Var("imm",F8)],
   Close
     (qVar"state",
      Let(Var("dst",CTy"xmm_mem"),
          Call("xmm_reg",CTy"xmm_mem",Var("dst",FTy 3)),
          Apply
            (Call
               ("write'XMM",ATy(qTy,qTy),
                TP[Bop(Lsl,
                       Apply
                         (Call
                            ("XMM",ATy(qTy,FTy 128),
                             Var("dst",CTy"xmm_mem")),qVar"state"),
                       Bop(Mul,
                           Mop(Min,TP[LN 16,Mop(Cast nTy,Var("imm",F8))]),
                           LN 8)),Var("dst",CTy"xmm_mem")]),qVar"state"))))
;
val dfn'PSLLD_imm_def = Def
  ("dfn'PSLLD_imm",TP[Var("dst",FTy 3),Var("imm",F8)],
   Close
     (qVar"state",
      Let(Var("dst",CTy"xmm_mem"),
          Call("xmm_reg",CTy"xmm_mem",Var("dst",FTy 3)),
          Let(Var("v",FTy 128),
              Apply
                (Call("XMM",ATy(qTy,FTy 128),Var("dst",CTy"xmm_mem")),
                 qVar"state"),
              Let(nVar"i",Mop(Cast nTy,Var("imm",F8)),
                  Apply
                    (Call
                       ("write'XMM",ATy(qTy,qTy),
                        TP[CC[Bop(Lsl,
                                  EX(Var("v",FTy 128),LN 127,LN 96,F32),
                                  nVar"i"),
                              Bop(Lsl,
                                  EX(Var("v",FTy 128),LN 95,LN 64,F32),
                                  nVar"i"),
                              Bop(Lsl,
                                  EX(Var("v",FTy 128),LN 63,LN 32,F32),
                                  nVar"i"),
                              Bop(Lsl,EX(Var("v",FTy 128),LN 31,LN 0,F32),
                                  nVar"i")],Var("dst",CTy"xmm_mem")]),
                     qVar"state"))))))
;
val dfn'PSLLQ_imm_def = Def
  ("dfn'PSLLQ_imm",TP[Var("dst",FTy 3),Var("imm",F8)],
   Close
     (qVar"state",
      Let(Var("dst",CTy"xmm_mem"),
          Call("xmm_reg",CTy"xmm_mem",Var("dst",FTy 3)),
          Let(Var("v",FTy 128),
              Apply
                (Call("XMM",ATy(qTy,FTy 128),Var("dst",CTy"xmm_mem")),
                 qVar"state"),
              Let(nVar"i",Mop(Cast nTy,Var("imm",F8)),
                  Apply
                    (Call
                       ("write'XMM",ATy(qTy,qTy),
                        TP[CC[Bop(Lsl,
                                  EX(Var("v",FTy 128),LN 127,LN 64,F64),
                                  nVar"i"),
                              Bop(Lsl,EX(Var("v",FTy 128),LN 63,LN 0,F64),
                                  nVar"i")],Var("dst",CTy"xmm_mem")]),
                     qVar"state"))))))
;
val dfn'PSLLW_imm_def = Def
  ("dfn'PSLLW_imm",TP[Var("dst",FTy 3),Var("imm",F8)],
   Close
     (qVar"state",
      Let(Var("dst",CTy"xmm_mem"),
          Call("xmm_reg",CTy"xmm_mem",Var("dst",FTy 3)),
          Let(Var("v",FTy 128),
              Apply
                (Call("XMM",ATy(qTy,FTy 128),Var("dst",CTy"xmm_mem")),
                 qVar"state"),
              Let(nVar"i",Mop(Cast nTy,Var("imm",F8)),
                  Apply
                    (Call
                       ("write'XMM",ATy(qTy,qTy),
                        TP[CC[Bop(Lsl,
                                  EX(Var("v",FTy 128),LN 127,LN 112,F16),
                                  nVar"i"),
                              Bop(Lsl,
                                  EX(Var("v",FTy 128),LN 111,LN 96,F16),
                                  nVar"i"),
                              Bop(Lsl,
                                  EX(Var("v",FTy 128),LN 95,LN 80,F16),
                                  nVar"i"),
                              Bop(Lsl,
                                  EX(Var("v",FTy 128),LN 79,LN 64,F16),
                                  nVar"i"),
                              Bop(Lsl,
                                  EX(Var("v",FTy 128),LN 63,LN 48,F16),
                                  nVar"i"),
                              Bop(Lsl,
                                  EX(Var("v",FTy 128),LN 47,LN 32,F16),
                                  nVar"i"),
                              Bop(Lsl,
                                  EX(Var("v",FTy 128),LN 31,LN 16,F16),
                                  nVar"i"),
                              Bop(Lsl,EX(Var("v",FTy 128),LN 15,LN 0,F16),
                                  nVar"i")],Var("dst",CTy"xmm_mem")]),
                     qVar"state"))))))
;
val dfn'PSRAD_imm_def = Def
  ("dfn'PSRAD_imm",TP[Var("dst",FTy 3),Var("imm",F8)],
   Close
     (qVar"state",
      Let(Var("dst",CTy"xmm_mem"),
          Call("xmm_reg",CTy"xmm_mem",Var("dst",FTy 3)),
          Let(Var("v",FTy 128),
              Apply
                (Call("XMM",ATy(qTy,FTy 128),Var("dst",CTy"xmm_mem")),
                 qVar"state"),
              Let(nVar"i",Mop(Cast nTy,Var("imm",F8)),
                  Apply
                    (Call
                       ("write'XMM",ATy(qTy,qTy),
                        TP[CC[Bop(Asr,
                                  EX(Var("v",FTy 128),LN 127,LN 96,F32),
                                  nVar"i"),
                              Bop(Asr,
                                  EX(Var("v",FTy 128),LN 95,LN 64,F32),
                                  nVar"i"),
                              Bop(Asr,
                                  EX(Var("v",FTy 128),LN 63,LN 32,F32),
                                  nVar"i"),
                              Bop(Asr,EX(Var("v",FTy 128),LN 31,LN 0,F32),
                                  nVar"i")],Var("dst",CTy"xmm_mem")]),
                     qVar"state"))))))
;
val dfn'PSRAW_imm_def = Def
  ("dfn'PSRAW_imm",TP[Var("dst",FTy 3),Var("imm",F8)],
   Close
     (qVar"state",
      Let(Var("dst",CTy"xmm_mem"),
          Call("xmm_reg",CTy"xmm_mem",Var("dst",FTy 3)),
          Let(Var("v",FTy 128),
              Apply
                (Call("XMM",ATy(qTy,FTy 128),Var("dst",CTy"xmm_mem")),
                 qVar"state"),
              Let(nVar"i",Mop(Cast nTy,Var("imm",F8)),
                  Apply
                    (Call
                       ("write'XMM",ATy(qTy,qTy),
                        TP[CC[Bop(Asr,
                                  EX(Var("v",FTy 128),LN 127,LN 112,F16),
                                  nVar"i"),
                              Bop(Asr,
                                  EX(Var("v",FTy 128),LN 111,LN 96,F16),
                                  nVar"i"),
                              Bop(Asr,
                                  EX(Var("v",FTy 128),LN 95,LN 80,F16),
                                  nVar"i"),
                              Bop(Asr,
                                  EX(Var("v",FTy 128),LN 79,LN 64,F16),
                                  nVar"i"),
                              Bop(Asr,
                                  EX(Var("v",FTy 128),LN 63,LN 48,F16),
                                  nVar"i"),
                              Bop(Asr,
                                  EX(Var("v",FTy 128),LN 47,LN 32,F16),
                                  nVar"i"),
                              Bop(Asr,
                                  EX(Var("v",FTy 128),LN 31,LN 16,F16),
                                  nVar"i"),
                              Bop(Asr,EX(Var("v",FTy 128),LN 15,LN 0,F16),
                                  nVar"i")],Var("dst",CTy"xmm_mem")]),
                     qVar"state"))))))
;
val dfn'PSRLDQ_def = Def
  ("dfn'PSRLDQ",TP[Var("dst",FTy 3),Var("imm",F8)],
   Close
     (qVar"state",
      Let(Var("dst",CTy"xmm_mem"),
          Call("xmm_reg",CTy"xmm_mem",Var("dst",FTy 3)),
          Apply
            (Call
               ("write'XMM",ATy(qTy,qTy),
                TP[Bop(Lsr,
                       Apply
                         (Call
                            ("XMM",ATy(qTy,FTy 128),
                             Var("dst",CTy"xmm_mem")),qVar"state"),
                       Bop(Mul,
                           Mop(Min,TP[LN 16,Mop(Cast nTy,Var("imm",F8))]),
                           LN 8)),Var("dst",CTy"xmm_mem")]),qVar"state"))))
;
val dfn'PSRLD_imm_def = Def
  ("dfn'PSRLD_imm",TP[Var("dst",FTy 3),Var("imm",F8)],
   Close
     (qVar"state",
      Let(Var("dst",CTy"xmm_mem"),
          Call("xmm_reg",CTy"xmm_mem",Var("dst",FTy 3)),
          Let(Var("v",FTy 128),
              Apply
                (Call("XMM",ATy(qTy,FTy 128),Var("dst",CTy"xmm_mem")),
                 qVar"state"),
              Let(nVar"i",Mop(Cast nTy,Var("imm",F8)),
                  Apply
                    (Call
                       ("write'XMM",ATy(qTy,qTy),
                        TP[CC[Bop(Lsr,
                                  EX(Var("v",FTy 128),LN 127,LN 96,F32),
                                  nVar"i"),
                              Bop(Lsr,
                                  EX(Var("v",FTy 128),LN 95,LN 64,F32),
                                  nVar"i"),
                              Bop(Lsr,
                                  EX(Var("v",FTy 128),LN 63,LN 32,F32),
                                  nVar"i"),
                              Bop(Lsr,EX(Var("v",FTy 128),LN 31,LN 0,F32),
                                  nVar"i")],Var("dst",CTy"xmm_mem")]),
                     qVar"state"))))))
;
val dfn'PSRLQ_imm_def = Def
  ("dfn'PSRLQ_imm",TP[Var("dst",FTy 3),Var("imm",F8)],
   Close
     (qVar"state",
      Let(Var("dst",CTy"xmm_mem"),
          Call("xmm_reg",CTy"xmm_mem",Var("dst",FTy 3)),
          Let(Var("v",FTy 128),
              Apply
                (Call("XMM",ATy(qTy,FTy 128),Var("dst",CTy"xmm_mem")),
                 qVar"state"),
              Let(nVar"i",Mop(Cast nTy,Var("imm",F8)),
                  Apply
                    (Call
                       ("write'XMM",ATy(qTy,qTy),
                        TP[CC[Bop(Lsr,
                                  EX(Var("v",FTy 128),LN 127,LN 64,F64),
                                  nVar"i"),
                              Bop(Lsr,EX(Var("v",FTy 128),LN 63,LN 0,F64),
                                  nVar"i")],Var("dst",CTy"xmm_mem")]),
                     qVar"state"))))))
;
val dfn'PSRLW_imm_def = Def
  ("dfn'PSRLW_imm",TP[Var("dst",FTy 3),Var("imm",F8)],
   Close
     (qVar"state",
      Let(Var("dst",CTy"xmm_mem"),
          Call("xmm_reg",CTy"xmm_mem",Var("dst",FTy 3)),
          Let(Var("v",FTy 128),
              Apply
                (Call("XMM",ATy(qTy,FTy 128),Var("dst",CTy"xmm_mem")),
                 qVar"state"),
              Let(nVar"i",Mop(Cast nTy,Var("imm",F8)),
                  Apply
                    (Call
                       ("write'XMM",ATy(qTy,qTy),
                        TP[CC[Bop(Lsr,
                                  EX(Var("v",FTy 128),LN 127,LN 112,F16),
                                  nVar"i"),
                              Bop(Lsr,
                                  EX(Var("v",FTy 128),LN 111,LN 96,F16),
                                  nVar"i"),
                              Bop(Lsr,
                                  EX(Var("v",FTy 128),LN 95,LN 80,F16),
                                  nVar"i"),
                              Bop(Lsr,
                                  EX(Var("v",FTy 128),LN 79,LN 64,F16),
                                  nVar"i"),
                              Bop(Lsr,
                                  EX(Var("v",FTy 128),LN 63,LN 48,F16),
                                  nVar"i"),
                              Bop(Lsr,
                                  EX(Var("v",FTy 128),LN 47,LN 32,F16),
                                  nVar"i"),
                              Bop(Lsr,
                                  EX(Var("v",FTy 128),LN 31,LN 16,F16),
                                  nVar"i"),
                              Bop(Lsr,EX(Var("v",FTy 128),LN 15,LN 0,F16),
                                  nVar"i")],Var("dst",CTy"xmm_mem")]),
                     qVar"state"))))))
;
val dfn'SQRTPD_def = Def
  ("dfn'SQRTPD",TP[Var("dst",FTy 3),Var("src",CTy"xmm_mem")],
   Close
     (qVar"state",
      Let(Var("v",FTy 128),
          Apply
            (Call("XMM",ATy(qTy,FTy 128),Var("src",CTy"xmm_mem")),
             qVar"state"),
          Let(TP[Var("f1",PTy(bTy,fTy)),Var("r1",F64)],
              Apply
                (Call
                   ("sse_sqrt64",ATy(qTy,PTy(PTy(bTy,fTy),F64)),
                    EX(Var("v",FTy 128),LN 127,LN 64,F64)),qVar"state"),
              Let(TP[Var("f2",PTy(bTy,fTy)),Var("r2",F64)],
                  Apply
                    (Call
                       ("sse_sqrt64",ATy(qTy,PTy(PTy(bTy,fTy),F64)),
                        EX(Var("v",FTy 128),LN 63,LN 0,F64)),qVar"state"),
                  Apply
                    (Call
                       ("write'XMM",ATy(qTy,qTy),
                        TP[CC[Var("r1",F64),Var("r2",F64)],
                           Call("xmm_reg",CTy"xmm_mem",Var("dst",FTy 3))]),
                     Apply
                       (Call
                          ("process_float_flags",ATy(qTy,qTy),
                           LL[Var("f1",PTy(bTy,fTy)),
                              Var("f2",PTy(bTy,fTy))]),qVar"state")))))))
;
val dfn'SQRTSD_def = Def
  ("dfn'SQRTSD",TP[Var("dst",FTy 3),Var("src",CTy"xmm_mem")],
   Close
     (qVar"state",
      Let(TP[Var("f",PTy(bTy,fTy)),Var("r",F64)],
          Apply
            (Call
               ("sse_sqrt64",ATy(qTy,PTy(PTy(bTy,fTy),F64)),
                EX(Apply
                     (Call("XMM",ATy(qTy,FTy 128),Var("src",CTy"xmm_mem")),
                      qVar"state"),LN 63,LN 0,F64)),qVar"state"),
          Let(Var("x",CTy"xmm_mem"),
              Call("xmm_reg",CTy"xmm_mem",Var("dst",FTy 3)),
              Let(TP[Var("v",FTy 128),qVar"s"],
                  Let(qVar"s0",
                      Apply
                        (Call
                           ("process_float_flags",ATy(qTy,qTy),
                            LL[Var("f",PTy(bTy,fTy))]),qVar"state"),
                      TP[Apply
                           (Call
                              ("XMM",ATy(qTy,FTy 128),
                               Var("x",CTy"xmm_mem")),qVar"s0"),qVar"s0"]),
                  Apply
                    (Call
                       ("write'XMM",ATy(qTy,qTy),
                        TP[BFI(LN 63,LN 0,Var("r",F64),Var("v",FTy 128)),
                           Var("x",CTy"xmm_mem")]),qVar"s"))))))
;
val dfn'SQRTPS_def = Def
  ("dfn'SQRTPS",TP[Var("dst",FTy 3),Var("src",CTy"xmm_mem")],
   Close
     (qVar"state",
      Let(Var("v",FTy 128),
          Apply
            (Call("XMM",ATy(qTy,FTy 128),Var("src",CTy"xmm_mem")),
             qVar"state"),
          Let(TP[Var("f1",PTy(bTy,fTy)),Var("r1",F32)],
              Apply
                (Call
                   ("sse_sqrt32",ATy(qTy,PTy(PTy(bTy,fTy),F32)),
                    EX(Var("v",FTy 128),LN 127,LN 96,F32)),qVar"state"),
              Let(TP[Var("f2",PTy(bTy,fTy)),Var("r2",F32)],
                  Apply
                    (Call
                       ("sse_sqrt32",ATy(qTy,PTy(PTy(bTy,fTy),F32)),
                        EX(Var("v",FTy 128),LN 95,LN 64,F32)),qVar"state"),
                  Let(TP[Var("f3",PTy(bTy,fTy)),Var("r3",F32)],
                      Apply
                        (Call
                           ("sse_sqrt32",ATy(qTy,PTy(PTy(bTy,fTy),F32)),
                            EX(Var("v",FTy 128),LN 63,LN 32,F32)),
                         qVar"state"),
                      Let(TP[Var("f4",PTy(bTy,fTy)),Var("r4",F32)],
                          Apply
                            (Call
                               ("sse_sqrt32",
                                ATy(qTy,PTy(PTy(bTy,fTy),F32)),
                                EX(Var("v",FTy 128),LN 31,LN 0,F32)),
                             qVar"state"),
                          Apply
                            (Call
                               ("write'XMM",ATy(qTy,qTy),
                                TP[CC[Var("r1",F32),Var("r2",F32),
                                      Var("r3",F32),Var("r4",F32)],
                                   Call
                                     ("xmm_reg",CTy"xmm_mem",
                                      Var("dst",FTy 3))]),
                             Apply
                               (Call
                                  ("process_float_flags",ATy(qTy,qTy),
                                   LL[Var("f1",PTy(bTy,fTy)),
                                      Var("f2",PTy(bTy,fTy)),
                                      Var("f3",PTy(bTy,fTy)),
                                      Var("f4",PTy(bTy,fTy))]),qVar"state")))))))))
;
val dfn'SQRTSS_def = Def
  ("dfn'SQRTSS",TP[Var("dst",FTy 3),Var("src",CTy"xmm_mem")],
   Close
     (qVar"state",
      Let(TP[Var("f",PTy(bTy,fTy)),Var("r",F32)],
          Apply
            (Call
               ("sse_sqrt32",ATy(qTy,PTy(PTy(bTy,fTy),F32)),
                EX(Apply
                     (Call("XMM",ATy(qTy,FTy 128),Var("src",CTy"xmm_mem")),
                      qVar"state"),LN 31,LN 0,F32)),qVar"state"),
          Let(Var("x",CTy"xmm_mem"),
              Call("xmm_reg",CTy"xmm_mem",Var("dst",FTy 3)),
              Let(TP[Var("v",FTy 128),qVar"s"],
                  Let(qVar"s0",
                      Apply
                        (Call
                           ("process_float_flags",ATy(qTy,qTy),
                            LL[Var("f",PTy(bTy,fTy))]),qVar"state"),
                      TP[Apply
                           (Call
                              ("XMM",ATy(qTy,FTy 128),
                               Var("x",CTy"xmm_mem")),qVar"s0"),qVar"s0"]),
                  Apply
                    (Call
                       ("write'XMM",ATy(qTy,qTy),
                        TP[BFI(LN 31,LN 0,Var("r",F32),Var("v",FTy 128)),
                           Var("x",CTy"xmm_mem")]),qVar"s"))))))
;
val dfn'Zbinop_def = Def
  ("dfn'Zbinop",
   TP[Var("bop",CTy"Zbinop_name"),Var("size",CTy"Zsize"),
      Var("dst_src",CTy"Zdest_src")],
   Close
     (qVar"state",
      Let(TP[Var("ea",CTy"Zea"),Var("val_dst",F64),Var("val_src",F64)],
          Apply
            (Call
               ("read_dest_src_ea",ATy(qTy,PTy(CTy"Zea",PTy(F64,F64))),
                TP[Var("size",CTy"Zsize"),Var("dst_src",CTy"Zdest_src")]),
             qVar"state"),
          Apply
            (Call
               ("write_binop",ATy(qTy,qTy),
                TP[Var("size",CTy"Zsize"),Var("bop",CTy"Zbinop_name"),
                   Var("val_dst",F64),Var("val_src",F64),
                   Var("ea",CTy"Zea")]),qVar"state"))))
;
val dfn'Zbit_test_def = Def
  ("dfn'Zbit_test",
   TP[Var("bt",CTy"Zbit_test_name"),Var("size",CTy"Zsize"),
      Var("dst_src",CTy"Zdest_src")],
   Close
     (qVar"state",
      Let(Var("v",F64),
          Apply
            (Call
               ("EA",ATy(qTy,F64),
                Apply
                  (Call
                     ("ea_Zsrc",ATy(qTy,CTy"Zea"),
                      TP[Var("size",CTy"Zsize"),
                         Var("dst_src",CTy"Zdest_src")]),qVar"state")),
             qVar"state"),
          CS(Var("dst_src",CTy"Zdest_src"),
             [(Call("Zr_rm",CTy"Zdest_src",AVar(PTy(CTy"Zreg",CTy"Zrm"))),
               Apply(Const("UD_exception",ATy(qTy,qTy)),qVar"state")),
              (Call
                 ("Zrm_r",CTy"Zdest_src",
                  TP[Call("Zr",CTy"Zrm",AVar(CTy"Zreg")),AVar(CTy"Zreg")]),
               Apply
                 (Call
                    ("bit_test",ATy(qTy,qTy),
                     TP[Var("bt",CTy"Zbit_test_name"),
                        Apply
                          (Call
                             ("ea_Zdest",ATy(qTy,CTy"Zea"),
                              TP[Var("size",CTy"Zsize"),
                                 Var("dst_src",CTy"Zdest_src")]),
                           qVar"state"),
                        Mop(Cast nTy,
                            Call
                              ("modSize",F64,
                               TP[Var("size",CTy"Zsize"),Var("v",F64)]))]),
                  qVar"state")),
              (Call
                 ("Zrm_i",CTy"Zdest_src",
                  TP[Call("Zr",CTy"Zrm",AVar(CTy"Zreg")),AVar F64]),
               Apply
                 (Call
                    ("bit_test",ATy(qTy,qTy),
                     TP[Var("bt",CTy"Zbit_test_name"),
                        Apply
                          (Call
                             ("ea_Zdest",ATy(qTy,CTy"Zea"),
                              TP[Var("size",CTy"Zsize"),
                                 Var("dst_src",CTy"Zdest_src")]),
                           qVar"state"),
                        Mop(Cast nTy,
                            Call
                              ("modSize",F64,
                               TP[Var("size",CTy"Zsize"),Var("v",F64)]))]),
                  qVar"state")),
              (Call
                 ("Zrm_i",CTy"Zdest_src",
                  TP[Call
                       ("Zm",CTy"Zrm",
                        TP[Var("si",OTy(PTy(FTy 2,CTy"Zreg"))),
                           Var("base",CTy"Zbase"),Var("disp",F64)]),
                     AVar F64]),
               Let(Var("offset",F64),
                   Call
                     ("modSize",F64,
                      TP[Var("size",CTy"Zsize"),Var("v",F64)]),
                   Apply
                     (Call
                        ("bit_test",ATy(qTy,qTy),
                         TP[Var("bt",CTy"Zbit_test_name"),
                            Apply
                              (Call
                                 ("ea_Zrm",ATy(qTy,CTy"Zea"),
                                  TP[Call("Z8",CTy"Zsize",LF),
                                     Call
                                       ("Zm",CTy"Zrm",
                                        TP[Var("si",
                                               OTy(PTy(FTy 2,CTy"Zreg"))),
                                           Var("base",CTy"Zbase"),
                                           Bop(Add,Var("disp",F64),
                                               Bop(SDiv,Var("offset",F64),
                                                   LW(8,64)))])]),
                               qVar"state"),
                            Mop(Cast nTy,
                                Bop(SMod,Var("offset",F64),LW(8,64)))]),
                      qVar"state"))),
              (Call
                 ("Zrm_r",CTy"Zdest_src",
                  TP[Call
                       ("Zm",CTy"Zrm",
                        TP[Var("si",OTy(PTy(FTy 2,CTy"Zreg"))),
                           Var("base",CTy"Zbase"),Var("disp",F64)]),
                     AVar(CTy"Zreg")]),
               Let(TP[Var("v",F64),qVar"s"],
                   Apply
                     (Call
                        ("SignExtension64",ATy(qTy,PTy(F64,qTy)),
                         TP[Var("v",F64),Var("size",CTy"Zsize")]),
                      qVar"state"),
                   Apply
                     (Call
                        ("bit_test",ATy(qTy,qTy),
                         TP[Var("bt",CTy"Zbit_test_name"),
                            Apply
                              (Call
                                 ("ea_Zrm",ATy(qTy,CTy"Zea"),
                                  TP[Call("Z8",CTy"Zsize",LF),
                                     Call
                                       ("Zm",CTy"Zrm",
                                        TP[Var("si",
                                               OTy(PTy(FTy 2,CTy"Zreg"))),
                                           Var("base",CTy"Zbase"),
                                           Bop(Add,Var("disp",F64),
                                               Bop(SDiv,Var("v",F64),
                                                   LW(8,64)))])]),qVar"s"),
                            Mop(Cast nTy,Bop(SMod,Var("v",F64),LW(8,64)))]),
                      qVar"s")))]))))
;
val dfn'Zcall_def = Def
  ("dfn'Zcall",Var("imm_rm",CTy"Zimm_rm"),
   Close
     (qVar"state",
      Let(TP[Var("v",CTy"Zea"),qVar"s"],
          Let(qVar"s",
              Apply(Const("x64_push_rip",ATy(qTy,qTy)),qVar"state"),
              TP[Apply
                   (Call
                      ("ea_Zimm_rm",ATy(qTy,CTy"Zea"),
                       Var("imm_rm",CTy"Zimm_rm")),qVar"s"),qVar"s"]),
          Apply(Call("jump_to_ea",ATy(qTy,qTy),Var("v",CTy"Zea")),qVar"s"))))
;
val dfn'Zcmpxchg_def = Def
  ("dfn'Zcmpxchg",
   TP[Var("size",CTy"Zsize"),Var("rm",CTy"Zrm"),Var("r",CTy"Zreg")],
   Close
     (qVar"state",
      Let(Var("ea_src",CTy"Zea"),
          Call
            ("Zea_r",CTy"Zea",
             TP[Var("size",CTy"Zsize"),Var("r",CTy"Zreg")]),
          Let(Var("v",CTy"Zea"),
              Apply
                (Call
                   ("ea_Zrm",ATy(qTy,CTy"Zea"),
                    TP[Var("size",CTy"Zsize"),Var("rm",CTy"Zrm")]),
                 qVar"state"),
              Let(Var("v0",F64),
                  Apply
                    (Call("EA",ATy(qTy,F64),Var("v",CTy"Zea")),qVar"state"),
                  Let(Var("v1",F64),
                      Apply
                        (Call("EA",ATy(qTy,F64),Var("ea_src",CTy"Zea")),
                         qVar"state"),
                      Let(qVar"s",
                          Apply
                            (Call
                               ("write_binop",ATy(qTy,qTy),
                                TP[Var("size",CTy"Zsize"),
                                   LC("Zcmp",CTy"Zbinop_name"),
                                   Var("v1",F64),Var("v0",F64),
                                   Var("ea_src",CTy"Zea")]),qVar"state"),
                          ITE(EQ(Var("v1",F64),Var("v0",F64)),
                              Apply
                                (Call
                                   ("write'EA",ATy(qTy,qTy),
                                    TP[Apply
                                         (Call
                                            ("EA",ATy(qTy,F64),
                                             Var("ea_src",CTy"Zea")),
                                          qVar"s"),Var("v",CTy"Zea")]),
                                 qVar"s"),
                              Apply
                                (Call
                                   ("write'EA",ATy(qTy,qTy),
                                    TP[Var("v0",F64),
                                       Call
                                         ("Zea_r",CTy"Zea",
                                          TP[Var("size",CTy"Zsize"),
                                             LC("RAX",CTy"Zreg")])]),
                                 qVar"s")))))))))
;
val dfn'Zdiv_def = Def
  ("dfn'Zdiv",TP[Var("size",CTy"Zsize"),Var("rm",CTy"Zrm")],
   Close
     (qVar"state",
      Let(nVar"w",Call("value_width",nTy,Var("size",CTy"Zsize")),
          Let(Var("ea_eax",CTy"Zea"),
              Call
                ("Zea_r",CTy"Zea",
                 TP[Var("size",CTy"Zsize"),LC("RAX",CTy"Zreg")]),
              Let(Var("ea_edx",CTy"Zea"),
                  Call
                    ("Zea_r",CTy"Zea",
                     TP[Var("size",CTy"Zsize"),LC("RDX",CTy"Zreg")]),
                  Let(nVar"v0",
                      Bop(Add,
                          Bop(Mul,
                              Mop(Cast nTy,
                                  Apply
                                    (Call
                                       ("EA",ATy(qTy,F64),
                                        Var("ea_edx",CTy"Zea")),
                                     qVar"state")),nVar"w"),
                          Mop(Cast nTy,
                              Apply
                                (Call
                                   ("EA",ATy(qTy,F64),
                                    Var("ea_eax",CTy"Zea")),qVar"state"))),
                      Let(nVar"v1",
                          Mop(Cast nTy,
                              Apply
                                (Call
                                   ("EA",ATy(qTy,F64),
                                    Apply
                                      (Call
                                         ("ea_Zrm",ATy(qTy,CTy"Zea"),
                                          TP[Var("size",CTy"Zsize"),
                                             Var("rm",CTy"Zrm")]),
                                       qVar"state")),qVar"state")),
                          Let(nVar"q",Bop(Div,nVar"v0",nVar"v1"),
                              Apply
                                (Const("erase_eflags",ATy(qTy,qTy)),
                                 Apply
                                   (Call
                                      ("write'EA",ATy(qTy,qTy),
                                       TP[Mop(Cast F64,
                                              Bop(Mod,nVar"v0",nVar"v1")),
                                          Var("ea_edx",CTy"Zea")]),
                                    Apply
                                      (Call
                                         ("write'EA",ATy(qTy,qTy),
                                          TP[Mop(Cast F64,nVar"q"),
                                             Var("ea_eax",CTy"Zea")]),
                                       ITE(Bop(Or,EQ(nVar"v1",LN 0),
                                               Bop(Le,nVar"w",nVar"q")),
                                           Apply
                                             (Const
                                                ("DE_exception",
                                                 ATy(qTy,qTy)),qVar"state"),
                                           qVar"state"))))))))))))
;
val dfn'Zidiv_def = Def
  ("dfn'Zidiv",TP[Var("size",CTy"Zsize"),Var("rm",CTy"Zrm")],
   Close
     (qVar"state",
      Let(iVar"w",
          Mop(Cast iTy,Call("value_width",nTy,Var("size",CTy"Zsize"))),
          Let(Var("ea_eax",CTy"Zea"),
              Call
                ("Zea_r",CTy"Zea",
                 TP[Var("size",CTy"Zsize"),LC("RAX",CTy"Zreg")]),
              Let(Var("ea_edx",CTy"Zea"),
                  Call
                    ("Zea_r",CTy"Zea",
                     TP[Var("size",CTy"Zsize"),LC("RDX",CTy"Zreg")]),
                  Let(TP[iVar"v0",qVar"s"],
                      Let(TP[iVar"v",qVar"s"],
                          Let(TP[iVar"v",qVar"s"],
                              Let(TP[Var("v",F64),qVar"s"],
                                  Apply
                                    (Call
                                       ("SignExtension64",
                                        ATy(qTy,PTy(F64,qTy)),
                                        TP[Apply
                                             (Call
                                                ("EA",ATy(qTy,F64),
                                                 Var("ea_edx",CTy"Zea")),
                                              qVar"state"),
                                           Var("size",CTy"Zsize")]),
                                     qVar"state"),
                                  TP[Mop(Cast iTy,Var("v",F64)),qVar"s"]),
                              TP[Bop(Mul,iVar"v",iVar"w"),qVar"s"]),
                          TP[Bop(Add,iVar"v",
                                 Mop(Cast iTy,
                                     Mop(Cast nTy,
                                         Apply
                                           (Call
                                              ("EA",ATy(qTy,F64),
                                               Var("ea_eax",CTy"Zea")),
                                            qVar"s")))),qVar"s"]),
                      Let(TP[iVar"v1",qVar"s"],
                          Let(TP[Var("v",F64),qVar"s"],
                              Apply
                                (Call
                                   ("SignExtension64",
                                    ATy(qTy,PTy(F64,qTy)),
                                    TP[Apply
                                         (Call
                                            ("EA",ATy(qTy,F64),
                                             Apply
                                               (Call
                                                  ("ea_Zrm",
                                                   ATy(qTy,CTy"Zea"),
                                                   TP[Var("size",
                                                          CTy"Zsize"),
                                                      Var("rm",CTy"Zrm")]),
                                                qVar"state")),qVar"s"),
                                       Var("size",CTy"Zsize")]),qVar"s"),
                              TP[Mop(Cast iTy,Var("v",F64)),qVar"s"]),
                          Let(iVar"q",Bop(Quot,iVar"v0",iVar"v1"),
                              Apply
                                (Const("erase_eflags",ATy(qTy,qTy)),
                                 Apply
                                   (Call
                                      ("write'EA",ATy(qTy,qTy),
                                       TP[Mop(Cast F64,
                                              Bop(Rem,iVar"v0",iVar"v1")),
                                          Var("ea_edx",CTy"Zea")]),
                                    Apply
                                      (Call
                                         ("write'EA",ATy(qTy,qTy),
                                          TP[Mop(Cast F64,iVar"q"),
                                             Var("ea_eax",CTy"Zea")]),
                                       ITE(Bop(Or,EQ(iVar"v1",LI 0),
                                               Bop(Or,
                                                   Bop(Lt,iVar"q",
                                                       Mop(Neg,
                                                           Bop(Div,
                                                               iVar"w",
                                                               LI 2))),
                                                   Bop(Le,
                                                       Bop(Div,iVar"w",
                                                           LI 2),iVar"q"))),
                                           Apply
                                             (Const
                                                ("DE_exception",
                                                 ATy(qTy,qTy)),qVar"s"),
                                           qVar"s"))))))))))))
;
val dfn'Zjcc_def = Def
  ("dfn'Zjcc",TP[Var("cond",CTy"Zcond"),Var("imm",F64)],
   Close
     (qVar"state",
      Let(TP[bVar"v",qVar"s"],
          Apply
            (Call
               ("read_cond",ATy(qTy,PTy(bTy,qTy)),Var("cond",CTy"Zcond")),
             qVar"state"),
          ITE(bVar"v",
              Rupd
                ("RIP",
                 TP[qVar"s",
                    Bop(Add,Dest("RIP",F64,qVar"s"),Var("imm",F64))]),
              qVar"s"))))
;
val dfn'Zjmp_def = Def
  ("dfn'Zjmp",Var("rm",CTy"Zrm"),
   Close
     (qVar"state",
      Rupd
        ("RIP",
         TP[qVar"state",
            Apply
              (Call
                 ("EA",ATy(qTy,F64),
                  Apply
                    (Call
                       ("ea_Zrm",ATy(qTy,CTy"Zea"),
                        TP[Const("Z64",CTy"Zsize"),Var("rm",CTy"Zrm")]),
                     qVar"state")),qVar"state")])))
;
val dfn'Zlea_def = Def
  ("dfn'Zlea",TP[Var("size",CTy"Zsize"),Var("dst_src",CTy"Zdest_src")],
   Close
     (qVar"state",
      Apply
        (Call
           ("write'EA",ATy(qTy,qTy),
            TP[Call
                 ("get_ea_address",F64,
                  Apply
                    (Call
                       ("ea_Zsrc",ATy(qTy,CTy"Zea"),
                        TP[Var("size",CTy"Zsize"),
                           Var("dst_src",CTy"Zdest_src")]),qVar"state")),
               Apply
                 (Call
                    ("ea_Zdest",ATy(qTy,CTy"Zea"),
                     TP[Var("size",CTy"Zsize"),
                        Var("dst_src",CTy"Zdest_src")]),qVar"state")]),
         qVar"state")))
;
val dfn'Zleave_def = Def
  ("dfn'Zleave",qVar"state",
   Apply
     (Call("x64_pop",ATy(qTy,qTy),Call("Zr",CTy"Zrm",LC("RBP",CTy"Zreg"))),
      Rupd
        ("REG",
         TP[qVar"state",
            Fupd
              (Dest("REG",ATy(CTy"Zreg",F64),qVar"state"),
               LC("RSP",CTy"Zreg"),
               Apply
                 (Dest("REG",ATy(CTy"Zreg",F64),qVar"state"),
                  LC("RBP",CTy"Zreg")))])))
;
val dfn'Zloop_def = Def
  ("dfn'Zloop",TP[Var("cond",CTy"Zcond"),Var("imm",F64)],
   Close
     (qVar"state",
      Let(Var("v",F64),
          Bop(Sub,
              Apply
                (Dest("REG",ATy(CTy"Zreg",F64),qVar"state"),
                 LC("RCX",CTy"Zreg")),LW(1,64)),
          Let(qVar"s",
              Rupd
                ("REG",
                 TP[qVar"state",
                    Fupd
                      (Dest("REG",ATy(CTy"Zreg",F64),qVar"state"),
                       LC("RCX",CTy"Zreg"),Var("v",F64))]),
              Let(TP[bVar"v",qVar"s"],
                  ITE(Mop(Not,EQ(Var("v",F64),LW(0,64))),
                      Apply
                        (Call
                           ("read_cond",ATy(qTy,PTy(bTy,qTy)),
                            Var("cond",CTy"Zcond")),qVar"s"),
                      TP[LF,qVar"s"]),
                  ITE(bVar"v",
                      Rupd
                        ("RIP",
                         TP[qVar"s",
                            Bop(Add,Dest("RIP",F64,qVar"s"),Var("imm",F64))]),
                      qVar"s"))))))
;
val dfn'Zmonop_def = Def
  ("dfn'Zmonop",
   TP[Var("mop",CTy"Zmonop_name"),Var("size",CTy"Zsize"),
      Var("rm",CTy"Zrm")],
   Close
     (qVar"state",
      Let(Var("v",CTy"Zea"),
          Apply
            (Call
               ("ea_Zrm",ATy(qTy,CTy"Zea"),
                TP[Var("size",CTy"Zsize"),Var("rm",CTy"Zrm")]),qVar"state"),
          Apply
            (Call
               ("write_monop",ATy(qTy,qTy),
                TP[Var("size",CTy"Zsize"),Var("mop",CTy"Zmonop_name"),
                   Apply
                     (Call("EA",ATy(qTy,F64),Var("v",CTy"Zea")),
                      qVar"state"),Var("v",CTy"Zea")]),qVar"state"))))
;
val dfn'Zmov_def = Def
  ("dfn'Zmov",
   TP[Var("cond",CTy"Zcond"),Var("size",CTy"Zsize"),
      Var("dst_src",CTy"Zdest_src")],
   Close
     (qVar"state",
      Let(TP[bVar"v",qVar"s"],
          Apply
            (Call
               ("read_cond",ATy(qTy,PTy(bTy,qTy)),Var("cond",CTy"Zcond")),
             qVar"state"),
          ITE(bVar"v",
              Apply
                (Call
                   ("write'EA",ATy(qTy,qTy),
                    TP[Apply
                         (Call
                            ("EA",ATy(qTy,F64),
                             Apply
                               (Call
                                  ("ea_Zsrc",ATy(qTy,CTy"Zea"),
                                   TP[Var("size",CTy"Zsize"),
                                      Var("dst_src",CTy"Zdest_src")]),
                                qVar"s")),qVar"s"),
                       Apply
                         (Call
                            ("ea_Zdest",ATy(qTy,CTy"Zea"),
                             TP[Var("size",CTy"Zsize"),
                                Var("dst_src",CTy"Zdest_src")]),qVar"s")]),
                 qVar"s"),qVar"s"))))
;
val dfn'Zmovsx_def = Def
  ("dfn'Zmovsx",
   TP[Var("size1",CTy"Zsize"),Var("dst_src",CTy"Zdest_src"),
      Var("size2",CTy"Zsize")],
   Close
     (qVar"state",
      Let(TP[Var("v",PTy(F64,CTy"Zea")),qVar"s"],
          Let(TP[Var("v0",F64),qVar"s"],
              Apply
                (Call
                   ("SignExtension",ATy(qTy,PTy(F64,qTy)),
                    TP[Apply
                         (Call
                            ("EA",ATy(qTy,F64),
                             Apply
                               (Call
                                  ("ea_Zsrc",ATy(qTy,CTy"Zea"),
                                   TP[Var("size1",CTy"Zsize"),
                                      Var("dst_src",CTy"Zdest_src")]),
                                qVar"state")),qVar"state"),
                       Var("size1",CTy"Zsize"),Var("size2",CTy"Zsize")]),
                 qVar"state"),
              TP[TP[Var("v0",F64),
                    Apply
                      (Call
                         ("ea_Zdest",ATy(qTy,CTy"Zea"),
                          TP[Var("size2",CTy"Zsize"),
                             Var("dst_src",CTy"Zdest_src")]),qVar"state")],
                 qVar"s"]),
          Apply
            (Call("write'EA",ATy(qTy,qTy),Var("v",PTy(F64,CTy"Zea"))),
             qVar"s"))))
;
val dfn'Zmovzx_def = Def
  ("dfn'Zmovzx",
   TP[Var("size1",CTy"Zsize"),Var("dst_src",CTy"Zdest_src"),
      Var("size2",CTy"Zsize")],
   Close
     (qVar"state",
      Apply
        (Call
           ("write'EA",ATy(qTy,qTy),
            TP[Apply
                 (Call
                    ("EA",ATy(qTy,F64),
                     Apply
                       (Call
                          ("ea_Zsrc",ATy(qTy,CTy"Zea"),
                           TP[Var("size1",CTy"Zsize"),
                              Var("dst_src",CTy"Zdest_src")]),qVar"state")),
                  qVar"state"),
               Apply
                 (Call
                    ("ea_Zdest",ATy(qTy,CTy"Zea"),
                     TP[Var("size2",CTy"Zsize"),
                        Var("dst_src",CTy"Zdest_src")]),qVar"state")]),
         qVar"state")))
;
val dfn'Zmul_def = Def
  ("dfn'Zmul",TP[Var("size",CTy"Zsize"),Var("rm",CTy"Zrm")],
   Close
     (qVar"state",
      Let(Var("ea_eax",CTy"Zea"),
          Call
            ("Zea_r",CTy"Zea",
             TP[Var("size",CTy"Zsize"),LC("RAX",CTy"Zreg")]),
          Let(Var("v",F64),
              Apply
                (Call("EA",ATy(qTy,F64),Var("ea_eax",CTy"Zea")),
                 qVar"state"),
              Let(Var("v0",F64),
                  Apply
                    (Call
                       ("EA",ATy(qTy,F64),
                        Apply
                          (Call
                             ("ea_Zrm",ATy(qTy,CTy"Zea"),
                              TP[Var("size",CTy"Zsize"),Var("rm",CTy"Zrm")]),
                           qVar"state")),qVar"state"),
                  Apply
                    (Const("erase_eflags",ATy(qTy,qTy)),
                     CS(Var("size",CTy"Zsize"),
                        [(Call("Z8",CTy"Zsize",AVar bTy),
                          Apply
                            (Call
                               ("write'EA",ATy(qTy,qTy),
                                TP[Bop(Mul,Var("v",F64),Var("v0",F64)),
                                   Call
                                     ("Zea_r",CTy"Zea",
                                      TP[Const("Z16",CTy"Zsize"),
                                         LC("RAX",CTy"Zreg")])]),
                             qVar"state")),
                         (AVar(CTy"Zsize"),
                          Apply
                            (Call
                               ("write'EA",ATy(qTy,qTy),
                                TP[Mop(Cast F64,
                                       Bop(Div,
                                           Bop(Mul,
                                               Mop(Cast nTy,Var("v",F64)),
                                               Mop(Cast nTy,Var("v0",F64))),
                                           Call
                                             ("value_width",nTy,
                                              Var("size",CTy"Zsize")))),
                                   Call
                                     ("Zea_r",CTy"Zea",
                                      TP[Var("size",CTy"Zsize"),
                                         LC("RDX",CTy"Zreg")])]),
                             Apply
                               (Call
                                  ("write'EA",ATy(qTy,qTy),
                                   TP[Bop(Mul,Var("v",F64),Var("v0",F64)),
                                      Var("ea_eax",CTy"Zea")]),qVar"state")))])))))))
;
val dfn'Zimul_def = Def
  ("dfn'Zimul",TP[Var("size",CTy"Zsize"),Var("rm",CTy"Zrm")],
   Close
     (qVar"state",
      Let(Var("ea_eax",CTy"Zea"),
          Call
            ("Zea_r",CTy"Zea",
             TP[Var("size",CTy"Zsize"),LC("RAX",CTy"Zreg")]),
          Let(TP[Var("v",F64),qVar"s"],
              Apply
                (Call
                   ("SignExtension64",ATy(qTy,PTy(F64,qTy)),
                    TP[Apply
                         (Call("EA",ATy(qTy,F64),Var("ea_eax",CTy"Zea")),
                          qVar"state"),Var("size",CTy"Zsize")]),
                 qVar"state"),
              Let(TP[Var("v0",F64),qVar"s"],
                  Apply
                    (Call
                       ("SignExtension64",ATy(qTy,PTy(F64,qTy)),
                        TP[Apply
                             (Call
                                ("EA",ATy(qTy,F64),
                                 Apply
                                   (Call
                                      ("ea_Zrm",ATy(qTy,CTy"Zea"),
                                       TP[Var("size",CTy"Zsize"),
                                          Var("rm",CTy"Zrm")]),qVar"s")),
                              qVar"s"),Var("size",CTy"Zsize")]),qVar"s"),
                  Let(iVar"product",
                      Bop(Mul,Mop(Cast iTy,Var("v",F64)),
                          Mop(Cast iTy,Var("v0",F64))),
                      Let(Var("product64",F64),
                          Mop(Cast F64,iVar"product"),
                          Let(qVar"s",
                              Apply
                                (Const("erase_eflags",ATy(qTy,qTy)),
                                 qVar"s"),
                              Let(TP[bVar"v",qVar"s"],
                                  ITE(EQ(Var("size",CTy"Zsize"),
                                         Const("Z64",CTy"Zsize")),
                                      TP[EQ(Mop(Cast iTy,
                                                Var("product64",F64)),
                                            iVar"product"),qVar"s"],
                                      Let(TP[Var("v",F64),qVar"s"],
                                          Apply
                                            (Call
                                               ("SignExtension64",
                                                ATy(qTy,PTy(F64,qTy)),
                                                TP[Var("product64",F64),
                                                   Var("size",CTy"Zsize")]),
                                             qVar"s"),
                                          TP[EQ(Var("v",F64),
                                                Var("product64",F64)),
                                             qVar"s"])),
                                  Let(bVar"v",Mop(Not,bVar"v"),
                                      Let(qVar"s",
                                          Apply
                                            (Call
                                               ("write'OF",ATy(qTy,qTy),
                                                bVar"v"),
                                             Apply
                                               (Call
                                                  ("write'CF",
                                                   ATy(qTy,qTy),bVar"v"),
                                                qVar"s")),
                                          CS(Var("size",CTy"Zsize"),
                                             [(Call
                                                 ("Z8",CTy"Zsize",AVar bTy),
                                               Apply
                                                 (Call
                                                    ("write'EA",
                                                     ATy(qTy,qTy),
                                                     TP[Var("product64",
                                                            F64),
                                                        Call
                                                          ("Zea_r",
                                                           CTy"Zea",
                                                           TP[Const
                                                                ("Z16",
                                                                 CTy"Zsize"),
                                                              LC("RAX",
                                                                 CTy"Zreg")])]),
                                                  qVar"s")),
                                              (AVar(CTy"Zsize"),
                                               Apply
                                                 (Call
                                                    ("write'EA",
                                                     ATy(qTy,qTy),
                                                     TP[Mop(Cast F64,
                                                            Bop(Div,
                                                                iVar"product",
                                                                Mop(Cast
                                                                      iTy,
                                                                    Call
                                                                      ("value_width",
                                                                       nTy,
                                                                       Var("size",
                                                                           CTy"Zsize"))))),
                                                        Call
                                                          ("Zea_r",
                                                           CTy"Zea",
                                                           TP[Var("size",
                                                                  CTy"Zsize"),
                                                              LC("RDX",
                                                                 CTy"Zreg")])]),
                                                  Apply
                                                    (Call
                                                       ("write'EA",
                                                        ATy(qTy,qTy),
                                                        TP[Var("product64",
                                                               F64),
                                                           Var("ea_eax",
                                                               CTy"Zea")]),
                                                     qVar"s")))]))))))))))))
;
val dfn'Zimul2_def = Def
  ("dfn'Zimul2",
   TP[Var("size",CTy"Zsize"),Var("r",CTy"Zreg"),Var("rm",CTy"Zrm")],
   Close
     (qVar"state",
      Let(Var("ea_dst",CTy"Zea"),
          Call
            ("Zea_r",CTy"Zea",
             TP[Var("size",CTy"Zsize"),Var("r",CTy"Zreg")]),
          Let(TP[Var("v",F64),qVar"s"],
              Apply
                (Call
                   ("SignExtension64",ATy(qTy,PTy(F64,qTy)),
                    TP[Apply
                         (Call("EA",ATy(qTy,F64),Var("ea_dst",CTy"Zea")),
                          qVar"state"),Var("size",CTy"Zsize")]),
                 qVar"state"),
              Let(TP[Var("v0",F64),qVar"s"],
                  Apply
                    (Call
                       ("SignExtension64",ATy(qTy,PTy(F64,qTy)),
                        TP[Apply
                             (Call
                                ("EA",ATy(qTy,F64),
                                 Apply
                                   (Call
                                      ("ea_Zrm",ATy(qTy,CTy"Zea"),
                                       TP[Var("size",CTy"Zsize"),
                                          Var("rm",CTy"Zrm")]),qVar"s")),
                              qVar"s"),Var("size",CTy"Zsize")]),qVar"s"),
                  Let(iVar"product",
                      Bop(Mul,Mop(Cast iTy,Var("v",F64)),
                          Mop(Cast iTy,Var("v0",F64))),
                      Let(Var("product64",F64),
                          Mop(Cast F64,iVar"product"),
                          Let(qVar"s",
                              Apply
                                (Const("erase_eflags",ATy(qTy,qTy)),
                                 qVar"s"),
                              Let(TP[bVar"v",qVar"s"],
                                  ITE(EQ(Var("size",CTy"Zsize"),
                                         Const("Z64",CTy"Zsize")),
                                      TP[EQ(Mop(Cast iTy,
                                                Var("product64",F64)),
                                            iVar"product"),qVar"s"],
                                      Let(TP[Var("v",F64),qVar"s"],
                                          Apply
                                            (Call
                                               ("SignExtension64",
                                                ATy(qTy,PTy(F64,qTy)),
                                                TP[Var("product64",F64),
                                                   Var("size",CTy"Zsize")]),
                                             qVar"s"),
                                          TP[EQ(Var("v",F64),
                                                Var("product64",F64)),
                                             qVar"s"])),
                                  Let(bVar"v",Mop(Not,bVar"v"),
                                      Apply
                                        (Call
                                           ("write'EA",ATy(qTy,qTy),
                                            TP[Var("product64",F64),
                                               Var("ea_dst",CTy"Zea")]),
                                         Apply
                                           (Call
                                              ("write'OF",ATy(qTy,qTy),
                                               bVar"v"),
                                            Apply
                                              (Call
                                                 ("write'CF",ATy(qTy,qTy),
                                                  bVar"v"),qVar"s")))))))))))))
;
val dfn'Zimul3_def = Def
  ("dfn'Zimul3",
   TP[Var("size",CTy"Zsize"),Var("r",CTy"Zreg"),Var("rm",CTy"Zrm"),
      Var("imm",F64)],
   Close
     (qVar"state",
      Let(TP[Var("v",F64),qVar"s"],
          Apply
            (Call
               ("SignExtension64",ATy(qTy,PTy(F64,qTy)),
                TP[Apply
                     (Call
                        ("EA",ATy(qTy,F64),
                         Apply
                           (Call
                              ("ea_Zrm",ATy(qTy,CTy"Zea"),
                               TP[Var("size",CTy"Zsize"),
                                  Var("rm",CTy"Zrm")]),qVar"state")),
                      qVar"state"),Var("size",CTy"Zsize")]),qVar"state"),
          Let(iVar"product",
              Bop(Mul,Mop(Cast iTy,Var("v",F64)),
                  Mop(Cast iTy,Var("imm",F64))),
              Let(Var("product64",F64),Mop(Cast F64,iVar"product"),
                  Let(qVar"s",
                      Apply(Const("erase_eflags",ATy(qTy,qTy)),qVar"s"),
                      Let(TP[bVar"v",qVar"s"],
                          ITE(EQ(Var("size",CTy"Zsize"),
                                 Const("Z64",CTy"Zsize")),
                              TP[EQ(Mop(Cast iTy,Var("product64",F64)),
                                    iVar"product"),qVar"s"],
                              Let(TP[Var("v",F64),qVar"s"],
                                  Apply
                                    (Call
                                       ("SignExtension64",
                                        ATy(qTy,PTy(F64,qTy)),
                                        TP[Var("product64",F64),
                                           Var("size",CTy"Zsize")]),
                                     qVar"s"),
                                  TP[EQ(Var("v",F64),Var("product64",F64)),
                                     qVar"s"])),
                          Let(bVar"v",Mop(Not,bVar"v"),
                              Apply
                                (Call
                                   ("write'EA",ATy(qTy,qTy),
                                    TP[Var("product64",F64),
                                       Call
                                         ("Zea_r",CTy"Zea",
                                          TP[Var("size",CTy"Zsize"),
                                             Var("r",CTy"Zreg")])]),
                                 Apply
                                   (Call("write'OF",ATy(qTy,qTy),bVar"v"),
                                    Apply
                                      (Call
                                         ("write'CF",ATy(qTy,qTy),bVar"v"),
                                       qVar"s")))))))))))
;
val dfn'Znop_def = Def ("dfn'Znop",nVar"n",LU)
;
val dfn'Zpop_def = Def
  ("dfn'Zpop",Var("rm",CTy"Zrm"),
   Close
     (qVar"state",
      Apply(Call("x64_pop",ATy(qTy,qTy),Var("rm",CTy"Zrm")),qVar"state")))
;
val dfn'Zpush_def = Def
  ("dfn'Zpush",Var("imm_rm",CTy"Zimm_rm"),
   Close
     (qVar"state",
      Apply
        (Call("x64_push",ATy(qTy,qTy),Var("imm_rm",CTy"Zimm_rm")),
         qVar"state")))
;
val dfn'Zret_def = Def
  ("dfn'Zret",Var("imm",F64),
   Close
     (qVar"state",
      Apply
        (Call("x64_drop",ATy(qTy,qTy),Var("imm",F64)),
         Apply(Const("x64_pop_rip",ATy(qTy,qTy)),qVar"state"))))
;
val dfn'Zset_def = Def
  ("dfn'Zset",
   TP[Var("cond",CTy"Zcond"),bVar"have_rex",Var("rm",CTy"Zrm")],
   Close
     (qVar"state",
      Let(TP[bVar"v0",qVar"s"],
          Apply
            (Call
               ("read_cond",ATy(qTy,PTy(bTy,qTy)),Var("cond",CTy"Zcond")),
             qVar"state"),
          Apply
            (Call
               ("write'EA",ATy(qTy,qTy),
                TP[Mop(Cast F64,bVar"v0"),
                   Apply
                     (Call
                        ("ea_Zrm",ATy(qTy,CTy"Zea"),
                         TP[Call("Z8",CTy"Zsize",bVar"have_rex"),
                            Var("rm",CTy"Zrm")]),qVar"state")]),qVar"s"))))
;
val dfn'Zxadd_def = Def
  ("dfn'Zxadd",
   TP[Var("size",CTy"Zsize"),Var("rm",CTy"Zrm"),Var("r",CTy"Zreg")],
   Close
     (qVar"state",
      Let(Var("ea_src",CTy"Zea"),
          Call
            ("Zea_r",CTy"Zea",
             TP[Var("size",CTy"Zsize"),Var("r",CTy"Zreg")]),
          Let(Var("v",CTy"Zea"),
              Apply
                (Call
                   ("ea_Zrm",ATy(qTy,CTy"Zea"),
                    TP[Var("size",CTy"Zsize"),Var("rm",CTy"Zrm")]),
                 qVar"state"),
              Let(Var("v1",F64),
                  Apply
                    (Call("EA",ATy(qTy,F64),Var("v",CTy"Zea")),qVar"state"),
                  Apply
                    (Call
                       ("write_binop",ATy(qTy,qTy),
                        TP[Var("size",CTy"Zsize"),
                           LC("Zadd",CTy"Zbinop_name"),
                           Apply
                             (Call
                                ("EA",ATy(qTy,F64),Var("ea_src",CTy"Zea")),
                              qVar"state"),Var("v1",F64),Var("v",CTy"Zea")]),
                     Apply
                       (Call
                          ("write'EA",ATy(qTy,qTy),
                           TP[Var("v1",F64),Var("ea_src",CTy"Zea")]),
                        qVar"state")))))))
;
val dfn'Zxchg_def = Def
  ("dfn'Zxchg",
   TP[Var("size",CTy"Zsize"),Var("rm",CTy"Zrm"),Var("r",CTy"Zreg")],
   Close
     (qVar"state",
      Let(Var("ea_src",CTy"Zea"),
          Call
            ("Zea_r",CTy"Zea",
             TP[Var("size",CTy"Zsize"),Var("r",CTy"Zreg")]),
          Let(Var("v",CTy"Zea"),
              Apply
                (Call
                   ("ea_Zrm",ATy(qTy,CTy"Zea"),
                    TP[Var("size",CTy"Zsize"),Var("rm",CTy"Zrm")]),
                 qVar"state"),
              Apply
                (Call
                   ("write'EA",ATy(qTy,qTy),
                    TP[Apply
                         (Call("EA",ATy(qTy,F64),Var("ea_src",CTy"Zea")),
                          qVar"state"),Var("v",CTy"Zea")]),
                 Apply
                   (Call
                      ("write'EA",ATy(qTy,qTy),
                       TP[Apply
                            (Call("EA",ATy(qTy,F64),Var("v",CTy"Zea")),
                             qVar"state"),Var("ea_src",CTy"Zea")]),
                    qVar"state"))))))
;
val dfn'Zcmc_def = Def
  ("dfn'Zcmc",qVar"state",
   Let(TP[bVar"v",qVar"s"],
       Apply(Const("CF",ATy(qTy,PTy(bTy,qTy))),qVar"state"),
       Apply(Call("write'CF",ATy(qTy,qTy),Mop(Not,bVar"v")),qVar"s")))
;
val dfn'Zclc_def = Def
  ("dfn'Zclc",qVar"state",
   Apply(Call("write'CF",ATy(qTy,qTy),LF),qVar"state"))
;
val dfn'Zstc_def = Def
  ("dfn'Zstc",qVar"state",
   Apply(Call("write'CF",ATy(qTy,qTy),LT),qVar"state"))
;
val Run_def = Def
  ("Run",Var("v0",CTy"instruction"),
   Close
     (qVar"state",
      CS(Var("v0",CTy"instruction"),
         [(Const("Zclc",CTy"instruction"),
           Apply(Const("dfn'Zclc",ATy(qTy,qTy)),qVar"state")),
          (Const("Zcmc",CTy"instruction"),
           Apply(Const("dfn'Zcmc",ATy(qTy,qTy)),qVar"state")),
          (Const("Zleave",CTy"instruction"),
           Apply(Const("dfn'Zleave",ATy(qTy,qTy)),qVar"state")),
          (Const("Zstc",CTy"instruction"),
           Apply(Const("dfn'Zstc",ATy(qTy,qTy)),qVar"state")),
          (Call
             ("Zbinop",CTy"instruction",
              Var("v47",
                  PTy(CTy"Zbinop_name",PTy(CTy"Zsize",CTy"Zdest_src")))),
           Apply
             (Call
                ("dfn'Zbinop",ATy(qTy,qTy),
                 Var("v47",
                     PTy(CTy"Zbinop_name",PTy(CTy"Zsize",CTy"Zdest_src")))),
              qVar"state")),
          (Call
             ("Zbit_test",CTy"instruction",
              Var("v48",
                  PTy(CTy"Zbit_test_name",PTy(CTy"Zsize",CTy"Zdest_src")))),
           Apply
             (Call
                ("dfn'Zbit_test",ATy(qTy,qTy),
                 Var("v48",
                     PTy(CTy"Zbit_test_name",
                         PTy(CTy"Zsize",CTy"Zdest_src")))),qVar"state")),
          (Call("Zcall",CTy"instruction",Var("v49",CTy"Zimm_rm")),
           Apply
             (Call("dfn'Zcall",ATy(qTy,qTy),Var("v49",CTy"Zimm_rm")),
              qVar"state")),
          (Call
             ("Zcmpxchg",CTy"instruction",
              Var("v50",PTy(CTy"Zsize",PTy(CTy"Zrm",CTy"Zreg")))),
           Apply
             (Call
                ("dfn'Zcmpxchg",ATy(qTy,qTy),
                 Var("v50",PTy(CTy"Zsize",PTy(CTy"Zrm",CTy"Zreg")))),
              qVar"state")),
          (Call
             ("Zdiv",CTy"instruction",Var("v51",PTy(CTy"Zsize",CTy"Zrm"))),
           Apply
             (Call
                ("dfn'Zdiv",ATy(qTy,qTy),
                 Var("v51",PTy(CTy"Zsize",CTy"Zrm"))),qVar"state")),
          (Call
             ("Zidiv",CTy"instruction",Var("v52",PTy(CTy"Zsize",CTy"Zrm"))),
           Apply
             (Call
                ("dfn'Zidiv",ATy(qTy,qTy),
                 Var("v52",PTy(CTy"Zsize",CTy"Zrm"))),qVar"state")),
          (Call
             ("Zimul",CTy"instruction",Var("v53",PTy(CTy"Zsize",CTy"Zrm"))),
           Apply
             (Call
                ("dfn'Zimul",ATy(qTy,qTy),
                 Var("v53",PTy(CTy"Zsize",CTy"Zrm"))),qVar"state")),
          (Call
             ("Zimul2",CTy"instruction",
              Var("v54",PTy(CTy"Zsize",PTy(CTy"Zreg",CTy"Zrm")))),
           Apply
             (Call
                ("dfn'Zimul2",ATy(qTy,qTy),
                 Var("v54",PTy(CTy"Zsize",PTy(CTy"Zreg",CTy"Zrm")))),
              qVar"state")),
          (Call
             ("Zimul3",CTy"instruction",
              Var("v55",PTy(CTy"Zsize",PTy(CTy"Zreg",PTy(CTy"Zrm",F64))))),
           Apply
             (Call
                ("dfn'Zimul3",ATy(qTy,qTy),
                 Var("v55",
                     PTy(CTy"Zsize",PTy(CTy"Zreg",PTy(CTy"Zrm",F64))))),
              qVar"state")),
          (Call("Zjcc",CTy"instruction",Var("v56",PTy(CTy"Zcond",F64))),
           Apply
             (Call("dfn'Zjcc",ATy(qTy,qTy),Var("v56",PTy(CTy"Zcond",F64))),
              qVar"state")),
          (Call("Zjmp",CTy"instruction",Var("v57",CTy"Zrm")),
           Apply
             (Call("dfn'Zjmp",ATy(qTy,qTy),Var("v57",CTy"Zrm")),
              qVar"state")),
          (Call
             ("Zlea",CTy"instruction",
              Var("v58",PTy(CTy"Zsize",CTy"Zdest_src"))),
           Apply
             (Call
                ("dfn'Zlea",ATy(qTy,qTy),
                 Var("v58",PTy(CTy"Zsize",CTy"Zdest_src"))),qVar"state")),
          (Call("Zloop",CTy"instruction",Var("v59",PTy(CTy"Zcond",F64))),
           Apply
             (Call
                ("dfn'Zloop",ATy(qTy,qTy),Var("v59",PTy(CTy"Zcond",F64))),
              qVar"state")),
          (Call
             ("Zmonop",CTy"instruction",
              Var("v60",PTy(CTy"Zmonop_name",PTy(CTy"Zsize",CTy"Zrm")))),
           Apply
             (Call
                ("dfn'Zmonop",ATy(qTy,qTy),
                 Var("v60",PTy(CTy"Zmonop_name",PTy(CTy"Zsize",CTy"Zrm")))),
              qVar"state")),
          (Call
             ("Zmov",CTy"instruction",
              Var("v61",PTy(CTy"Zcond",PTy(CTy"Zsize",CTy"Zdest_src")))),
           Apply
             (Call
                ("dfn'Zmov",ATy(qTy,qTy),
                 Var("v61",PTy(CTy"Zcond",PTy(CTy"Zsize",CTy"Zdest_src")))),
              qVar"state")),
          (Call
             ("Zmovsx",CTy"instruction",
              Var("v62",PTy(CTy"Zsize",PTy(CTy"Zdest_src",CTy"Zsize")))),
           Apply
             (Call
                ("dfn'Zmovsx",ATy(qTy,qTy),
                 Var("v62",PTy(CTy"Zsize",PTy(CTy"Zdest_src",CTy"Zsize")))),
              qVar"state")),
          (Call
             ("Zmovzx",CTy"instruction",
              Var("v63",PTy(CTy"Zsize",PTy(CTy"Zdest_src",CTy"Zsize")))),
           Apply
             (Call
                ("dfn'Zmovzx",ATy(qTy,qTy),
                 Var("v63",PTy(CTy"Zsize",PTy(CTy"Zdest_src",CTy"Zsize")))),
              qVar"state")),
          (Call
             ("Zmul",CTy"instruction",Var("v64",PTy(CTy"Zsize",CTy"Zrm"))),
           Apply
             (Call
                ("dfn'Zmul",ATy(qTy,qTy),
                 Var("v64",PTy(CTy"Zsize",CTy"Zrm"))),qVar"state")),
          (Call("Znop",CTy"instruction",nVar"v65"),qVar"state"),
          (Call("Zpop",CTy"instruction",Var("v66",CTy"Zrm")),
           Apply
             (Call("dfn'Zpop",ATy(qTy,qTy),Var("v66",CTy"Zrm")),
              qVar"state")),
          (Call("Zpush",CTy"instruction",Var("v67",CTy"Zimm_rm")),
           Apply
             (Call("dfn'Zpush",ATy(qTy,qTy),Var("v67",CTy"Zimm_rm")),
              qVar"state")),
          (Call("Zret",CTy"instruction",Var("v68",F64)),
           Apply(Call("dfn'Zret",ATy(qTy,qTy),Var("v68",F64)),qVar"state")),
          (Call
             ("Zset",CTy"instruction",
              Var("v69",PTy(CTy"Zcond",PTy(bTy,CTy"Zrm")))),
           Apply
             (Call
                ("dfn'Zset",ATy(qTy,qTy),
                 Var("v69",PTy(CTy"Zcond",PTy(bTy,CTy"Zrm")))),qVar"state")),
          (Call
             ("Zxadd",CTy"instruction",
              Var("v70",PTy(CTy"Zsize",PTy(CTy"Zrm",CTy"Zreg")))),
           Apply
             (Call
                ("dfn'Zxadd",ATy(qTy,qTy),
                 Var("v70",PTy(CTy"Zsize",PTy(CTy"Zrm",CTy"Zreg")))),
              qVar"state")),
          (Call
             ("Zxchg",CTy"instruction",
              Var("v71",PTy(CTy"Zsize",PTy(CTy"Zrm",CTy"Zreg")))),
           Apply
             (Call
                ("dfn'Zxchg",ATy(qTy,qTy),
                 Var("v71",PTy(CTy"Zsize",PTy(CTy"Zrm",CTy"Zreg")))),
              qVar"state")),
          (Call("SSE",CTy"instruction",Var("v1",CTy"SSE")),
           CS(Var("v1",CTy"SSE"),
              [(Call
                  ("CMPPD",CTy"SSE",
                   Var("v2",PTy(CTy"sse_compare",PTy(FTy 3,CTy"xmm_mem")))),
                Apply
                  (Call
                     ("dfn'CMPPD",ATy(qTy,qTy),
                      Var("v2",
                          PTy(CTy"sse_compare",PTy(FTy 3,CTy"xmm_mem")))),
                   qVar"state")),
               (Call
                  ("CMPPS",CTy"SSE",
                   Var("v3",PTy(CTy"sse_compare",PTy(FTy 3,CTy"xmm_mem")))),
                Apply
                  (Call
                     ("dfn'CMPPS",ATy(qTy,qTy),
                      Var("v3",
                          PTy(CTy"sse_compare",PTy(FTy 3,CTy"xmm_mem")))),
                   qVar"state")),
               (Call
                  ("CMPSD",CTy"SSE",
                   Var("v4",PTy(CTy"sse_compare",PTy(FTy 3,CTy"xmm_mem")))),
                Apply
                  (Call
                     ("dfn'CMPSD",ATy(qTy,qTy),
                      Var("v4",
                          PTy(CTy"sse_compare",PTy(FTy 3,CTy"xmm_mem")))),
                   qVar"state")),
               (Call
                  ("CMPSS",CTy"SSE",
                   Var("v5",PTy(CTy"sse_compare",PTy(FTy 3,CTy"xmm_mem")))),
                Apply
                  (Call
                     ("dfn'CMPSS",ATy(qTy,qTy),
                      Var("v5",
                          PTy(CTy"sse_compare",PTy(FTy 3,CTy"xmm_mem")))),
                   qVar"state")),
               (Call("COMISD",CTy"SSE",Var("v6",PTy(FTy 3,CTy"xmm_mem"))),
                Apply
                  (Call
                     ("dfn'COMISD",ATy(qTy,qTy),
                      Var("v6",PTy(FTy 3,CTy"xmm_mem"))),qVar"state")),
               (Call("COMISS",CTy"SSE",Var("v7",PTy(FTy 3,CTy"xmm_mem"))),
                Apply
                  (Call
                     ("dfn'COMISS",ATy(qTy,qTy),
                      Var("v7",PTy(FTy 3,CTy"xmm_mem"))),qVar"state")),
               (Call
                  ("CVTDQ2PD",CTy"SSE",Var("v8",PTy(FTy 3,CTy"xmm_mem"))),
                Apply
                  (Call
                     ("dfn'CVTDQ2PD",ATy(qTy,qTy),
                      Var("v8",PTy(FTy 3,CTy"xmm_mem"))),qVar"state")),
               (Call
                  ("CVTDQ2PS",CTy"SSE",Var("v9",PTy(FTy 3,CTy"xmm_mem"))),
                Apply
                  (Call
                     ("dfn'CVTDQ2PS",ATy(qTy,qTy),
                      Var("v9",PTy(FTy 3,CTy"xmm_mem"))),qVar"state")),
               (Call
                  ("CVTPD2DQ",CTy"SSE",
                   Var("v10",PTy(bTy,PTy(FTy 3,CTy"xmm_mem")))),
                Apply
                  (Call
                     ("dfn'CVTPD2DQ",ATy(qTy,qTy),
                      Var("v10",PTy(bTy,PTy(FTy 3,CTy"xmm_mem")))),
                   qVar"state")),
               (Call
                  ("CVTPD2PS",CTy"SSE",Var("v11",PTy(FTy 3,CTy"xmm_mem"))),
                Apply
                  (Call
                     ("dfn'CVTPD2PS",ATy(qTy,qTy),
                      Var("v11",PTy(FTy 3,CTy"xmm_mem"))),qVar"state")),
               (Call
                  ("CVTPS2DQ",CTy"SSE",
                   Var("v12",PTy(bTy,PTy(FTy 3,CTy"xmm_mem")))),
                Apply
                  (Call
                     ("dfn'CVTPS2DQ",ATy(qTy,qTy),
                      Var("v12",PTy(bTy,PTy(FTy 3,CTy"xmm_mem")))),
                   qVar"state")),
               (Call
                  ("CVTPS2PD",CTy"SSE",Var("v13",PTy(FTy 3,CTy"xmm_mem"))),
                Apply
                  (Call
                     ("dfn'CVTPS2PD",ATy(qTy,qTy),
                      Var("v13",PTy(FTy 3,CTy"xmm_mem"))),qVar"state")),
               (Call
                  ("CVTSD2SI",CTy"SSE",
                   Var("v14",PTy(bTy,PTy(bTy,PTy(CTy"Zreg",CTy"xmm_mem"))))),
                Apply
                  (Call
                     ("dfn'CVTSD2SI",ATy(qTy,qTy),
                      Var("v14",
                          PTy(bTy,PTy(bTy,PTy(CTy"Zreg",CTy"xmm_mem"))))),
                   qVar"state")),
               (Call
                  ("CVTSD2SS",CTy"SSE",Var("v15",PTy(FTy 3,CTy"xmm_mem"))),
                Apply
                  (Call
                     ("dfn'CVTSD2SS",ATy(qTy,qTy),
                      Var("v15",PTy(FTy 3,CTy"xmm_mem"))),qVar"state")),
               (Call
                  ("CVTSI2SD",CTy"SSE",
                   Var("v16",PTy(bTy,PTy(FTy 3,CTy"Zrm")))),
                Apply
                  (Call
                     ("dfn'CVTSI2SD",ATy(qTy,qTy),
                      Var("v16",PTy(bTy,PTy(FTy 3,CTy"Zrm")))),qVar"state")),
               (Call
                  ("CVTSI2SS",CTy"SSE",
                   Var("v17",PTy(bTy,PTy(FTy 3,CTy"Zrm")))),
                Apply
                  (Call
                     ("dfn'CVTSI2SS",ATy(qTy,qTy),
                      Var("v17",PTy(bTy,PTy(FTy 3,CTy"Zrm")))),qVar"state")),
               (Call
                  ("CVTSS2SD",CTy"SSE",Var("v18",PTy(FTy 3,CTy"xmm_mem"))),
                Apply
                  (Call
                     ("dfn'CVTSS2SD",ATy(qTy,qTy),
                      Var("v18",PTy(FTy 3,CTy"xmm_mem"))),qVar"state")),
               (Call
                  ("CVTSS2SI",CTy"SSE",
                   Var("v19",PTy(bTy,PTy(bTy,PTy(CTy"Zreg",CTy"xmm_mem"))))),
                Apply
                  (Call
                     ("dfn'CVTSS2SI",ATy(qTy,qTy),
                      Var("v19",
                          PTy(bTy,PTy(bTy,PTy(CTy"Zreg",CTy"xmm_mem"))))),
                   qVar"state")),
               (Call
                  ("MOVAP_D_S",CTy"SSE",
                   Var("v20",PTy(bTy,PTy(CTy"xmm_mem",CTy"xmm_mem")))),
                Apply
                  (Call
                     ("dfn'MOVAP_D_S",ATy(qTy,qTy),
                      Var("v20",PTy(bTy,PTy(CTy"xmm_mem",CTy"xmm_mem")))),
                   qVar"state")),
               (Call
                  ("MOVQ",CTy"SSE",
                   Var("v21",PTy(CTy"xmm_mem",CTy"xmm_mem"))),
                Apply
                  (Call
                     ("dfn'MOVQ",ATy(qTy,qTy),
                      Var("v21",PTy(CTy"xmm_mem",CTy"xmm_mem"))),
                   qVar"state")),
               (Call
                  ("MOVSD",CTy"SSE",
                   Var("v22",PTy(CTy"xmm_mem",CTy"xmm_mem"))),
                Apply
                  (Call
                     ("dfn'MOVSD",ATy(qTy,qTy),
                      Var("v22",PTy(CTy"xmm_mem",CTy"xmm_mem"))),
                   qVar"state")),
               (Call
                  ("MOVSS",CTy"SSE",
                   Var("v23",PTy(CTy"xmm_mem",CTy"xmm_mem"))),
                Apply
                  (Call
                     ("dfn'MOVSS",ATy(qTy,qTy),
                      Var("v23",PTy(CTy"xmm_mem",CTy"xmm_mem"))),
                   qVar"state")),
               (Call
                  ("MOVUP_D_S",CTy"SSE",
                   Var("v24",PTy(bTy,PTy(CTy"xmm_mem",CTy"xmm_mem")))),
                Apply
                  (Call
                     ("dfn'MOVUP_D_S",ATy(qTy,qTy),
                      Var("v24",PTy(bTy,PTy(CTy"xmm_mem",CTy"xmm_mem")))),
                   qVar"state")),
               (Call
                  ("MOV_D_Q",CTy"SSE",
                   Var("v25",PTy(bTy,PTy(bTy,PTy(FTy 3,CTy"Zrm"))))),
                Apply
                  (Call
                     ("dfn'MOV_D_Q",ATy(qTy,qTy),
                      Var("v25",PTy(bTy,PTy(bTy,PTy(FTy 3,CTy"Zrm"))))),
                   qVar"state")),
               (Call
                  ("PCMPEQQ",CTy"SSE",Var("v26",PTy(FTy 3,CTy"xmm_mem"))),
                Apply
                  (Call
                     ("dfn'PCMPEQQ",ATy(qTy,qTy),
                      Var("v26",PTy(FTy 3,CTy"xmm_mem"))),qVar"state")),
               (Call("PSLLDQ",CTy"SSE",Var("v27",PTy(FTy 3,F8))),
                Apply
                  (Call
                     ("dfn'PSLLDQ",ATy(qTy,qTy),Var("v27",PTy(FTy 3,F8))),
                   qVar"state")),
               (Call("PSLLD_imm",CTy"SSE",Var("v28",PTy(FTy 3,F8))),
                Apply
                  (Call
                     ("dfn'PSLLD_imm",ATy(qTy,qTy),
                      Var("v28",PTy(FTy 3,F8))),qVar"state")),
               (Call("PSLLQ_imm",CTy"SSE",Var("v29",PTy(FTy 3,F8))),
                Apply
                  (Call
                     ("dfn'PSLLQ_imm",ATy(qTy,qTy),
                      Var("v29",PTy(FTy 3,F8))),qVar"state")),
               (Call("PSLLW_imm",CTy"SSE",Var("v30",PTy(FTy 3,F8))),
                Apply
                  (Call
                     ("dfn'PSLLW_imm",ATy(qTy,qTy),
                      Var("v30",PTy(FTy 3,F8))),qVar"state")),
               (Call("PSRAD_imm",CTy"SSE",Var("v31",PTy(FTy 3,F8))),
                Apply
                  (Call
                     ("dfn'PSRAD_imm",ATy(qTy,qTy),
                      Var("v31",PTy(FTy 3,F8))),qVar"state")),
               (Call("PSRAW_imm",CTy"SSE",Var("v32",PTy(FTy 3,F8))),
                Apply
                  (Call
                     ("dfn'PSRAW_imm",ATy(qTy,qTy),
                      Var("v32",PTy(FTy 3,F8))),qVar"state")),
               (Call("PSRLDQ",CTy"SSE",Var("v33",PTy(FTy 3,F8))),
                Apply
                  (Call
                     ("dfn'PSRLDQ",ATy(qTy,qTy),Var("v33",PTy(FTy 3,F8))),
                   qVar"state")),
               (Call("PSRLD_imm",CTy"SSE",Var("v34",PTy(FTy 3,F8))),
                Apply
                  (Call
                     ("dfn'PSRLD_imm",ATy(qTy,qTy),
                      Var("v34",PTy(FTy 3,F8))),qVar"state")),
               (Call("PSRLQ_imm",CTy"SSE",Var("v35",PTy(FTy 3,F8))),
                Apply
                  (Call
                     ("dfn'PSRLQ_imm",ATy(qTy,qTy),
                      Var("v35",PTy(FTy 3,F8))),qVar"state")),
               (Call("PSRLW_imm",CTy"SSE",Var("v36",PTy(FTy 3,F8))),
                Apply
                  (Call
                     ("dfn'PSRLW_imm",ATy(qTy,qTy),
                      Var("v36",PTy(FTy 3,F8))),qVar"state")),
               (Call("SQRTPD",CTy"SSE",Var("v37",PTy(FTy 3,CTy"xmm_mem"))),
                Apply
                  (Call
                     ("dfn'SQRTPD",ATy(qTy,qTy),
                      Var("v37",PTy(FTy 3,CTy"xmm_mem"))),qVar"state")),
               (Call("SQRTPS",CTy"SSE",Var("v38",PTy(FTy 3,CTy"xmm_mem"))),
                Apply
                  (Call
                     ("dfn'SQRTPS",ATy(qTy,qTy),
                      Var("v38",PTy(FTy 3,CTy"xmm_mem"))),qVar"state")),
               (Call("SQRTSD",CTy"SSE",Var("v39",PTy(FTy 3,CTy"xmm_mem"))),
                Apply
                  (Call
                     ("dfn'SQRTSD",ATy(qTy,qTy),
                      Var("v39",PTy(FTy 3,CTy"xmm_mem"))),qVar"state")),
               (Call("SQRTSS",CTy"SSE",Var("v40",PTy(FTy 3,CTy"xmm_mem"))),
                Apply
                  (Call
                     ("dfn'SQRTSS",ATy(qTy,qTy),
                      Var("v40",PTy(FTy 3,CTy"xmm_mem"))),qVar"state")),
               (Call
                  ("bin_PD",CTy"SSE",
                   Var("v41",PTy(CTy"sse_binop",PTy(FTy 3,CTy"xmm_mem")))),
                Apply
                  (Call
                     ("dfn'bin_PD",ATy(qTy,qTy),
                      Var("v41",
                          PTy(CTy"sse_binop",PTy(FTy 3,CTy"xmm_mem")))),
                   qVar"state")),
               (Call
                  ("bin_PS",CTy"SSE",
                   Var("v42",PTy(CTy"sse_binop",PTy(FTy 3,CTy"xmm_mem")))),
                Apply
                  (Call
                     ("dfn'bin_PS",ATy(qTy,qTy),
                      Var("v42",
                          PTy(CTy"sse_binop",PTy(FTy 3,CTy"xmm_mem")))),
                   qVar"state")),
               (Call
                  ("bin_SD",CTy"SSE",
                   Var("v43",PTy(CTy"sse_binop",PTy(FTy 3,CTy"xmm_mem")))),
                Apply
                  (Call
                     ("dfn'bin_SD",ATy(qTy,qTy),
                      Var("v43",
                          PTy(CTy"sse_binop",PTy(FTy 3,CTy"xmm_mem")))),
                   qVar"state")),
               (Call
                  ("bin_SS",CTy"SSE",
                   Var("v44",PTy(CTy"sse_binop",PTy(FTy 3,CTy"xmm_mem")))),
                Apply
                  (Call
                     ("dfn'bin_SS",ATy(qTy,qTy),
                      Var("v44",
                          PTy(CTy"sse_binop",PTy(FTy 3,CTy"xmm_mem")))),
                   qVar"state")),
               (Call
                  ("logic_PD",CTy"SSE",
                   Var("v45",PTy(CTy"sse_logic",PTy(FTy 3,CTy"xmm_mem")))),
                Apply
                  (Call
                     ("dfn'logic_PD",ATy(qTy,qTy),
                      Var("v45",
                          PTy(CTy"sse_logic",PTy(FTy 3,CTy"xmm_mem")))),
                   qVar"state")),
               (Call
                  ("logic_PS",CTy"SSE",
                   Var("v46",PTy(CTy"sse_logic",PTy(FTy 3,CTy"xmm_mem")))),
                Apply
                  (Call
                     ("dfn'logic_PS",ATy(qTy,qTy),
                      Var("v46",
                          PTy(CTy"sse_logic",PTy(FTy 3,CTy"xmm_mem")))),
                   qVar"state"))]))])))
;
val oimmediate8_def = Def
  ("oimmediate8",Var("strm",OTy(LTy F8)),
   CS(Var("strm",OTy(LTy F8)),
      [(Mop(Some,LLC([Var("b",F8)],Var("t",LTy F8))),
        TP[Mop(SE F64,Var("b",F8)),Mop(Some,Var("t",LTy F8))]),
       (AVar(OTy(LTy F8)),TP[LX F64,LO(LTy F8)])]))
;
val immediate8_def = Def
  ("immediate8",Var("strm",LTy F8),
   Call("oimmediate8",PTy(F64,OTy(LTy F8)),Mop(Some,Var("strm",LTy F8))))
;
val immediate16_def = Def
  ("immediate16",Var("strm",LTy F8),
   CS(Var("strm",LTy F8),
      [(LLC([Var("b1",F8),Var("b2",F8)],Var("t",LTy F8)),
        TP[Mop(SE F64,CC[Var("b2",F8),Var("b1",F8)]),
           Mop(Some,Var("t",LTy F8))]),
       (AVar(LTy F8),TP[LX F64,LO(LTy F8)])]))
;
val immediate32_def = Def
  ("immediate32",Var("strm",LTy F8),
   CS(Var("strm",LTy F8),
      [(LLC([Var("b1",F8),Var("b2",F8),Var("b3",F8),Var("b4",F8)],
            Var("t",LTy F8)),
        TP[Mop(SE F64,
               CC[Var("b4",F8),Var("b3",F8),Var("b2",F8),Var("b1",F8)]),
           Mop(Some,Var("t",LTy F8))]),
       (AVar(LTy F8),TP[LX F64,LO(LTy F8)])]))
;
val immediate64_def = Def
  ("immediate64",Var("strm",LTy F8),
   CS(Var("strm",LTy F8),
      [(LLC([Var("b1",F8),Var("b2",F8),Var("b3",F8),Var("b4",F8),
             Var("b5",F8),Var("b6",F8),Var("b7",F8),Var("b8",F8)],
            Var("t",LTy F8)),
        TP[CC[Var("b8",F8),Var("b7",F8),Var("b6",F8),Var("b5",F8),
              Var("b4",F8),Var("b3",F8),Var("b2",F8),Var("b1",F8)],
           Mop(Some,Var("t",LTy F8))]),
       (AVar(LTy F8),TP[LX F64,LO(LTy F8)])]))
;
val immediate_def = Def
  ("immediate",TP[Var("size",CTy"Zsize"),Var("strm",LTy F8)],
   CS(Var("size",CTy"Zsize"),
      [(Call("Z8",CTy"Zsize",AVar bTy),
        Call("immediate8",PTy(F64,OTy(LTy F8)),Var("strm",LTy F8))),
       (Const("Z16",CTy"Zsize"),
        Call("immediate16",PTy(F64,OTy(LTy F8)),Var("strm",LTy F8))),
       (AVar(CTy"Zsize"),
        Call("immediate32",PTy(F64,OTy(LTy F8)),Var("strm",LTy F8)))]))
;
val oimmediate_def = Def
  ("oimmediate",TP[Var("size",CTy"Zsize"),Var("strm",OTy(LTy F8))],
   CS(Var("strm",OTy(LTy F8)),
      [(Mop(Some,Var("s",LTy F8)),
        Call
          ("immediate",PTy(F64,OTy(LTy F8)),
           TP[Var("size",CTy"Zsize"),Var("s",LTy F8)])),
       (LO(LTy F8),TP[LX F64,LO(LTy F8)])]))
;
val full_immediate_def = Def
  ("full_immediate",TP[Var("size",CTy"Zsize"),Var("strm",LTy F8)],
   ITE(EQ(Var("size",CTy"Zsize"),Const("Z64",CTy"Zsize")),
       Call("immediate64",PTy(F64,OTy(LTy F8)),Var("strm",LTy F8)),
       Call
         ("immediate",PTy(F64,OTy(LTy F8)),
          TP[Var("size",CTy"Zsize"),Var("strm",LTy F8)])))
;
val rec'REX_def = Def
  ("rec'REX",Var("x",F4),
   Rec(CTy"REX",
       [Bop(Bit,Var("x",F4),LN 0),Bop(Bit,Var("x",F4),LN 2),
        Bop(Bit,Var("x",F4),LN 3),Bop(Bit,Var("x",F4),LN 1)]))
;
val reg'REX_def = Def
  ("reg'REX",Var("x",CTy"REX"),
   CS(Var("x",CTy"REX"),
      [(Rec(CTy"REX",[bVar"B",bVar"R",bVar"W",bVar"X"]),
        CC[Mop(Cast F1,bVar"W"),Mop(Cast F1,bVar"R"),Mop(Cast F1,bVar"X"),
           Mop(Cast F1,bVar"B")])]))
;
val write'rec'REX_def = Def
  ("write'rec'REX",TP[AVar F4,Var("x",CTy"REX")],
   Call("reg'REX",F4,Var("x",CTy"REX")))
;
val write'reg'REX_def = Def
  ("write'reg'REX",TP[AVar(CTy"REX"),Var("x",F4)],
   Call("rec'REX",CTy"REX",Var("x",F4)))
;
val RexReg_def = Def
  ("RexReg",TP[bVar"b",Var("r",FTy 3)],
   Mop(Cast(CTy"Zreg"),CC[Mop(Cast F1,bVar"b"),Var("r",FTy 3)]))
;
val readDisplacement_def = Def
  ("readDisplacement",TP[Var("Mod",FTy 2),Var("strm",LTy F8)],
   ITB([(EQ(Var("Mod",FTy 2),LW(1,2)),
         Call("immediate8",PTy(F64,OTy(LTy F8)),Var("strm",LTy F8))),
        (EQ(Var("Mod",FTy 2),LW(2,2)),
         Call("immediate32",PTy(F64,OTy(LTy F8)),Var("strm",LTy F8)))],
       TP[LW(0,64),Mop(Some,Var("strm",LTy F8))]))
;
val readSibDisplacement_def = Def
  ("readSibDisplacement",TP[Var("Mod",FTy 2),Var("strm",LTy F8)],
   ITE(EQ(Var("Mod",FTy 2),LW(1,2)),
       Call("immediate8",PTy(F64,OTy(LTy F8)),Var("strm",LTy F8)),
       Call("immediate32",PTy(F64,OTy(LTy F8)),Var("strm",LTy F8))))
;
val readSIB_def = Def
  ("readSIB",TP[Var("REX",CTy"REX"),Var("Mod",FTy 2),Var("strm",LTy F8)],
   CS(Var("strm",LTy F8),
      [(LLC([Var("v#0",F8)],Var("v#1",LTy F8)),
        CS(TP[BL(8,Var("v#0",F8)),Var("v#1",LTy F8)],
           [(TP[TP[bVar"SS'1",bVar"SS'0",bVar"Index'2",bVar"Index'1",
                   bVar"Index'0",bVar"Base'2",bVar"Base'1",bVar"Base'0"],
                Var("strm1",LTy F8)],
             Let(Var("base",CTy"Zreg"),
                 Call
                   ("RexReg",CTy"Zreg",
                    TP[Dest("B",bTy,Var("REX",CTy"REX")),
                       Mop(Cast(FTy 3),
                           LL[bVar"Base'2",bVar"Base'1",bVar"Base'0"])]),
                 Let(Var("index",CTy"Zreg"),
                     Call
                       ("RexReg",CTy"Zreg",
                        TP[Dest("X",bTy,Var("REX",CTy"REX")),
                           Mop(Cast(FTy 3),
                               LL[bVar"Index'2",bVar"Index'1",
                                  bVar"Index'0"])]),
                     Let(Var("scaled_index",OTy(PTy(FTy 2,CTy"Zreg"))),
                         ITE(EQ(Var("index",CTy"Zreg"),LC("RSP",CTy"Zreg")),
                             LO(PTy(FTy 2,CTy"Zreg")),
                             Mop(Some,
                                 TP[Mop(Cast(FTy 2),
                                        LL[bVar"SS'1",bVar"SS'0"]),
                                    Var("index",CTy"Zreg")])),
                         ITE(EQ(Var("base",CTy"Zreg"),LC("RBP",CTy"Zreg")),
                             Let(TP[Var("displacement",F64),
                                    Var("strm2",OTy(LTy F8))],
                                 Call
                                   ("readSibDisplacement",
                                    PTy(F64,OTy(LTy F8)),
                                    TP[Var("Mod",FTy 2),
                                       Var("strm1",LTy F8)]),
                                 TP[Call
                                      ("Zm",CTy"Zrm",
                                       TP[Var("scaled_index",
                                              OTy(PTy(FTy 2,CTy"Zreg"))),
                                          ITE(EQ(Var("Mod",FTy 2),LW(0,2)),
                                              Const("ZnoBase",CTy"Zbase"),
                                              Call
                                                ("ZregBase",CTy"Zbase",
                                                 Var("base",CTy"Zreg"))),
                                          Var("displacement",F64)]),
                                    Var("strm2",OTy(LTy F8))]),
                             Let(TP[Var("displacement",F64),
                                    Var("strm2",OTy(LTy F8))],
                                 Call
                                   ("readDisplacement",
                                    PTy(F64,OTy(LTy F8)),
                                    TP[Var("Mod",FTy 2),
                                       Var("strm1",LTy F8)]),
                                 TP[Call
                                      ("Zm",CTy"Zrm",
                                       TP[Var("scaled_index",
                                              OTy(PTy(FTy 2,CTy"Zreg"))),
                                          Call
                                            ("ZregBase",CTy"Zbase",
                                             Var("base",CTy"Zreg")),
                                          Var("displacement",F64)]),
                                    Var("strm2",OTy(LTy F8))]))))))])),
       (AVar(LTy F8),TP[LX(CTy"Zrm"),LO(LTy F8)])]))
;
val readModRM_def = Def
  ("readModRM",TP[Var("REX",CTy"REX"),Var("strm",LTy F8)],
   CS(Var("strm",LTy F8),
      [(LLC([Var("v#0",F8)],Var("v#1",LTy F8)),
        CS(TP[BL(8,Var("v#0",F8)),Var("v#1",LTy F8)],
           [(TP[TP[LF,LF,bVar"RegOpc'2",bVar"RegOpc'1",bVar"RegOpc'0",LT,
                   LF,LT],Var("strm1",LTy F8)],
             Let(TP[Var("displacement",F64),Var("strm2",OTy(LTy F8))],
                 Call
                   ("immediate32",PTy(F64,OTy(LTy F8)),Var("strm1",LTy F8)),
                 TP[Call
                      ("RexReg",CTy"Zreg",
                       TP[Dest("R",bTy,Var("REX",CTy"REX")),
                          Mop(Cast(FTy 3),
                              LL[bVar"RegOpc'2",bVar"RegOpc'1",
                                 bVar"RegOpc'0"])]),
                    Call
                      ("Zm",CTy"Zrm",
                       TP[LO(PTy(FTy 2,CTy"Zreg")),
                          Const("ZripBase",CTy"Zbase"),
                          Var("displacement",F64)]),
                    Var("strm2",OTy(LTy F8))])),
            (TP[TP[LT,LT,bVar"REG'2",bVar"REG'1",bVar"REG'0",bVar"RM'2",
                   bVar"RM'1",bVar"RM'0"],Var("strm1",LTy F8)],
             TP[Call
                  ("RexReg",CTy"Zreg",
                   TP[Dest("R",bTy,Var("REX",CTy"REX")),
                      Mop(Cast(FTy 3),
                          LL[bVar"REG'2",bVar"REG'1",bVar"REG'0"])]),
                Call
                  ("Zr",CTy"Zrm",
                   Call
                     ("RexReg",CTy"Zreg",
                      TP[Dest("B",bTy,Var("REX",CTy"REX")),
                         Mop(Cast(FTy 3),
                             LL[bVar"RM'2",bVar"RM'1",bVar"RM'0"])])),
                Mop(Some,Var("strm1",LTy F8))]),
            (TP[TP[bVar"Mod'1",bVar"Mod'0",bVar"RegOpc'2",bVar"RegOpc'1",
                   bVar"RegOpc'0",LT,LF,LF],Var("strm1",LTy F8)],
             Let(TP[Var("sib",CTy"Zrm"),Var("strm2",OTy(LTy F8))],
                 Call
                   ("readSIB",PTy(CTy"Zrm",OTy(LTy F8)),
                    TP[Var("REX",CTy"REX"),
                       Mop(Cast(FTy 2),LL[bVar"Mod'1",bVar"Mod'0"]),
                       Var("strm1",LTy F8)]),
                 TP[Call
                      ("RexReg",CTy"Zreg",
                       TP[Dest("R",bTy,Var("REX",CTy"REX")),
                          Mop(Cast(FTy 3),
                              LL[bVar"RegOpc'2",bVar"RegOpc'1",
                                 bVar"RegOpc'0"])]),Var("sib",CTy"Zrm"),
                    Var("strm2",OTy(LTy F8))])),
            (TP[TP[bVar"Mod'1",bVar"Mod'0",bVar"RegOpc'2",bVar"RegOpc'1",
                   bVar"RegOpc'0",bVar"RM'2",bVar"RM'1",bVar"RM'0"],
                Var("strm1",LTy F8)],
             Let(TP[Var("displacement",F64),Var("strm2",OTy(LTy F8))],
                 Call
                   ("readDisplacement",PTy(F64,OTy(LTy F8)),
                    TP[Mop(Cast(FTy 2),LL[bVar"Mod'1",bVar"Mod'0"]),
                       Var("strm1",LTy F8)]),
                 TP[Call
                      ("RexReg",CTy"Zreg",
                       TP[Dest("R",bTy,Var("REX",CTy"REX")),
                          Mop(Cast(FTy 3),
                              LL[bVar"RegOpc'2",bVar"RegOpc'1",
                                 bVar"RegOpc'0"])]),
                    Call
                      ("Zm",CTy"Zrm",
                       TP[LO(PTy(FTy 2,CTy"Zreg")),
                          Call
                            ("ZregBase",CTy"Zbase",
                             Call
                               ("RexReg",CTy"Zreg",
                                TP[Dest("B",bTy,Var("REX",CTy"REX")),
                                   Mop(Cast(FTy 3),
                                       LL[bVar"RM'2",bVar"RM'1",bVar"RM'0"])])),
                          Var("displacement",F64)]),
                    Var("strm2",OTy(LTy F8))]))])),
       (AVar(LTy F8),TP[LX(CTy"Zreg"),LX(CTy"Zrm"),LO(LTy F8)])]))
;
val readOpcodeModRM_def = Def
  ("readOpcodeModRM",TP[Var("REX",CTy"REX"),Var("strm",LTy F8)],
   Let(TP[Var("opcode",CTy"Zreg"),Var("rm",CTy"Zrm"),
          Var("strm1",OTy(LTy F8))],
       Call
         ("readModRM",PTy(CTy"Zreg",PTy(CTy"Zrm",OTy(LTy F8))),
          TP[Var("REX",CTy"REX"),Var("strm",LTy F8)]),
       TP[Mop(Cast(FTy 3),
              Bop(Mod,Mop(Cast nTy,Var("opcode",CTy"Zreg")),LN 8)),
          Var("rm",CTy"Zrm"),Var("strm1",OTy(LTy F8))]))
;
val prefixGroup_def = Def
  ("prefixGroup",Var("b",F8),
   CS(Var("b",F8),
      [(LW(240,8),LN 1),(LW(242,8),LN 1),(LW(243,8),LN 1),(LW(38,8),LN 2),
       (LW(46,8),LN 2),(LW(54,8),LN 2),(LW(62,8),LN 2),(LW(100,8),LN 2),
       (LW(101,8),LN 2),(LW(102,8),LN 3),(LW(103,8),LN 4),
       (AVar F8,ITE(EQ(EX(Var("b",F8),LN 7,LN 4,F4),LW(4,4)),LN 5,LN 0))]))
;
val readPrefix_def = Def
  ("readPrefix",TP[Var("s",STy nTy),Var("p",LTy F8),Var("strm",LTy F8)],
   CS(Var("strm",LTy F8),
      [(LLC([Var("h",F8)],Var("strm1",LTy F8)),
        Let(nVar"group",Call("prefixGroup",nTy,Var("h",F8)),
            ITB([(EQ(nVar"group",LN 0),
                  Mop(Some,
                      TP[Var("p",LTy F8),LF,
                         Call("rec'REX",CTy"REX",LW(0,4)),
                         Var("strm",LTy F8)])),
                 (EQ(nVar"group",LN 5),
                  Mop(Some,
                      TP[Var("p",LTy F8),LT,
                         Call
                           ("rec'REX",CTy"REX",
                            EX(Var("h",F8),LN 3,LN 0,F4)),
                         Var("strm1",LTy F8)])),
                 (Bop(In,nVar"group",Var("s",STy nTy)),
                  LO(PTy(LTy F8,PTy(bTy,PTy(CTy"REX",LTy F8)))))],
                Call
                  ("readPrefix",
                   OTy(PTy(LTy F8,PTy(bTy,PTy(CTy"REX",LTy F8)))),
                   TP[Bop(Insert,nVar"group",Var("s",STy nTy)),
                      LLC([Var("h",F8)],Var("p",LTy F8)),
                      Var("strm1",LTy F8)])))),
       (LNL F8,
        Mop(Some,TP[Var("p",LTy F8),LF,LX(CTy"REX"),Var("strm",LTy F8)]))]))
;
val readPrefixes_def = Def
  ("readPrefixes",Var("strm",LTy F8),
   Call
     ("readPrefix",OTy(PTy(LTy F8,PTy(bTy,PTy(CTy"REX",LTy F8)))),
      TP[LE nTy,LNL F8,Var("strm",LTy F8)]))
;
val OpSize_def = Def
  ("OpSize",TP[bVar"have_rex",bVar"w",Var("v",F1),bVar"override"],
   ITB([(EQ(Var("v",F1),LW(0,1)),Call("Z8",CTy"Zsize",bVar"have_rex")),
        (bVar"w",Const("Z64",CTy"Zsize")),
        (bVar"override",Const("Z16",CTy"Zsize"))],Const("Z32",CTy"Zsize")))
;
val isZm_def = Def
  ("isZm",Var("rm",CTy"Zrm"),
   CS(Var("rm",CTy"Zrm"),
      [(Call
          ("Zm",CTy"Zrm",
           AVar(PTy(OTy(PTy(FTy 2,CTy"Zreg")),PTy(CTy"Zbase",F64)))),LT),
       (AVar(CTy"Zrm"),LF)]))
;
val x64_decode_def = Def
  ("x64_decode",Var("strm",LTy F8),
   CS(Call
        ("readPrefixes",OTy(PTy(LTy F8,PTy(bTy,PTy(CTy"REX",LTy F8)))),
         Var("strm",LTy F8)),
      [(LO(PTy(LTy F8,PTy(bTy,PTy(CTy"REX",LTy F8)))),
        Call("Zdec_fail",CTy"Zinst",LS"Bad prefix")),
       (Mop(Some,
            TP[Var("p",LTy F8),bVar"have_rex",Var("REX",CTy"REX"),
               Var("strm1",LTy F8)]),
        Let(Var("prefixes",STy F8),Mop(SofL,Var("p",LTy F8)),
            Let(bVar"op_size_override",
                Bop(In,LW(102,8),Var("prefixes",STy F8)),
                ITE(Bop(In,LW(103,8),Var("prefixes",STy F8)),
                    Call
                      ("Zdec_fail",CTy"Zinst",
                       LS"address override prefix not supported"),
                    CS(Var("strm1",LTy F8),
                       [(LLC([Var("v#0",F8)],Var("v#1",LTy F8)),
                         CS(TP[BL(8,Var("v#0",F8)),Var("v#1",LTy F8)],
                            [(TP[TP[LF,LF,bVar"opc'2",bVar"opc'1",
                                    bVar"opc'0",LF,bVar"x'0",bVar"v'0"],
                                 Var("strm2",LTy F8)],
                              Let(TP[Var("reg",CTy"Zreg"),
                                     Var("rm",CTy"Zrm"),
                                     Var("strm3",OTy(LTy F8))],
                                  Call
                                    ("readModRM",
                                     PTy(CTy"Zreg",
                                         PTy(CTy"Zrm",OTy(LTy F8))),
                                     TP[Var("REX",CTy"REX"),
                                        Var("strm2",LTy F8)]),
                                  Call
                                    ("Zfull_inst",CTy"Zinst",
                                     TP[Var("p",LTy F8),
                                        Call
                                          ("Zbinop",CTy"instruction",
                                           TP[Mop(Cast(CTy"Zbinop_name"),
                                                  Mop(Cast(FTy 3),
                                                      LL[bVar"opc'2",
                                                         bVar"opc'1",
                                                         bVar"opc'0"])),
                                              Call
                                                ("OpSize",CTy"Zsize",
                                                 TP[bVar"have_rex",
                                                    Dest
                                                      ("W",bTy,
                                                       Var("REX",CTy"REX")),
                                                    Mop(Cast F1,
                                                        LL[bVar"v'0"]),
                                                    bVar"op_size_override"]),
                                              ITE(EQ(Mop(Cast F1,
                                                         LL[bVar"x'0"]),
                                                     LW(0,1)),
                                                  Call
                                                    ("Zrm_r",
                                                     CTy"Zdest_src",
                                                     TP[Var("rm",CTy"Zrm"),
                                                        Var("reg",
                                                            CTy"Zreg")]),
                                                  Call
                                                    ("Zr_rm",
                                                     CTy"Zdest_src",
                                                     TP[Var("reg",
                                                            CTy"Zreg"),
                                                        Var("rm",CTy"Zrm")]))]),
                                        Var("strm3",OTy(LTy F8))]))),
                             (TP[TP[LF,LF,bVar"opc'2",bVar"opc'1",
                                    bVar"opc'0",LT,LF,bVar"v'0"],
                                 Var("strm2",LTy F8)],
                              Let(Var("size",CTy"Zsize"),
                                  Call
                                    ("OpSize",CTy"Zsize",
                                     TP[bVar"have_rex",
                                        Dest("W",bTy,Var("REX",CTy"REX")),
                                        Mop(Cast F1,LL[bVar"v'0"]),
                                        bVar"op_size_override"]),
                                  Let(TP[Var("imm",F64),
                                         Var("strm3",OTy(LTy F8))],
                                      Call
                                        ("immediate",PTy(F64,OTy(LTy F8)),
                                         TP[Var("size",CTy"Zsize"),
                                            Var("strm2",LTy F8)]),
                                      Call
                                        ("Zfull_inst",CTy"Zinst",
                                         TP[Var("p",LTy F8),
                                            Call
                                              ("Zbinop",CTy"instruction",
                                               TP[Mop(Cast
                                                        (CTy"Zbinop_name"),
                                                      Mop(Cast(FTy 3),
                                                          LL[bVar"opc'2",
                                                             bVar"opc'1",
                                                             bVar"opc'0"])),
                                                  Var("size",CTy"Zsize"),
                                                  Call
                                                    ("Zrm_i",
                                                     CTy"Zdest_src",
                                                     TP[Call
                                                          ("Zr",CTy"Zrm",
                                                           LC("RAX",
                                                              CTy"Zreg")),
                                                        Var("imm",F64)])]),
                                            Var("strm3",OTy(LTy F8))])))),
                             (TP[TP[LF,LT,LF,LT,bVar"b'0",bVar"r'2",
                                    bVar"r'1",bVar"r'0"],
                                 Var("strm2",LTy F8)],
                              Let(Var("reg",CTy"Zrm"),
                                  Call
                                    ("Zr",CTy"Zrm",
                                     Mop(Cast(CTy"Zreg"),
                                         CC[Mop(Cast F1,
                                                Dest
                                                  ("B",bTy,
                                                   Var("REX",CTy"REX"))),
                                            Mop(Cast(FTy 3),
                                                LL[bVar"r'2",bVar"r'1",
                                                   bVar"r'0"])])),
                                  Call
                                    ("Zfull_inst",CTy"Zinst",
                                     TP[Var("p",LTy F8),
                                        ITE(EQ(Mop(Cast F1,LL[bVar"b'0"]),
                                               LW(0,1)),
                                            Call
                                              ("Zpush",CTy"instruction",
                                               Call
                                                 ("Zrm",CTy"Zimm_rm",
                                                  Var("reg",CTy"Zrm"))),
                                            Call
                                              ("Zpop",CTy"instruction",
                                               Var("reg",CTy"Zrm"))),
                                        Mop(Some,Var("strm2",LTy F8))]))),
                             (TP[TP[LF,LT,LT,LF,LF,LF,LT,LT],
                                 Var("strm2",LTy F8)],
                              Let(TP[Var("reg",CTy"Zreg"),
                                     Var("rm",CTy"Zrm"),
                                     Var("strm3",OTy(LTy F8))],
                                  Call
                                    ("readModRM",
                                     PTy(CTy"Zreg",
                                         PTy(CTy"Zrm",OTy(LTy F8))),
                                     TP[Var("REX",CTy"REX"),
                                        Var("strm2",LTy F8)]),
                                  Call
                                    ("Zfull_inst",CTy"Zinst",
                                     TP[Var("p",LTy F8),
                                        Call
                                          ("Zmovsx",CTy"instruction",
                                           TP[Const("Z32",CTy"Zsize"),
                                              Call
                                                ("Zr_rm",CTy"Zdest_src",
                                                 TP[Var("reg",CTy"Zreg"),
                                                    Var("rm",CTy"Zrm")]),
                                              Const("Z64",CTy"Zsize")]),
                                        Var("strm3",OTy(LTy F8))]))),
                             (TP[TP[LF,LT,LT,LF,LT,LF,bVar"b'0",LF],
                                 Var("strm2",LTy F8)],
                              Let(TP[Var("imm",F64),
                                     Var("strm3",OTy(LTy F8))],
                                  ITE(EQ(Mop(Cast F1,LL[bVar"b'0"]),
                                         LW(1,1)),
                                      Call
                                        ("immediate8",
                                         PTy(F64,OTy(LTy F8)),
                                         Var("strm2",LTy F8)),
                                      Call
                                        ("immediate32",
                                         PTy(F64,OTy(LTy F8)),
                                         Var("strm2",LTy F8))),
                                  Call
                                    ("Zfull_inst",CTy"Zinst",
                                     TP[Var("p",LTy F8),
                                        Call
                                          ("Zpush",CTy"instruction",
                                           Call
                                             ("Zimm",CTy"Zimm_rm",
                                              Var("imm",F64))),
                                        Var("strm3",OTy(LTy F8))]))),
                             (TP[TP[LF,LT,LT,LF,LT,LF,bVar"b'0",LT],
                                 Var("strm2",LTy F8)],
                              Let(TP[Var("reg",CTy"Zreg"),
                                     Var("rm",CTy"Zrm"),
                                     Var("strm3",OTy(LTy F8))],
                                  Call
                                    ("readModRM",
                                     PTy(CTy"Zreg",
                                         PTy(CTy"Zrm",OTy(LTy F8))),
                                     TP[Var("REX",CTy"REX"),
                                        Var("strm2",LTy F8)]),
                                  CS(Var("strm3",OTy(LTy F8)),
                                     [(LO(LTy F8),
                                       Call
                                         ("Zdec_fail",CTy"Zinst",
                                          LS"not enough bytes")),
                                      (Mop(Some,Var("s",LTy F8)),
                                       Let(TP[Var("imm",F64),
                                              Var("strm4",OTy(LTy F8))],
                                           ITE(EQ(Mop(Cast F1,
                                                      LL[bVar"b'0"]),
                                                  LW(1,1)),
                                               Call
                                                 ("immediate8",
                                                  PTy(F64,OTy(LTy F8)),
                                                  Var("s",LTy F8)),
                                               Call
                                                 ("immediate32",
                                                  PTy(F64,OTy(LTy F8)),
                                                  Var("s",LTy F8))),
                                           Call
                                             ("Zfull_inst",CTy"Zinst",
                                              TP[Var("p",LTy F8),
                                                 Call
                                                   ("Zimul3",
                                                    CTy"instruction",
                                                    TP[Call
                                                         ("OpSize",
                                                          CTy"Zsize",
                                                          TP[bVar"have_rex",
                                                             Dest
                                                               ("W",bTy,
                                                                Var("REX",
                                                                    CTy"REX")),
                                                             LW(1,1),
                                                             bVar"op_size_override"]),
                                                       Var("reg",CTy"Zreg"),
                                                       Var("rm",CTy"Zrm"),
                                                       Var("imm",F64)]),
                                                 Var("strm4",OTy(LTy F8))])))]))),
                             (TP[TP[LF,LT,LT,LT,bVar"c'3",bVar"c'2",
                                    bVar"c'1",bVar"c'0"],
                                 Var("strm2",LTy F8)],
                              Let(TP[Var("imm",F64),
                                     Var("strm3",OTy(LTy F8))],
                                  Call
                                    ("immediate8",PTy(F64,OTy(LTy F8)),
                                     Var("strm2",LTy F8)),
                                  Call
                                    ("Zfull_inst",CTy"Zinst",
                                     TP[Var("p",LTy F8),
                                        Call
                                          ("Zjcc",CTy"instruction",
                                           TP[Mop(Cast(CTy"Zcond"),
                                                  Mop(Cast F4,
                                                      LL[bVar"c'3",
                                                         bVar"c'2",
                                                         bVar"c'1",
                                                         bVar"c'0"])),
                                              Var("imm",F64)]),
                                        Var("strm3",OTy(LTy F8))]))),
                             (TP[TP[LT,LF,LF,LF,LF,LF,LF,bVar"v'0"],
                                 Var("strm2",LTy F8)],
                              Let(Var("size",CTy"Zsize"),
                                  Call
                                    ("OpSize",CTy"Zsize",
                                     TP[bVar"have_rex",
                                        Dest("W",bTy,Var("REX",CTy"REX")),
                                        Mop(Cast F1,LL[bVar"v'0"]),
                                        bVar"op_size_override"]),
                                  Let(TP[Var("opcode",FTy 3),
                                         Var("rm",CTy"Zrm"),
                                         Var("strm3",OTy(LTy F8))],
                                      Call
                                        ("readOpcodeModRM",
                                         PTy(FTy 3,
                                             PTy(CTy"Zrm",OTy(LTy F8))),
                                         TP[Var("REX",CTy"REX"),
                                            Var("strm2",LTy F8)]),
                                      Let(TP[Var("imm",F64),
                                             Var("strm4",OTy(LTy F8))],
                                          Call
                                            ("oimmediate",
                                             PTy(F64,OTy(LTy F8)),
                                             TP[Var("size",CTy"Zsize"),
                                                Var("strm3",OTy(LTy F8))]),
                                          Call
                                            ("Zfull_inst",CTy"Zinst",
                                             TP[Var("p",LTy F8),
                                                Call
                                                  ("Zbinop",
                                                   CTy"instruction",
                                                   TP[Mop(Cast
                                                            (CTy"Zbinop_name"),
                                                          Var("opcode",
                                                              FTy 3)),
                                                      Var("size",
                                                          CTy"Zsize"),
                                                      Call
                                                        ("Zrm_i",
                                                         CTy"Zdest_src",
                                                         TP[Var("rm",
                                                                CTy"Zrm"),
                                                            Var("imm",F64)])]),
                                                Var("strm4",OTy(LTy F8))]))))),
                             (TP[TP[LT,LF,LF,LF,LF,LF,LT,LT],
                                 Var("strm2",LTy F8)],
                              Let(TP[Var("opcode",FTy 3),
                                     Var("rm",CTy"Zrm"),
                                     Var("strm3",OTy(LTy F8))],
                                  Call
                                    ("readOpcodeModRM",
                                     PTy(FTy 3,PTy(CTy"Zrm",OTy(LTy F8))),
                                     TP[Var("REX",CTy"REX"),
                                        Var("strm2",LTy F8)]),
                                  Let(TP[Var("imm",F64),
                                         Var("strm4",OTy(LTy F8))],
                                      Call
                                        ("oimmediate8",
                                         PTy(F64,OTy(LTy F8)),
                                         Var("strm3",OTy(LTy F8))),
                                      Call
                                        ("Zfull_inst",CTy"Zinst",
                                         TP[Var("p",LTy F8),
                                            Call
                                              ("Zbinop",CTy"instruction",
                                               TP[Mop(Cast
                                                        (CTy"Zbinop_name"),
                                                      Var("opcode",FTy 3)),
                                                  Call
                                                    ("OpSize",CTy"Zsize",
                                                     TP[LF,
                                                        Dest
                                                          ("W",bTy,
                                                           Var("REX",
                                                               CTy"REX")),
                                                        LW(1,1),
                                                        bVar"op_size_override"]),
                                                  Call
                                                    ("Zrm_i",
                                                     CTy"Zdest_src",
                                                     TP[Var("rm",CTy"Zrm"),
                                                        Var("imm",F64)])]),
                                            Var("strm4",OTy(LTy F8))])))),
                             (TP[TP[LT,LF,LF,LF,LF,LT,LF,bVar"v'0"],
                                 Var("strm2",LTy F8)],
                              Let(TP[Var("reg",CTy"Zreg"),
                                     Var("rm",CTy"Zrm"),
                                     Var("strm3",OTy(LTy F8))],
                                  Call
                                    ("readModRM",
                                     PTy(CTy"Zreg",
                                         PTy(CTy"Zrm",OTy(LTy F8))),
                                     TP[Var("REX",CTy"REX"),
                                        Var("strm2",LTy F8)]),
                                  Call
                                    ("Zfull_inst",CTy"Zinst",
                                     TP[Var("p",LTy F8),
                                        Call
                                          ("Zbinop",CTy"instruction",
                                           TP[LC("Ztest",CTy"Zbinop_name"),
                                              Call
                                                ("OpSize",CTy"Zsize",
                                                 TP[bVar"have_rex",
                                                    Dest
                                                      ("W",bTy,
                                                       Var("REX",CTy"REX")),
                                                    Mop(Cast F1,
                                                        LL[bVar"v'0"]),
                                                    bVar"op_size_override"]),
                                              Call
                                                ("Zrm_r",CTy"Zdest_src",
                                                 TP[Var("rm",CTy"Zrm"),
                                                    Var("reg",CTy"Zreg")])]),
                                        Var("strm3",OTy(LTy F8))]))),
                             (TP[TP[LT,LF,LF,LF,LF,LT,LT,bVar"v'0"],
                                 Var("strm2",LTy F8)],
                              Let(TP[Var("reg",CTy"Zreg"),
                                     Var("rm",CTy"Zrm"),
                                     Var("strm3",OTy(LTy F8))],
                                  Call
                                    ("readModRM",
                                     PTy(CTy"Zreg",
                                         PTy(CTy"Zrm",OTy(LTy F8))),
                                     TP[Var("REX",CTy"REX"),
                                        Var("strm2",LTy F8)]),
                                  Call
                                    ("Zfull_inst",CTy"Zinst",
                                     TP[Var("p",LTy F8),
                                        Call
                                          ("Zxchg",CTy"instruction",
                                           TP[Call
                                                ("OpSize",CTy"Zsize",
                                                 TP[bVar"have_rex",
                                                    Dest
                                                      ("W",bTy,
                                                       Var("REX",CTy"REX")),
                                                    Mop(Cast F1,
                                                        LL[bVar"v'0"]),
                                                    bVar"op_size_override"]),
                                              Var("rm",CTy"Zrm"),
                                              Var("reg",CTy"Zreg")]),
                                        Var("strm3",OTy(LTy F8))]))),
                             (TP[TP[LT,LF,LF,LF,LT,LF,bVar"x'0",bVar"v'0"],
                                 Var("strm2",LTy F8)],
                              Let(TP[Var("reg",CTy"Zreg"),
                                     Var("rm",CTy"Zrm"),
                                     Var("strm3",OTy(LTy F8))],
                                  Call
                                    ("readModRM",
                                     PTy(CTy"Zreg",
                                         PTy(CTy"Zrm",OTy(LTy F8))),
                                     TP[Var("REX",CTy"REX"),
                                        Var("strm2",LTy F8)]),
                                  Call
                                    ("Zfull_inst",CTy"Zinst",
                                     TP[Var("p",LTy F8),
                                        Call
                                          ("Zmov",CTy"instruction",
                                           TP[LC("Z_ALWAYS",CTy"Zcond"),
                                              Call
                                                ("OpSize",CTy"Zsize",
                                                 TP[bVar"have_rex",
                                                    Dest
                                                      ("W",bTy,
                                                       Var("REX",CTy"REX")),
                                                    Mop(Cast F1,
                                                        LL[bVar"v'0"]),
                                                    bVar"op_size_override"]),
                                              ITE(EQ(Mop(Cast F1,
                                                         LL[bVar"x'0"]),
                                                     LW(0,1)),
                                                  Call
                                                    ("Zrm_r",
                                                     CTy"Zdest_src",
                                                     TP[Var("rm",CTy"Zrm"),
                                                        Var("reg",
                                                            CTy"Zreg")]),
                                                  Call
                                                    ("Zr_rm",
                                                     CTy"Zdest_src",
                                                     TP[Var("reg",
                                                            CTy"Zreg"),
                                                        Var("rm",CTy"Zrm")]))]),
                                        Var("strm3",OTy(LTy F8))]))),
                             (TP[TP[LT,LF,LF,LF,LT,LT,LF,LT],
                                 Var("strm2",LTy F8)],
                              Let(TP[Var("reg",CTy"Zreg"),
                                     Var("rm",CTy"Zrm"),
                                     Var("strm3",OTy(LTy F8))],
                                  Call
                                    ("readModRM",
                                     PTy(CTy"Zreg",
                                         PTy(CTy"Zrm",OTy(LTy F8))),
                                     TP[Var("REX",CTy"REX"),
                                        Var("strm2",LTy F8)]),
                                  ITE(Call("isZm",bTy,Var("rm",CTy"Zrm")),
                                      Call
                                        ("Zfull_inst",CTy"Zinst",
                                         TP[Var("p",LTy F8),
                                            Call
                                              ("Zlea",CTy"instruction",
                                               TP[Call
                                                    ("OpSize",CTy"Zsize",
                                                     TP[LT,
                                                        Dest
                                                          ("W",bTy,
                                                           Var("REX",
                                                               CTy"REX")),
                                                        LW(1,1),
                                                        bVar"op_size_override"]),
                                                  Call
                                                    ("Zr_rm",
                                                     CTy"Zdest_src",
                                                     TP[Var("reg",
                                                            CTy"Zreg"),
                                                        Var("rm",CTy"Zrm")])]),
                                            Var("strm3",OTy(LTy F8))]),
                                      Call
                                        ("Zdec_fail",CTy"Zinst",
                                         LS"LEA with register argument")))),
                             (TP[TP[LT,LF,LF,LF,LT,LT,LT,LT],
                                 Var("strm2",LTy F8)],
                              Let(TP[Var("opcode",FTy 3),
                                     Var("rm",CTy"Zrm"),
                                     Var("strm3",OTy(LTy F8))],
                                  Call
                                    ("readOpcodeModRM",
                                     PTy(FTy 3,PTy(CTy"Zrm",OTy(LTy F8))),
                                     TP[Var("REX",CTy"REX"),
                                        Var("strm2",LTy F8)]),
                                  ITE(EQ(Var("opcode",FTy 3),LW(0,3)),
                                      Call
                                        ("Zfull_inst",CTy"Zinst",
                                         TP[Var("p",LTy F8),
                                            Call
                                              ("Zpop",CTy"instruction",
                                               Var("rm",CTy"Zrm")),
                                            Var("strm3",OTy(LTy F8))]),
                                      Call
                                        ("Zdec_fail",CTy"Zinst",
                                         LS"Unsupported opcode: Group 1a")))),
                             (TP[TP[LT,LF,LF,LT,LF,bVar"r'2",bVar"r'1",
                                    bVar"r'0"],Var("strm2",LTy F8)],
                              Let(Var("reg",CTy"Zreg"),
                                  Call
                                    ("RexReg",CTy"Zreg",
                                     TP[Dest("B",bTy,Var("REX",CTy"REX")),
                                        Mop(Cast(FTy 3),
                                            LL[bVar"r'2",bVar"r'1",
                                               bVar"r'0"])]),
                                  ITE(EQ(Var("reg",CTy"Zreg"),
                                         LC("RAX",CTy"Zreg")),
                                      Call
                                        ("Zfull_inst",CTy"Zinst",
                                         TP[Var("p",LTy F8),
                                            Call
                                              ("Znop",CTy"instruction",
                                               Mop(Length,
                                                   Var("strm",LTy F8))),
                                            Mop(Some,Var("strm2",LTy F8))]),
                                      Call
                                        ("Zfull_inst",CTy"Zinst",
                                         TP[Var("p",LTy F8),
                                            Call
                                              ("Zxchg",CTy"instruction",
                                               TP[Call
                                                    ("OpSize",CTy"Zsize",
                                                     TP[LT,
                                                        Dest
                                                          ("W",bTy,
                                                           Var("REX",
                                                               CTy"REX")),
                                                        LW(1,1),
                                                        bVar"op_size_override"]),
                                                  Call
                                                    ("Zr",CTy"Zrm",
                                                     LC("RAX",CTy"Zreg")),
                                                  Var("reg",CTy"Zreg")]),
                                            Mop(Some,Var("strm2",LTy F8))])))),
                             (TP[TP[LT,LF,LT,LF,LT,LF,LF,bVar"v'0"],
                                 Var("strm2",LTy F8)],
                              Let(Var("size",CTy"Zsize"),
                                  Call
                                    ("OpSize",CTy"Zsize",
                                     TP[LT,
                                        Dest("W",bTy,Var("REX",CTy"REX")),
                                        Mop(Cast F1,LL[bVar"v'0"]),
                                        bVar"op_size_override"]),
                                  Let(TP[Var("imm",F64),
                                         Var("strm3",OTy(LTy F8))],
                                      Call
                                        ("immediate",PTy(F64,OTy(LTy F8)),
                                         TP[Var("size",CTy"Zsize"),
                                            Var("strm2",LTy F8)]),
                                      Call
                                        ("Zfull_inst",CTy"Zinst",
                                         TP[Var("p",LTy F8),
                                            Call
                                              ("Zbinop",CTy"instruction",
                                               TP[LC("Ztest",
                                                     CTy"Zbinop_name"),
                                                  Var("size",CTy"Zsize"),
                                                  Call
                                                    ("Zrm_i",
                                                     CTy"Zdest_src",
                                                     TP[Call
                                                          ("Zr",CTy"Zrm",
                                                           LC("RAX",
                                                              CTy"Zreg")),
                                                        Var("imm",F64)])]),
                                            Var("strm3",OTy(LTy F8))])))),
                             (TP[TP[LT,LF,LT,LT,bVar"v'0",bVar"r'2",
                                    bVar"r'1",bVar"r'0"],
                                 Var("strm2",LTy F8)],
                              Let(Var("size",CTy"Zsize"),
                                  Call
                                    ("OpSize",CTy"Zsize",
                                     TP[bVar"have_rex",
                                        Dest("W",bTy,Var("REX",CTy"REX")),
                                        Mop(Cast F1,LL[bVar"v'0"]),
                                        bVar"op_size_override"]),
                                  Let(TP[Var("imm",F64),
                                         Var("strm3",OTy(LTy F8))],
                                      Call
                                        ("full_immediate",
                                         PTy(F64,OTy(LTy F8)),
                                         TP[Var("size",CTy"Zsize"),
                                            Var("strm2",LTy F8)]),
                                      Call
                                        ("Zfull_inst",CTy"Zinst",
                                         TP[Var("p",LTy F8),
                                            Call
                                              ("Zmov",CTy"instruction",
                                               TP[LC("Z_ALWAYS",CTy"Zcond"),
                                                  Var("size",CTy"Zsize"),
                                                  Call
                                                    ("Zrm_i",
                                                     CTy"Zdest_src",
                                                     TP[Call
                                                          ("Zr",CTy"Zrm",
                                                           Call
                                                             ("RexReg",
                                                              CTy"Zreg",
                                                              TP[Dest
                                                                   ("B",
                                                                    bTy,
                                                                    Var("REX",
                                                                        CTy"REX")),
                                                                 Mop(Cast
                                                                       (FTy 3),
                                                                     LL[bVar"r'2",
                                                                        bVar"r'1",
                                                                        bVar"r'0"])])),
                                                        Var("imm",F64)])]),
                                            Var("strm3",OTy(LTy F8))])))),
                             (TP[TP[LT,LT,LF,LF,LF,LF,LF,bVar"v'0"],
                                 Var("strm2",LTy F8)],
                              Let(TP[Var("opcode",FTy 3),
                                     Var("rm",CTy"Zrm"),
                                     Var("strm3",OTy(LTy F8))],
                                  Call
                                    ("readOpcodeModRM",
                                     PTy(FTy 3,PTy(CTy"Zrm",OTy(LTy F8))),
                                     TP[Var("REX",CTy"REX"),
                                        Var("strm2",LTy F8)]),
                                  Let(TP[Var("imm",F64),
                                         Var("strm4",OTy(LTy F8))],
                                      Call
                                        ("oimmediate8",
                                         PTy(F64,OTy(LTy F8)),
                                         Var("strm3",OTy(LTy F8))),
                                      ITE(EQ(Var("opcode",FTy 3),LW(6,3)),
                                          Call
                                            ("Zdec_fail",CTy"Zinst",
                                             LS
                                              "Unsupported opcode: Shift Group 2"),
                                          Call
                                            ("Zfull_inst",CTy"Zinst",
                                             TP[Var("p",LTy F8),
                                                Call
                                                  ("Zbinop",
                                                   CTy"instruction",
                                                   TP[Mop(Cast
                                                            (CTy"Zbinop_name"),
                                                          Bop(Add,
                                                              Mop(Cast nTy,
                                                                  Var("opcode",
                                                                      FTy 3)),
                                                              LN 8)),
                                                      Call
                                                        ("OpSize",
                                                         CTy"Zsize",
                                                         TP[bVar"have_rex",
                                                            Dest
                                                              ("W",bTy,
                                                               Var("REX",
                                                                   CTy"REX")),
                                                            Mop(Cast F1,
                                                                LL[bVar"v'0"]),
                                                            bVar"op_size_override"]),
                                                      Call
                                                        ("Zrm_i",
                                                         CTy"Zdest_src",
                                                         TP[Var("rm",
                                                                CTy"Zrm"),
                                                            Var("imm",F64)])]),
                                                Var("strm4",OTy(LTy F8))]))))),
                             (TP[TP[LT,LT,LF,LF,LF,LF,LT,bVar"v'0"],
                                 Var("strm2",LTy F8)],
                              ITE(EQ(Mop(Cast F1,LL[bVar"v'0"]),LW(0,1)),
                                  Let(TP[Var("imm",F64),
                                         Var("strm3",OTy(LTy F8))],
                                      Call
                                        ("immediate16",
                                         PTy(F64,OTy(LTy F8)),
                                         Var("strm2",LTy F8)),
                                      Call
                                        ("Zfull_inst",CTy"Zinst",
                                         TP[Var("p",LTy F8),
                                            Call
                                              ("Zret",CTy"instruction",
                                               Var("imm",F64)),
                                            Var("strm3",OTy(LTy F8))])),
                                  Call
                                    ("Zfull_inst",CTy"Zinst",
                                     TP[Var("p",LTy F8),
                                        Call
                                          ("Zret",CTy"instruction",
                                           LW(0,64)),
                                        Mop(Some,Var("strm2",LTy F8))]))),
                             (TP[TP[LT,LT,LF,LF,LF,LT,LT,bVar"v'0"],
                                 Var("strm2",LTy F8)],
                              Let(Var("size",CTy"Zsize"),
                                  Call
                                    ("OpSize",CTy"Zsize",
                                     TP[bVar"have_rex",
                                        Dest("W",bTy,Var("REX",CTy"REX")),
                                        Mop(Cast F1,LL[bVar"v'0"]),
                                        bVar"op_size_override"]),
                                  Let(TP[Var("opcode",FTy 3),
                                         Var("rm",CTy"Zrm"),
                                         Var("strm3",OTy(LTy F8))],
                                      Call
                                        ("readOpcodeModRM",
                                         PTy(FTy 3,
                                             PTy(CTy"Zrm",OTy(LTy F8))),
                                         TP[Var("REX",CTy"REX"),
                                            Var("strm2",LTy F8)]),
                                      Let(TP[Var("imm",F64),
                                             Var("strm4",OTy(LTy F8))],
                                          Call
                                            ("oimmediate",
                                             PTy(F64,OTy(LTy F8)),
                                             TP[Var("size",CTy"Zsize"),
                                                Var("strm3",OTy(LTy F8))]),
                                          ITE(EQ(Var("opcode",FTy 3),
                                                 LW(0,3)),
                                              Call
                                                ("Zfull_inst",CTy"Zinst",
                                                 TP[Var("p",LTy F8),
                                                    Call
                                                      ("Zmov",
                                                       CTy"instruction",
                                                       TP[LC("Z_ALWAYS",
                                                             CTy"Zcond"),
                                                          Var("size",
                                                              CTy"Zsize"),
                                                          Call
                                                            ("Zrm_i",
                                                             CTy"Zdest_src",
                                                             TP[Var("rm",
                                                                    CTy"Zrm"),
                                                                Var("imm",
                                                                    F64)])]),
                                                    Var("strm4",
                                                        OTy(LTy F8))]),
                                              Call
                                                ("Zdec_fail",CTy"Zinst",
                                                 LS
                                                  "Unsupported opcode: Group 11")))))),
                             (TP[TP[LT,LT,LF,LF,LT,LF,LF,LT],
                                 Var("strm2",LTy F8)],
                              Call
                                ("Zfull_inst",CTy"Zinst",
                                 TP[Var("p",LTy F8),
                                    Const("Zleave",CTy"instruction"),
                                    Mop(Some,Var("strm2",LTy F8))])),
                             (TP[TP[LT,LT,LF,LT,LF,LF,bVar"b'0",bVar"v'0"],
                                 Var("strm2",LTy F8)],
                              Let(TP[Var("opcode",FTy 3),
                                     Var("rm",CTy"Zrm"),
                                     Var("strm3",OTy(LTy F8))],
                                  Call
                                    ("readOpcodeModRM",
                                     PTy(FTy 3,PTy(CTy"Zrm",OTy(LTy F8))),
                                     TP[Var("REX",CTy"REX"),
                                        Var("strm2",LTy F8)]),
                                  ITE(EQ(Var("opcode",FTy 3),LW(6,3)),
                                      Call
                                        ("Zdec_fail",CTy"Zinst",
                                         LS
                                          "Unsupported opcode: Shift Group 2"),
                                      Call
                                        ("Zfull_inst",CTy"Zinst",
                                         TP[Var("p",LTy F8),
                                            Call
                                              ("Zbinop",CTy"instruction",
                                               TP[Mop(Cast
                                                        (CTy"Zbinop_name"),
                                                      Bop(Add,
                                                          Mop(Cast nTy,
                                                              Var("opcode",
                                                                  FTy 3)),
                                                          LN 8)),
                                                  Call
                                                    ("OpSize",CTy"Zsize",
                                                     TP[bVar"have_rex",
                                                        Dest
                                                          ("W",bTy,
                                                           Var("REX",
                                                               CTy"REX")),
                                                        Mop(Cast F1,
                                                            LL[bVar"v'0"]),
                                                        bVar"op_size_override"]),
                                                  ITE(EQ(Mop(Cast F1,
                                                             LL[bVar"b'0"]),
                                                         LW(0,1)),
                                                      Call
                                                        ("Zrm_i",
                                                         CTy"Zdest_src",
                                                         TP[Var("rm",
                                                                CTy"Zrm"),
                                                            LW(1,64)]),
                                                      Call
                                                        ("Zrm_r",
                                                         CTy"Zdest_src",
                                                         TP[Var("rm",
                                                                CTy"Zrm"),
                                                            LC("RCX",
                                                               CTy"Zreg")]))]),
                                            Var("strm3",OTy(LTy F8))])))),
                             (TP[TP[LT,LT,LT,LF,LF,LF,LF,bVar"b'0"],
                                 Var("strm2",LTy F8)],
                              Let(TP[Var("imm",F64),
                                     Var("strm3",OTy(LTy F8))],
                                  Call
                                    ("immediate8",PTy(F64,OTy(LTy F8)),
                                     Var("strm2",LTy F8)),
                                  Call
                                    ("Zfull_inst",CTy"Zinst",
                                     TP[Var("p",LTy F8),
                                        Call
                                          ("Zloop",CTy"instruction",
                                           TP[ITE(EQ(Mop(Cast F1,
                                                         LL[bVar"b'0"]),
                                                     LW(0,1)),
                                                  LC("Z_NE",CTy"Zcond"),
                                                  LC("Z_E",CTy"Zcond")),
                                              Var("imm",F64)]),
                                        Var("strm3",OTy(LTy F8))]))),
                             (TP[TP[LT,LT,LT,LF,LF,LF,LT,LF],
                                 Var("strm2",LTy F8)],
                              Let(TP[Var("imm",F64),
                                     Var("strm3",OTy(LTy F8))],
                                  Call
                                    ("immediate8",PTy(F64,OTy(LTy F8)),
                                     Var("strm2",LTy F8)),
                                  Call
                                    ("Zfull_inst",CTy"Zinst",
                                     TP[Var("p",LTy F8),
                                        Call
                                          ("Zloop",CTy"instruction",
                                           TP[LC("Z_ALWAYS",CTy"Zcond"),
                                              Var("imm",F64)]),
                                        Var("strm3",OTy(LTy F8))]))),
                             (TP[TP[LT,LT,LT,LF,LT,LF,LF,LF],
                                 Var("strm2",LTy F8)],
                              Let(TP[Var("imm",F64),
                                     Var("strm3",OTy(LTy F8))],
                                  Call
                                    ("immediate32",PTy(F64,OTy(LTy F8)),
                                     Var("strm2",LTy F8)),
                                  Call
                                    ("Zfull_inst",CTy"Zinst",
                                     TP[Var("p",LTy F8),
                                        Call
                                          ("Zcall",CTy"instruction",
                                           Call
                                             ("Zimm",CTy"Zimm_rm",
                                              Var("imm",F64))),
                                        Var("strm3",OTy(LTy F8))]))),
                             (TP[TP[LT,LT,LT,LF,LT,LF,bVar"b'0",LT],
                                 Var("strm2",LTy F8)],
                              Let(TP[Var("imm",F64),
                                     Var("strm3",OTy(LTy F8))],
                                  ITE(EQ(Mop(Cast F1,LL[bVar"b'0"]),
                                         LW(0,1)),
                                      Call
                                        ("immediate32",
                                         PTy(F64,OTy(LTy F8)),
                                         Var("strm2",LTy F8)),
                                      Call
                                        ("immediate8",
                                         PTy(F64,OTy(LTy F8)),
                                         Var("strm2",LTy F8))),
                                  Call
                                    ("Zfull_inst",CTy"Zinst",
                                     TP[Var("p",LTy F8),
                                        Call
                                          ("Zjcc",CTy"instruction",
                                           TP[LC("Z_ALWAYS",CTy"Zcond"),
                                              Var("imm",F64)]),
                                        Var("strm3",OTy(LTy F8))]))),
                             (TP[TP[LT,LT,LT,LT,LF,LT,LF,LT],
                                 Var("strm2",LTy F8)],
                              Call
                                ("Zfull_inst",CTy"Zinst",
                                 TP[Var("p",LTy F8),
                                    Const("Zcmc",CTy"instruction"),
                                    Mop(Some,Var("strm2",LTy F8))])),
                             (TP[TP[LT,LT,LT,LT,LF,LT,LT,bVar"v'0"],
                                 Var("strm2",LTy F8)],
                              Let(Var("size",CTy"Zsize"),
                                  Call
                                    ("OpSize",CTy"Zsize",
                                     TP[bVar"have_rex",
                                        Dest("W",bTy,Var("REX",CTy"REX")),
                                        Mop(Cast F1,LL[bVar"v'0"]),
                                        bVar"op_size_override"]),
                                  Let(TP[Var("opcode",FTy 3),
                                         Var("rm",CTy"Zrm"),
                                         Var("strm3",OTy(LTy F8))],
                                      Call
                                        ("readOpcodeModRM",
                                         PTy(FTy 3,
                                             PTy(CTy"Zrm",OTy(LTy F8))),
                                         TP[Var("REX",CTy"REX"),
                                            Var("strm2",LTy F8)]),
                                      CS(Var("opcode",FTy 3),
                                         [(LW(0,3),
                                           Let(TP[Var("imm",F64),
                                                  Var("strm4",OTy(LTy F8))],
                                               Call
                                                 ("oimmediate",
                                                  PTy(F64,OTy(LTy F8)),
                                                  TP[Var("size",CTy"Zsize"),
                                                     Var("strm3",
                                                         OTy(LTy F8))]),
                                               Call
                                                 ("Zfull_inst",CTy"Zinst",
                                                  TP[Var("p",LTy F8),
                                                     Call
                                                       ("Zbinop",
                                                        CTy"instruction",
                                                        TP[LC("Ztest",
                                                              CTy"Zbinop_name"),
                                                           Var("size",
                                                               CTy"Zsize"),
                                                           Call
                                                             ("Zrm_i",
                                                              CTy"Zdest_src",
                                                              TP[Var("rm",
                                                                     CTy"Zrm"),
                                                                 Var("imm",
                                                                     F64)])]),
                                                     Var("strm4",
                                                         OTy(LTy F8))]))),
                                          (LW(2,3),
                                           Call
                                             ("Zfull_inst",CTy"Zinst",
                                              TP[Var("p",LTy F8),
                                                 Call
                                                   ("Zmonop",
                                                    CTy"instruction",
                                                    TP[LC("Znot",
                                                          CTy"Zmonop_name"),
                                                       Var("size",
                                                           CTy"Zsize"),
                                                       Var("rm",CTy"Zrm")]),
                                                 Var("strm3",OTy(LTy F8))])),
                                          (LW(3,3),
                                           Call
                                             ("Zfull_inst",CTy"Zinst",
                                              TP[Var("p",LTy F8),
                                                 Call
                                                   ("Zmonop",
                                                    CTy"instruction",
                                                    TP[LC("Zneg",
                                                          CTy"Zmonop_name"),
                                                       Var("size",
                                                           CTy"Zsize"),
                                                       Var("rm",CTy"Zrm")]),
                                                 Var("strm3",OTy(LTy F8))])),
                                          (LW(4,3),
                                           Call
                                             ("Zfull_inst",CTy"Zinst",
                                              TP[Var("p",LTy F8),
                                                 Call
                                                   ("Zmul",
                                                    CTy"instruction",
                                                    TP[Var("size",
                                                           CTy"Zsize"),
                                                       Var("rm",CTy"Zrm")]),
                                                 Var("strm3",OTy(LTy F8))])),
                                          (LW(5,3),
                                           Call
                                             ("Zfull_inst",CTy"Zinst",
                                              TP[Var("p",LTy F8),
                                                 Call
                                                   ("Zimul",
                                                    CTy"instruction",
                                                    TP[Var("size",
                                                           CTy"Zsize"),
                                                       Var("rm",CTy"Zrm")]),
                                                 Var("strm3",OTy(LTy F8))])),
                                          (LW(6,3),
                                           Call
                                             ("Zfull_inst",CTy"Zinst",
                                              TP[Var("p",LTy F8),
                                                 Call
                                                   ("Zdiv",
                                                    CTy"instruction",
                                                    TP[Var("size",
                                                           CTy"Zsize"),
                                                       Var("rm",CTy"Zrm")]),
                                                 Var("strm3",OTy(LTy F8))])),
                                          (LW(7,3),
                                           Call
                                             ("Zfull_inst",CTy"Zinst",
                                              TP[Var("p",LTy F8),
                                                 Call
                                                   ("Zidiv",
                                                    CTy"instruction",
                                                    TP[Var("size",
                                                           CTy"Zsize"),
                                                       Var("rm",CTy"Zrm")]),
                                                 Var("strm3",OTy(LTy F8))])),
                                          (AVar(FTy 3),
                                           Call
                                             ("Zdec_fail",CTy"Zinst",
                                              LS
                                               "Unsupported opcode: Unary Group 3"))])))),
                             (TP[TP[LT,LT,LT,LT,LT,LF,LF,LF],
                                 Var("strm2",LTy F8)],
                              Call
                                ("Zfull_inst",CTy"Zinst",
                                 TP[Var("p",LTy F8),
                                    Const("Zclc",CTy"instruction"),
                                    Mop(Some,Var("strm2",LTy F8))])),
                             (TP[TP[LT,LT,LT,LT,LT,LF,LF,LT],
                                 Var("strm2",LTy F8)],
                              Call
                                ("Zfull_inst",CTy"Zinst",
                                 TP[Var("p",LTy F8),
                                    Const("Zstc",CTy"instruction"),
                                    Mop(Some,Var("strm2",LTy F8))])),
                             (TP[TP[LT,LT,LT,LT,LT,LT,LT,LF],
                                 Var("strm2",LTy F8)],
                              Let(TP[Var("opcode",FTy 3),
                                     Var("rm",CTy"Zrm"),
                                     Var("strm3",OTy(LTy F8))],
                                  Call
                                    ("readOpcodeModRM",
                                     PTy(FTy 3,PTy(CTy"Zrm",OTy(LTy F8))),
                                     TP[Var("REX",CTy"REX"),
                                        Var("strm2",LTy F8)]),
                                  ITB([(EQ(Var("opcode",FTy 3),LW(0,3)),
                                        Call
                                          ("Zfull_inst",CTy"Zinst",
                                           TP[Var("p",LTy F8),
                                              Call
                                                ("Zmonop",
                                                 CTy"instruction",
                                                 TP[LC("Zinc",
                                                       CTy"Zmonop_name"),
                                                    Call
                                                      ("Z8",CTy"Zsize",
                                                       bVar"have_rex"),
                                                    Var("rm",CTy"Zrm")]),
                                              Var("strm3",OTy(LTy F8))])),
                                       (EQ(Var("opcode",FTy 3),LW(1,3)),
                                        Call
                                          ("Zfull_inst",CTy"Zinst",
                                           TP[Var("p",LTy F8),
                                              Call
                                                ("Zmonop",
                                                 CTy"instruction",
                                                 TP[LC("Zdec",
                                                       CTy"Zmonop_name"),
                                                    Call
                                                      ("Z8",CTy"Zsize",
                                                       bVar"have_rex"),
                                                    Var("rm",CTy"Zrm")]),
                                              Var("strm3",OTy(LTy F8))]))],
                                      Call
                                        ("Zdec_fail",CTy"Zinst",
                                         LS
                                          "Unsupported opcode: INC/DEC Group 4")))),
                             (TP[TP[LT,LT,LT,LT,LT,LT,LT,LT],
                                 Var("strm2",LTy F8)],
                              Let(Var("size",CTy"Zsize"),
                                  Call
                                    ("OpSize",CTy"Zsize",
                                     TP[bVar"have_rex",
                                        Dest("W",bTy,Var("REX",CTy"REX")),
                                        LW(1,1),bVar"op_size_override"]),
                                  Let(TP[Var("opcode",FTy 3),
                                         Var("rm",CTy"Zrm"),
                                         Var("strm3",OTy(LTy F8))],
                                      Call
                                        ("readOpcodeModRM",
                                         PTy(FTy 3,
                                             PTy(CTy"Zrm",OTy(LTy F8))),
                                         TP[Var("REX",CTy"REX"),
                                            Var("strm2",LTy F8)]),
                                      CS(Var("opcode",FTy 3),
                                         [(LW(0,3),
                                           Call
                                             ("Zfull_inst",CTy"Zinst",
                                              TP[Var("p",LTy F8),
                                                 Call
                                                   ("Zmonop",
                                                    CTy"instruction",
                                                    TP[LC("Zinc",
                                                          CTy"Zmonop_name"),
                                                       Var("size",
                                                           CTy"Zsize"),
                                                       Var("rm",CTy"Zrm")]),
                                                 Var("strm3",OTy(LTy F8))])),
                                          (LW(1,3),
                                           Call
                                             ("Zfull_inst",CTy"Zinst",
                                              TP[Var("p",LTy F8),
                                                 Call
                                                   ("Zmonop",
                                                    CTy"instruction",
                                                    TP[LC("Zdec",
                                                          CTy"Zmonop_name"),
                                                       Var("size",
                                                           CTy"Zsize"),
                                                       Var("rm",CTy"Zrm")]),
                                                 Var("strm3",OTy(LTy F8))])),
                                          (LW(2,3),
                                           Call
                                             ("Zfull_inst",CTy"Zinst",
                                              TP[Var("p",LTy F8),
                                                 Call
                                                   ("Zcall",
                                                    CTy"instruction",
                                                    Call
                                                      ("Zrm",CTy"Zimm_rm",
                                                       Var("rm",CTy"Zrm"))),
                                                 Var("strm3",OTy(LTy F8))])),
                                          (LW(4,3),
                                           Call
                                             ("Zfull_inst",CTy"Zinst",
                                              TP[Var("p",LTy F8),
                                                 Call
                                                   ("Zjmp",
                                                    CTy"instruction",
                                                    Var("rm",CTy"Zrm")),
                                                 Var("strm3",OTy(LTy F8))])),
                                          (LW(6,3),
                                           Call
                                             ("Zfull_inst",CTy"Zinst",
                                              TP[Var("p",LTy F8),
                                                 Call
                                                   ("Zpush",
                                                    CTy"instruction",
                                                    Call
                                                      ("Zrm",CTy"Zimm_rm",
                                                       Var("rm",CTy"Zrm"))),
                                                 Var("strm3",OTy(LTy F8))])),
                                          (AVar(FTy 3),
                                           Call
                                             ("Zdec_fail",CTy"Zinst",
                                              LS
                                               "Unsupported opcode: INC/DEC Group 5"))])))),
                             (TP[TP[LF,LF,LF,LF,LT,LT,LT,LT],
                                 LLC([LW(56,8),Var("opc",F8)],
                                     Var("strm2",LTy F8))],
                              CS(Var("opc",F8),
                                 [(LW(41,8),
                                   ITE(EQ(Var("p",LTy F8),LL[LW(102,8)]),
                                       Let(TP[Var("reg",FTy 3),
                                              Var("rm",CTy"Zrm"),
                                              Var("strm3",OTy(LTy F8))],
                                           Call
                                             ("readOpcodeModRM",
                                              PTy(FTy 3,
                                                  PTy(CTy"Zrm",OTy(LTy F8))),
                                              TP[Var("REX",CTy"REX"),
                                                 Var("strm2",LTy F8)]),
                                           Call
                                             ("Zfull_inst",CTy"Zinst",
                                              TP[Var("p",LTy F8),
                                                 Call
                                                   ("SSE",
                                                    CTy"instruction",
                                                    Call
                                                      ("PCMPEQQ",CTy"SSE",
                                                       TP[Var("reg",FTy 3),
                                                          Call
                                                            ("rm_to_xmm_mem",
                                                             CTy"xmm_mem",
                                                             Var("rm",
                                                                 CTy"Zrm"))])),
                                                 Var("strm3",OTy(LTy F8))])),
                                       Call
                                         ("Zdec_fail",CTy"Zinst",
                                          CC[LS
                                              "Unsupported opcode: 0F 38 ",
                                             Mop(Cast sTy,Var("opc",F8))]))),
                                  (AVar F8,
                                   Call
                                     ("Zdec_fail",CTy"Zinst",
                                      CC[LS"Unsupported opcode: 0F 38 ",
                                         Mop(Cast sTy,Var("opc",F8))]))])),
                             (TP[TP[LF,LF,LF,LF,LT,LT,LT,LT],
                                 LLC([LW(58,8),Var("opc",F8)],AVar(LTy F8))],
                              Call
                                ("Zdec_fail",CTy"Zinst",
                                 CC[LS"Unsupported opcode: 0F 3A ",
                                    Mop(Cast sTy,Var("opc",F8))])),
                             (TP[TP[LF,LF,LF,LF,LT,LT,LT,LT],
                                 LLC([Var("opc",F8)],Var("strm2",LTy F8))],
                              Let(TP[bVar"b'7",bVar"b'6",bVar"b'5",
                                     bVar"b'4",bVar"b'3",bVar"b'2",
                                     bVar"b'1",bVar"b'0"],
                                  BL(8,Var("opc",F8)),
                                  ITB([(bVar"b'5",
                                        ITB([(bVar"b'7",
                                              ITB([(Bop(And,
                                                        Mop(Not,bVar"b'6"),
                                                        Bop(And,
                                                            Mop(Not,
                                                                bVar"b'2"),
                                                            Bop(And,
                                                                bVar"b'1",
                                                                bVar"b'0"))),
                                                    Let(TP[Var("reg",
                                                               CTy"Zreg"),
                                                           Var("rm",
                                                               CTy"Zrm"),
                                                           Var("strm3",
                                                               OTy(LTy F8))],
                                                        Call
                                                          ("readModRM",
                                                           PTy(CTy"Zreg",
                                                               PTy(CTy"Zrm",
                                                                   OTy(LTy F8))),
                                                           TP[Var("REX",
                                                                  CTy"REX"),
                                                              Var("strm2",
                                                                  LTy F8)]),
                                                        Call
                                                          ("Zfull_inst",
                                                           CTy"Zinst",
                                                           TP[Var("p",
                                                                  LTy F8),
                                                              Call
                                                                ("Zbit_test",
                                                                 CTy"instruction",
                                                                 TP[Mop(Cast
                                                                          (CTy"Zbit_test_name"),
                                                                        Mop(Cast
                                                                              (FTy 2),
                                                                            LL[bVar"b'4",
                                                                               bVar"b'3"])),
                                                                    Call
                                                                      ("OpSize",
                                                                       CTy"Zsize",
                                                                       TP[bVar"have_rex",
                                                                          Dest
                                                                            ("W",
                                                                             bTy,
                                                                             Var("REX",
                                                                                 CTy"REX")),
                                                                          LW(1,
                                                                             1),
                                                                          bVar"op_size_override"]),
                                                                    Call
                                                                      ("Zrm_r",
                                                                       CTy"Zdest_src",
                                                                       TP[Var("rm",
                                                                              CTy"Zrm"),
                                                                          Var("reg",
                                                                              CTy"Zreg")])]),
                                                              Var("strm3",
                                                                  OTy(LTy F8))]))),
                                                   (Bop(And,
                                                        Mop(Not,bVar"b'6"),
                                                        Bop(And,bVar"b'4",
                                                            Bop(And,
                                                                bVar"b'3",
                                                                Bop(And,
                                                                    Mop(Not,
                                                                        bVar"b'2"),
                                                                    Bop(And,
                                                                        bVar"b'1",
                                                                        Mop(Not,
                                                                            bVar"b'0")))))),
                                                    Let(TP[Var("opcode",
                                                               FTy 3),
                                                           Var("rm",
                                                               CTy"Zrm"),
                                                           Var("strm3",
                                                               OTy(LTy F8))],
                                                        Call
                                                          ("readOpcodeModRM",
                                                           PTy(FTy 3,
                                                               PTy(CTy"Zrm",
                                                                   OTy(LTy F8))),
                                                           TP[Var("REX",
                                                                  CTy"REX"),
                                                              Var("strm2",
                                                                  LTy F8)]),
                                                        Let(TP[Var("imm",
                                                                   F64),
                                                               Var("strm4",
                                                                   OTy(LTy F8))],
                                                            Call
                                                              ("oimmediate8",
                                                               PTy(F64,
                                                                   OTy(LTy F8)),
                                                               Var("strm3",
                                                                   OTy(LTy F8))),
                                                            CS(BL(3,
                                                                  Var("opcode",
                                                                      FTy 3)),
                                                               [(TP[LT,
                                                                    bVar"x'1",
                                                                    bVar"x'0"],
                                                                 Call
                                                                   ("Zfull_inst",
                                                                    CTy"Zinst",
                                                                    TP[Var("p",
                                                                           LTy F8),
                                                                       Call
                                                                         ("Zbit_test",
                                                                          CTy"instruction",
                                                                          TP[Mop(Cast
                                                                                   (CTy"Zbit_test_name"),
                                                                                 Mop(Cast
                                                                                       (FTy 2),
                                                                                     LL[bVar"x'1",
                                                                                        bVar"x'0"])),
                                                                             Call
                                                                               ("OpSize",
                                                                                CTy"Zsize",
                                                                                TP[bVar"have_rex",
                                                                                   Dest
                                                                                     ("W",
                                                                                      bTy,
                                                                                      Var("REX",
                                                                                          CTy"REX")),
                                                                                   LW(1,
                                                                                      1),
                                                                                   bVar"op_size_override"]),
                                                                             Call
                                                                               ("Zrm_i",
                                                                                CTy"Zdest_src",
                                                                                TP[Var("rm",
                                                                                       CTy"Zrm"),
                                                                                   Var("imm",
                                                                                       F64)])]),
                                                                       Var("strm4",
                                                                           OTy(LTy F8))])),
                                                                (TP[AVar
                                                                      bTy,
                                                                    AVar
                                                                      bTy,
                                                                    AVar
                                                                      bTy],
                                                                 Call
                                                                   ("Zdec_fail",
                                                                    CTy"Zinst",
                                                                    LS
                                                                     "Unsupported opcode: Group 8"))])))),
                                                   (Bop(And,
                                                        Mop(Not,bVar"b'6"),
                                                        Bop(And,
                                                            Mop(Not,
                                                                bVar"b'4"),
                                                            Bop(And,
                                                                bVar"b'3",
                                                                Bop(And,
                                                                    bVar"b'2",
                                                                    Bop(And,
                                                                        bVar"b'1",
                                                                        bVar"b'0"))))),
                                                    Let(TP[Var("reg",
                                                               CTy"Zreg"),
                                                           Var("rm",
                                                               CTy"Zrm"),
                                                           Var("strm3",
                                                               OTy(LTy F8))],
                                                        Call
                                                          ("readModRM",
                                                           PTy(CTy"Zreg",
                                                               PTy(CTy"Zrm",
                                                                   OTy(LTy F8))),
                                                           TP[Var("REX",
                                                                  CTy"REX"),
                                                              Var("strm2",
                                                                  LTy F8)]),
                                                        Call
                                                          ("Zfull_inst",
                                                           CTy"Zinst",
                                                           TP[Var("p",
                                                                  LTy F8),
                                                              Call
                                                                ("Zimul2",
                                                                 CTy"instruction",
                                                                 TP[Call
                                                                      ("OpSize",
                                                                       CTy"Zsize",
                                                                       TP[bVar"have_rex",
                                                                          Dest
                                                                            ("W",
                                                                             bTy,
                                                                             Var("REX",
                                                                                 CTy"REX")),
                                                                          LW(1,
                                                                             1),
                                                                          bVar"op_size_override"]),
                                                                    Var("reg",
                                                                        CTy"Zreg"),
                                                                    Var("rm",
                                                                        CTy"Zrm")]),
                                                              Var("strm3",
                                                                  OTy(LTy F8))]))),
                                                   (Bop(And,
                                                        Mop(Not,bVar"b'6"),
                                                        Bop(And,bVar"b'4",
                                                            Bop(And,
                                                                Mop(Not,
                                                                    bVar"b'3"),
                                                                Bop(And,
                                                                    Mop(Not,
                                                                        bVar"b'2"),
                                                                    Mop(Not,
                                                                        bVar"b'1"))))),
                                                    Let(TP[Var("reg",
                                                               CTy"Zreg"),
                                                           Var("rm",
                                                               CTy"Zrm"),
                                                           Var("strm3",
                                                               OTy(LTy F8))],
                                                        Call
                                                          ("readModRM",
                                                           PTy(CTy"Zreg",
                                                               PTy(CTy"Zrm",
                                                                   OTy(LTy F8))),
                                                           TP[Var("REX",
                                                                  CTy"REX"),
                                                              Var("strm2",
                                                                  LTy F8)]),
                                                        Call
                                                          ("Zfull_inst",
                                                           CTy"Zinst",
                                                           TP[Var("p",
                                                                  LTy F8),
                                                              Call
                                                                ("Zcmpxchg",
                                                                 CTy"instruction",
                                                                 TP[Call
                                                                      ("OpSize",
                                                                       CTy"Zsize",
                                                                       TP[bVar"have_rex",
                                                                          Dest
                                                                            ("W",
                                                                             bTy,
                                                                             Var("REX",
                                                                                 CTy"REX")),
                                                                          Mop(Cast
                                                                                F1,
                                                                              LL[bVar"b'0"]),
                                                                          bVar"op_size_override"]),
                                                                    Var("rm",
                                                                        CTy"Zrm"),
                                                                    Var("reg",
                                                                        CTy"Zreg")]),
                                                              Var("strm3",
                                                                  OTy(LTy F8))]))),
                                                   (Bop(And,
                                                        Mop(Not,bVar"b'6"),
                                                        Bop(And,bVar"b'4",
                                                            Bop(And,
                                                                bVar"b'2",
                                                                bVar"b'1"))),
                                                    Let(TP[Var("reg",
                                                               CTy"Zreg"),
                                                           Var("rm",
                                                               CTy"Zrm"),
                                                           Var("strm3",
                                                               OTy(LTy F8))],
                                                        Call
                                                          ("readModRM",
                                                           PTy(CTy"Zreg",
                                                               PTy(CTy"Zrm",
                                                                   OTy(LTy F8))),
                                                           TP[Var("REX",
                                                                  CTy"REX"),
                                                              Var("strm2",
                                                                  LTy F8)]),
                                                        Let(TP[Var("arg0",
                                                                   CTy"Zsize"),
                                                               Var("arg1",
                                                                   CTy"Zdest_src"),
                                                               Var("arg2",
                                                                   CTy"Zsize")],
                                                            TP[ITE(EQ(Mop(Cast
                                                                            F1,
                                                                          LL[bVar"b'0"]),
                                                                      LW(1,
                                                                         1)),
                                                                   Const
                                                                     ("Z16",
                                                                      CTy"Zsize"),
                                                                   Call
                                                                     ("Z8",
                                                                      CTy"Zsize",
                                                                      bVar"have_rex")),
                                                               Call
                                                                 ("Zr_rm",
                                                                  CTy"Zdest_src",
                                                                  TP[Var("reg",
                                                                         CTy"Zreg"),
                                                                     Var("rm",
                                                                         CTy"Zrm")]),
                                                               Call
                                                                 ("OpSize",
                                                                  CTy"Zsize",
                                                                  TP[bVar"have_rex",
                                                                     Dest
                                                                       ("W",
                                                                        bTy,
                                                                        Var("REX",
                                                                            CTy"REX")),
                                                                     LW(1,
                                                                        1),
                                                                     bVar"op_size_override"])],
                                                            Call
                                                              ("Zfull_inst",
                                                               CTy"Zinst",
                                                               TP[Var("p",
                                                                      LTy F8),
                                                                  ITE(EQ(Mop(Cast
                                                                               F1,
                                                                             LL[bVar"b'3"]),
                                                                         LW(1,
                                                                            1)),
                                                                      Call
                                                                        ("Zmovsx",
                                                                         CTy"instruction",
                                                                         TP[Var("arg0",
                                                                                CTy"Zsize"),
                                                                            Var("arg1",
                                                                                CTy"Zdest_src"),
                                                                            Var("arg2",
                                                                                CTy"Zsize")]),
                                                                      Call
                                                                        ("Zmovzx",
                                                                         CTy"instruction",
                                                                         TP[Var("arg0",
                                                                                CTy"Zsize"),
                                                                            Var("arg1",
                                                                                CTy"Zdest_src"),
                                                                            Var("arg2",
                                                                                CTy"Zsize")])),
                                                                  Var("strm3",
                                                                      OTy(LTy F8))])))),
                                                   (Bop(And,bVar"b'6",
                                                        Bop(And,
                                                            Mop(Not,
                                                                bVar"b'4"),
                                                            Bop(And,
                                                                Mop(Not,
                                                                    bVar"b'3"),
                                                                Bop(And,
                                                                    bVar"b'2",
                                                                    Bop(And,
                                                                        bVar"b'1",
                                                                        Mop(Not,
                                                                            bVar"b'0")))))),
                                                    Let(TP[Var("reg",FTy 3),
                                                           Var("rm",
                                                               CTy"Zrm"),
                                                           Var("strm3",
                                                               OTy(LTy F8))],
                                                        Call
                                                          ("readOpcodeModRM",
                                                           PTy(FTy 3,
                                                               PTy(CTy"Zrm",
                                                                   OTy(LTy F8))),
                                                           TP[Var("REX",
                                                                  CTy"REX"),
                                                              Var("strm2",
                                                                  LTy F8)]),
                                                        Let(Var("a1",
                                                                CTy"xmm_mem"),
                                                            Call
                                                              ("rm_to_xmm_mem",
                                                               CTy"xmm_mem",
                                                               Var("rm",
                                                                   CTy"Zrm")),
                                                            CS(Var("p",
                                                                   LTy F8),
                                                               [(LL[LW(102,
                                                                       8)],
                                                                 Call
                                                                   ("Zfull_inst",
                                                                    CTy"Zinst",
                                                                    TP[Var("p",
                                                                           LTy F8),
                                                                       Call
                                                                         ("SSE",
                                                                          CTy"instruction",
                                                                          Call
                                                                            ("CVTPD2DQ",
                                                                             CTy"SSE",
                                                                             TP[LT,
                                                                                Var("reg",
                                                                                    FTy 3),
                                                                                Var("a1",
                                                                                    CTy"xmm_mem")])),
                                                                       Var("strm3",
                                                                           OTy(LTy F8))])),
                                                                (LL[LW(243,
                                                                       8)],
                                                                 Call
                                                                   ("Zfull_inst",
                                                                    CTy"Zinst",
                                                                    TP[Var("p",
                                                                           LTy F8),
                                                                       Call
                                                                         ("SSE",
                                                                          CTy"instruction",
                                                                          Call
                                                                            ("CVTDQ2PD",
                                                                             CTy"SSE",
                                                                             TP[Var("reg",
                                                                                    FTy 3),
                                                                                Var("a1",
                                                                                    CTy"xmm_mem")])),
                                                                       Var("strm3",
                                                                           OTy(LTy F8))])),
                                                                (LL[LW(242,
                                                                       8)],
                                                                 Call
                                                                   ("Zfull_inst",
                                                                    CTy"Zinst",
                                                                    TP[Var("p",
                                                                           LTy F8),
                                                                       Call
                                                                         ("SSE",
                                                                          CTy"instruction",
                                                                          Call
                                                                            ("CVTPD2DQ",
                                                                             CTy"SSE",
                                                                             TP[LF,
                                                                                Var("reg",
                                                                                    FTy 3),
                                                                                Var("a1",
                                                                                    CTy"xmm_mem")])),
                                                                       Var("strm3",
                                                                           OTy(LTy F8))])),
                                                                (AVar
                                                                   (LTy F8),
                                                                 Call
                                                                   ("Zdec_fail",
                                                                    CTy"Zinst",
                                                                    CC[LS
                                                                        "Unsupported opcode: ",
                                                                       Mop(Cast
                                                                             sTy,
                                                                           Var("opc",
                                                                               F8))]))]))))],
                                                  Call
                                                    ("Zdec_fail",
                                                     CTy"Zinst",
                                                     CC[LS
                                                         "Unsupported opcode: 0F ",
                                                        Mop(Cast sTy,
                                                            Var("opc",F8))]))),
                                             (bVar"b'1",
                                              ITB([(Bop(And,
                                                        Mop(Not,bVar"b'6"),
                                                        Bop(And,
                                                            Mop(Not,
                                                                bVar"b'4"),
                                                            Bop(And,
                                                                bVar"b'3",
                                                                Bop(And,
                                                                    Mop(Not,
                                                                        bVar"b'2"),
                                                                    Mop(Not,
                                                                        bVar"b'0"))))),
                                                    Let(TP[Var("reg",FTy 3),
                                                           Var("rm",
                                                               CTy"Zrm"),
                                                           Var("strm3",
                                                               OTy(LTy F8))],
                                                        Call
                                                          ("readOpcodeModRM",
                                                           PTy(FTy 3,
                                                               PTy(CTy"Zrm",
                                                                   OTy(LTy F8))),
                                                           TP[Var("REX",
                                                                  CTy"REX"),
                                                              Var("strm2",
                                                                  LTy F8)]),
                                                        Let(bVar"a0",
                                                            Dest
                                                              ("W",bTy,
                                                               Var("REX",
                                                                   CTy"REX")),
                                                            CS(Var("p",
                                                                   LTy F8),
                                                               [(LL[LW(243,
                                                                       8)],
                                                                 Call
                                                                   ("Zfull_inst",
                                                                    CTy"Zinst",
                                                                    TP[Var("p",
                                                                           LTy F8),
                                                                       Call
                                                                         ("SSE",
                                                                          CTy"instruction",
                                                                          Call
                                                                            ("CVTSI2SS",
                                                                             CTy"SSE",
                                                                             TP[bVar"a0",
                                                                                Var("reg",
                                                                                    FTy 3),
                                                                                Var("rm",
                                                                                    CTy"Zrm")])),
                                                                       Var("strm3",
                                                                           OTy(LTy F8))])),
                                                                (LL[LW(242,
                                                                       8)],
                                                                 Call
                                                                   ("Zfull_inst",
                                                                    CTy"Zinst",
                                                                    TP[Var("p",
                                                                           LTy F8),
                                                                       Call
                                                                         ("SSE",
                                                                          CTy"instruction",
                                                                          Call
                                                                            ("CVTSI2SD",
                                                                             CTy"SSE",
                                                                             TP[bVar"a0",
                                                                                Var("reg",
                                                                                    FTy 3),
                                                                                Var("rm",
                                                                                    CTy"Zrm")])),
                                                                       Var("strm3",
                                                                           OTy(LTy F8))])),
                                                                (AVar
                                                                   (LTy F8),
                                                                 Call
                                                                   ("Zdec_fail",
                                                                    CTy"Zinst",
                                                                    CC[LS
                                                                        "Unsupported opcode: 0F ",
                                                                       Mop(Cast
                                                                             sTy,
                                                                           Var("opc",
                                                                               F8))]))])))),
                                                   (Bop(And,
                                                        Mop(Not,bVar"b'6"),
                                                        Bop(And,
                                                            Mop(Not,
                                                                bVar"b'4"),
                                                            Bop(And,
                                                                bVar"b'3",
                                                                Bop(And,
                                                                    bVar"b'2",
                                                                    bVar"b'0")))),
                                                    Let(TP[Var("reg",FTy 3),
                                                           Var("rm",
                                                               CTy"Zrm"),
                                                           Var("strm3",
                                                               OTy(LTy F8))],
                                                        Call
                                                          ("readOpcodeModRM",
                                                           PTy(FTy 3,
                                                               PTy(CTy"Zrm",
                                                                   OTy(LTy F8))),
                                                           TP[Var("REX",
                                                                  CTy"REX"),
                                                              Var("strm2",
                                                                  LTy F8)]),
                                                        Let(Var("a1",
                                                                CTy"xmm_mem"),
                                                            Call
                                                              ("rm_to_xmm_mem",
                                                               CTy"xmm_mem",
                                                               Var("rm",
                                                                   CTy"Zrm")),
                                                            CS(Var("p",
                                                                   LTy F8),
                                                               [(LL[LW(102,
                                                                       8)],
                                                                 Call
                                                                   ("Zfull_inst",
                                                                    CTy"Zinst",
                                                                    TP[Var("p",
                                                                           LTy F8),
                                                                       Call
                                                                         ("SSE",
                                                                          CTy"instruction",
                                                                          Call
                                                                            ("COMISD",
                                                                             CTy"SSE",
                                                                             TP[Var("reg",
                                                                                    FTy 3),
                                                                                Var("a1",
                                                                                    CTy"xmm_mem")])),
                                                                       Var("strm3",
                                                                           OTy(LTy F8))])),
                                                                (AVar
                                                                   (LTy F8),
                                                                 Call
                                                                   ("Zfull_inst",
                                                                    CTy"Zinst",
                                                                    TP[Var("p",
                                                                           LTy F8),
                                                                       Call
                                                                         ("SSE",
                                                                          CTy"instruction",
                                                                          Call
                                                                            ("COMISS",
                                                                             CTy"SSE",
                                                                             TP[Var("reg",
                                                                                    FTy 3),
                                                                                Var("a1",
                                                                                    CTy"xmm_mem")])),
                                                                       Var("strm3",
                                                                           OTy(LTy F8))]))])))),
                                                   (Bop(And,bVar"b'6",
                                                        Bop(And,bVar"b'4",
                                                            Bop(And,
                                                                Mop(Not,
                                                                    bVar"b'3"),
                                                                Bop(And,
                                                                    Mop(Not,
                                                                        bVar"b'2"),
                                                                    Mop(Not,
                                                                        bVar"b'0"))))),
                                                    ITE(EQ(Var("p",LTy F8),
                                                           LL[LW(102,8)]),
                                                        Let(TP[Var("opcode",
                                                                   FTy 3),
                                                               Var("rm",
                                                                   CTy"Zrm"),
                                                               Var("strm3",
                                                                   OTy(LTy F8))],
                                                            Call
                                                              ("readOpcodeModRM",
                                                               PTy(FTy 3,
                                                                   PTy(CTy"Zrm",
                                                                       OTy(LTy F8))),
                                                               TP[Var("REX",
                                                                      CTy"REX"),
                                                                  Var("strm2",
                                                                      LTy F8)]),
                                                            Let(TP[Var("imm",
                                                                       F64),
                                                                   Var("strm4",
                                                                       OTy(LTy F8))],
                                                                Call
                                                                  ("oimmediate8",
                                                                   PTy(F64,
                                                                       OTy(LTy F8)),
                                                                   Var("strm3",
                                                                       OTy(LTy F8))),
                                                                CS(TP[Var("opcode",
                                                                          FTy 3),
                                                                      Var("rm",
                                                                          CTy"Zrm")],
                                                                   [(TP[LW(2,
                                                                           3),
                                                                        Call
                                                                          ("Zr",
                                                                           CTy"Zrm",
                                                                           Var("r",
                                                                               CTy"Zreg"))],
                                                                     Call
                                                                       ("Zfull_inst",
                                                                        CTy"Zinst",
                                                                        TP[Var("p",
                                                                               LTy F8),
                                                                           Call
                                                                             ("SSE",
                                                                              CTy"instruction",
                                                                              Call
                                                                                ("PSRLD_imm",
                                                                                 CTy"SSE",
                                                                                 TP[Mop(Cast
                                                                                          (FTy 3),
                                                                                        Var("r",
                                                                                            CTy"Zreg")),
                                                                                    Mop(Cast
                                                                                          F8,
                                                                                        Var("imm",
                                                                                            F64))])),
                                                                           Var("strm4",
                                                                               OTy(LTy F8))])),
                                                                    (TP[LW(4,
                                                                           3),
                                                                        Call
                                                                          ("Zr",
                                                                           CTy"Zrm",
                                                                           Var("r",
                                                                               CTy"Zreg"))],
                                                                     Call
                                                                       ("Zfull_inst",
                                                                        CTy"Zinst",
                                                                        TP[Var("p",
                                                                               LTy F8),
                                                                           Call
                                                                             ("SSE",
                                                                              CTy"instruction",
                                                                              Call
                                                                                ("PSRAD_imm",
                                                                                 CTy"SSE",
                                                                                 TP[Mop(Cast
                                                                                          (FTy 3),
                                                                                        Var("r",
                                                                                            CTy"Zreg")),
                                                                                    Mop(Cast
                                                                                          F8,
                                                                                        Var("imm",
                                                                                            F64))])),
                                                                           Var("strm4",
                                                                               OTy(LTy F8))])),
                                                                    (TP[LW(6,
                                                                           3),
                                                                        Call
                                                                          ("Zr",
                                                                           CTy"Zrm",
                                                                           Var("r",
                                                                               CTy"Zreg"))],
                                                                     Call
                                                                       ("Zfull_inst",
                                                                        CTy"Zinst",
                                                                        TP[Var("p",
                                                                               LTy F8),
                                                                           Call
                                                                             ("SSE",
                                                                              CTy"instruction",
                                                                              Call
                                                                                ("PSLLD_imm",
                                                                                 CTy"SSE",
                                                                                 TP[Mop(Cast
                                                                                          (FTy 3),
                                                                                        Var("r",
                                                                                            CTy"Zreg")),
                                                                                    Mop(Cast
                                                                                          F8,
                                                                                        Var("imm",
                                                                                            F64))])),
                                                                           Var("strm4",
                                                                               OTy(LTy F8))])),
                                                                    (AVar
                                                                       (PTy(FTy 3,
                                                                            CTy"Zrm")),
                                                                     Call
                                                                       ("Zdec_fail",
                                                                        CTy"Zinst",
                                                                        LS
                                                                         "Unsupported group 13 opcode: 0F 72"))]))),
                                                        Call
                                                          ("Zdec_fail",
                                                           CTy"Zinst",
                                                           LS
                                                            "Unsupported group 13 opcode: 0F 71"))),
                                                   (Bop(And,bVar"b'6",
                                                        Bop(And,bVar"b'4",
                                                            Bop(And,
                                                                Mop(Not,
                                                                    bVar"b'3"),
                                                                Bop(And,
                                                                    Mop(Not,
                                                                        bVar"b'2"),
                                                                    bVar"b'0")))),
                                                    ITE(EQ(Var("p",LTy F8),
                                                           LL[LW(102,8)]),
                                                        Let(TP[Var("opcode",
                                                                   FTy 3),
                                                               Var("rm",
                                                                   CTy"Zrm"),
                                                               Var("strm3",
                                                                   OTy(LTy F8))],
                                                            Call
                                                              ("readOpcodeModRM",
                                                               PTy(FTy 3,
                                                                   PTy(CTy"Zrm",
                                                                       OTy(LTy F8))),
                                                               TP[Var("REX",
                                                                      CTy"REX"),
                                                                  Var("strm2",
                                                                      LTy F8)]),
                                                            Let(TP[Var("imm",
                                                                       F64),
                                                                   Var("strm4",
                                                                       OTy(LTy F8))],
                                                                Call
                                                                  ("oimmediate8",
                                                                   PTy(F64,
                                                                       OTy(LTy F8)),
                                                                   Var("strm3",
                                                                       OTy(LTy F8))),
                                                                CS(TP[Var("opcode",
                                                                          FTy 3),
                                                                      Var("rm",
                                                                          CTy"Zrm")],
                                                                   [(TP[LW(2,
                                                                           3),
                                                                        Call
                                                                          ("Zr",
                                                                           CTy"Zrm",
                                                                           Var("r",
                                                                               CTy"Zreg"))],
                                                                     Call
                                                                       ("Zfull_inst",
                                                                        CTy"Zinst",
                                                                        TP[Var("p",
                                                                               LTy F8),
                                                                           Call
                                                                             ("SSE",
                                                                              CTy"instruction",
                                                                              Call
                                                                                ("PSRLQ_imm",
                                                                                 CTy"SSE",
                                                                                 TP[Mop(Cast
                                                                                          (FTy 3),
                                                                                        Var("r",
                                                                                            CTy"Zreg")),
                                                                                    Mop(Cast
                                                                                          F8,
                                                                                        Var("imm",
                                                                                            F64))])),
                                                                           Var("strm4",
                                                                               OTy(LTy F8))])),
                                                                    (TP[LW(3,
                                                                           3),
                                                                        Call
                                                                          ("Zr",
                                                                           CTy"Zrm",
                                                                           Var("r",
                                                                               CTy"Zreg"))],
                                                                     Call
                                                                       ("Zfull_inst",
                                                                        CTy"Zinst",
                                                                        TP[Var("p",
                                                                               LTy F8),
                                                                           Call
                                                                             ("SSE",
                                                                              CTy"instruction",
                                                                              Call
                                                                                ("PSRLDQ",
                                                                                 CTy"SSE",
                                                                                 TP[Mop(Cast
                                                                                          (FTy 3),
                                                                                        Var("r",
                                                                                            CTy"Zreg")),
                                                                                    Mop(Cast
                                                                                          F8,
                                                                                        Var("imm",
                                                                                            F64))])),
                                                                           Var("strm4",
                                                                               OTy(LTy F8))])),
                                                                    (TP[LW(6,
                                                                           3),
                                                                        Call
                                                                          ("Zr",
                                                                           CTy"Zrm",
                                                                           Var("r",
                                                                               CTy"Zreg"))],
                                                                     Call
                                                                       ("Zfull_inst",
                                                                        CTy"Zinst",
                                                                        TP[Var("p",
                                                                               LTy F8),
                                                                           Call
                                                                             ("SSE",
                                                                              CTy"instruction",
                                                                              Call
                                                                                ("PSLLQ_imm",
                                                                                 CTy"SSE",
                                                                                 TP[Mop(Cast
                                                                                          (FTy 3),
                                                                                        Var("r",
                                                                                            CTy"Zreg")),
                                                                                    Mop(Cast
                                                                                          F8,
                                                                                        Var("imm",
                                                                                            F64))])),
                                                                           Var("strm4",
                                                                               OTy(LTy F8))])),
                                                                    (TP[LW(7,
                                                                           3),
                                                                        Call
                                                                          ("Zr",
                                                                           CTy"Zrm",
                                                                           Var("r",
                                                                               CTy"Zreg"))],
                                                                     Call
                                                                       ("Zfull_inst",
                                                                        CTy"Zinst",
                                                                        TP[Var("p",
                                                                               LTy F8),
                                                                           Call
                                                                             ("SSE",
                                                                              CTy"instruction",
                                                                              Call
                                                                                ("PSLLDQ",
                                                                                 CTy"SSE",
                                                                                 TP[Mop(Cast
                                                                                          (FTy 3),
                                                                                        Var("r",
                                                                                            CTy"Zreg")),
                                                                                    Mop(Cast
                                                                                          F8,
                                                                                        Var("imm",
                                                                                            F64))])),
                                                                           Var("strm4",
                                                                               OTy(LTy F8))])),
                                                                    (AVar
                                                                       (PTy(FTy 3,
                                                                            CTy"Zrm")),
                                                                     Call
                                                                       ("Zdec_fail",
                                                                        CTy"Zinst",
                                                                        LS
                                                                         "Unsupported group 14 opcode: 0F 73"))]))),
                                                        Call
                                                          ("Zdec_fail",
                                                           CTy"Zinst",
                                                           LS
                                                            "Unsupported group 14 opcode: 0F 71"))),
                                                   (Bop(And,bVar"b'6",
                                                        Bop(And,bVar"b'3",
                                                            Bop(And,
                                                                bVar"b'2",
                                                                Mop(Not,
                                                                    bVar"b'0")))),
                                                    Let(Var("b",F1),
                                                        Mop(Cast F1,
                                                            LL[bVar"b'4"]),
                                                        Let(TP[Var("reg",
                                                                   FTy 3),
                                                               Var("rm",
                                                                   CTy"Zrm"),
                                                               Var("strm3",
                                                                   OTy(LTy F8))],
                                                            Call
                                                              ("readOpcodeModRM",
                                                               PTy(FTy 3,
                                                                   PTy(CTy"Zrm",
                                                                       OTy(LTy F8))),
                                                               TP[Var("REX",
                                                                      CTy"REX"),
                                                                  Var("strm2",
                                                                      LTy F8)]),
                                                            CS(Var("p",
                                                                   LTy F8),
                                                               [(LL[LW(102,
                                                                       8)],
                                                                 Call
                                                                   ("Zfull_inst",
                                                                    CTy"Zinst",
                                                                    TP[Var("p",
                                                                           LTy F8),
                                                                       Call
                                                                         ("SSE",
                                                                          CTy"instruction",
                                                                          Call
                                                                            ("MOV_D_Q",
                                                                             CTy"SSE",
                                                                             TP[Mop(Not,
                                                                                    Mop(Cast
                                                                                          bTy,
                                                                                        Var("b",
                                                                                            F1))),
                                                                                Dest
                                                                                  ("W",
                                                                                   bTy,
                                                                                   Var("REX",
                                                                                       CTy"REX")),
                                                                                Var("reg",
                                                                                    FTy 3),
                                                                                Var("rm",
                                                                                    CTy"Zrm")])),
                                                                       Var("strm3",
                                                                           OTy(LTy F8))])),
                                                                (LL[LW(243,
                                                                       8)],
                                                                 ITE(EQ(Var("b",
                                                                            F1),
                                                                        LW(1,
                                                                           1)),
                                                                     Call
                                                                       ("Zfull_inst",
                                                                        CTy"Zinst",
                                                                        TP[Var("p",
                                                                               LTy F8),
                                                                           Call
                                                                             ("SSE",
                                                                              CTy"instruction",
                                                                              Call
                                                                                ("MOVQ",
                                                                                 CTy"SSE",
                                                                                 TP[Call
                                                                                      ("xmm_reg",
                                                                                       CTy"xmm_mem",
                                                                                       Var("reg",
                                                                                           FTy 3)),
                                                                                    Call
                                                                                      ("rm_to_xmm_mem",
                                                                                       CTy"xmm_mem",
                                                                                       Var("rm",
                                                                                           CTy"Zrm"))])),
                                                                           Var("strm3",
                                                                               OTy(LTy F8))]),
                                                                     Call
                                                                       ("Zdec_fail",
                                                                        CTy"Zinst",
                                                                        CC[LS
                                                                            "Unsupported opcode: 0F ",
                                                                           Mop(Cast
                                                                                 sTy,
                                                                               Var("opc",
                                                                                   F8))]))),
                                                                (AVar
                                                                   (LTy F8),
                                                                 Call
                                                                   ("Zdec_fail",
                                                                    CTy"Zinst",
                                                                    CC[LS
                                                                        "Unsupported opcode: 0F ",
                                                                       Mop(Cast
                                                                             sTy,
                                                                           Var("opc",
                                                                               F8))]))]))))],
                                                  Call
                                                    ("Zdec_fail",
                                                     CTy"Zinst",
                                                     CC[LS
                                                         "Unsupported opcode: 0F ",
                                                        Mop(Cast sTy,
                                                            Var("opc",F8))]))),
                                             (Bop(And,Mop(Not,bVar"b'6"),
                                                  Bop(And,
                                                      Mop(Not,bVar"b'4"),
                                                      Bop(And,bVar"b'3",
                                                          Bop(And,
                                                              Mop(Not,
                                                                  bVar"b'2"),
                                                              Mop(Not,
                                                                  bVar"b'0"))))),
                                              Let(TP[Var("reg",FTy 3),
                                                     Var("rm",CTy"Zrm"),
                                                     Var("strm3",
                                                         OTy(LTy F8))],
                                                  Call
                                                    ("readOpcodeModRM",
                                                     PTy(FTy 3,
                                                         PTy(CTy"Zrm",
                                                             OTy(LTy F8))),
                                                     TP[Var("REX",CTy"REX"),
                                                        Var("strm2",LTy F8)]),
                                                  Call
                                                    ("Zfull_inst",
                                                     CTy"Zinst",
                                                     TP[Var("p",LTy F8),
                                                        Call
                                                          ("SSE",
                                                           CTy"instruction",
                                                           Call
                                                             ("MOVAP_D_S",
                                                              CTy"SSE",
                                                              TP[EQ(Var("p",
                                                                        LTy F8),
                                                                    LL[LW(102,
                                                                          8)]),
                                                                 Call
                                                                   ("xmm_reg",
                                                                    CTy"xmm_mem",
                                                                    Var("reg",
                                                                        FTy 3)),
                                                                 Call
                                                                   ("rm_to_xmm_mem",
                                                                    CTy"xmm_mem",
                                                                    Var("rm",
                                                                        CTy"Zrm"))])),
                                                        Var("strm3",
                                                            OTy(LTy F8))]))),
                                             (Bop(And,Mop(Not,bVar"b'6"),
                                                  Bop(And,
                                                      Mop(Not,bVar"b'4"),
                                                      Bop(And,bVar"b'3",
                                                          Bop(And,
                                                              Mop(Not,
                                                                  bVar"b'2"),
                                                              bVar"b'0")))),
                                              Let(TP[Var("reg",FTy 3),
                                                     Var("rm",CTy"Zrm"),
                                                     Var("strm3",
                                                         OTy(LTy F8))],
                                                  Call
                                                    ("readOpcodeModRM",
                                                     PTy(FTy 3,
                                                         PTy(CTy"Zrm",
                                                             OTy(LTy F8))),
                                                     TP[Var("REX",CTy"REX"),
                                                        Var("strm2",LTy F8)]),
                                                  Call
                                                    ("Zfull_inst",
                                                     CTy"Zinst",
                                                     TP[Var("p",LTy F8),
                                                        Call
                                                          ("SSE",
                                                           CTy"instruction",
                                                           Call
                                                             ("MOVAP_D_S",
                                                              CTy"SSE",
                                                              TP[EQ(Var("p",
                                                                        LTy F8),
                                                                    LL[LW(102,
                                                                          8)]),
                                                                 Call
                                                                   ("rm_to_xmm_mem",
                                                                    CTy"xmm_mem",
                                                                    Var("rm",
                                                                        CTy"Zrm")),
                                                                 Call
                                                                   ("xmm_reg",
                                                                    CTy"xmm_mem",
                                                                    Var("reg",
                                                                        FTy 3))])),
                                                        Var("strm3",
                                                            OTy(LTy F8))]))),
                                             (Bop(And,Mop(Not,bVar"b'6"),
                                                  Bop(And,
                                                      Mop(Not,bVar"b'4"),
                                                      Bop(And,bVar"b'3",
                                                          bVar"b'2"))),
                                              Let(TP[Var("reg",CTy"Zreg"),
                                                     Var("rm",CTy"Zrm"),
                                                     Var("strm3",
                                                         OTy(LTy F8))],
                                                  Call
                                                    ("readModRM",
                                                     PTy(CTy"Zreg",
                                                         PTy(CTy"Zrm",
                                                             OTy(LTy F8))),
                                                     TP[Var("REX",CTy"REX"),
                                                        Var("strm2",LTy F8)]),
                                                  Let(TP[bVar"a0",
                                                         bVar"a1",
                                                         Var("a3",
                                                             CTy"xmm_mem")],
                                                      TP[Mop(Not,
                                                             Mop(Cast bTy,
                                                                 Mop(Cast
                                                                       F1,
                                                                     LL[bVar"b'0"]))),
                                                         Dest
                                                           ("W",bTy,
                                                            Var("REX",
                                                                CTy"REX")),
                                                         Call
                                                           ("rm_to_xmm_mem",
                                                            CTy"xmm_mem",
                                                            Var("rm",
                                                                CTy"Zrm"))],
                                                      CS(Var("p",LTy F8),
                                                         [(LL[LW(243,8)],
                                                           Call
                                                             ("Zfull_inst",
                                                              CTy"Zinst",
                                                              TP[Var("p",
                                                                     LTy F8),
                                                                 Call
                                                                   ("SSE",
                                                                    CTy"instruction",
                                                                    Call
                                                                      ("CVTSS2SI",
                                                                       CTy"SSE",
                                                                       TP[bVar"a0",
                                                                          bVar"a1",
                                                                          Var("reg",
                                                                              CTy"Zreg"),
                                                                          Var("a3",
                                                                              CTy"xmm_mem")])),
                                                                 Var("strm3",
                                                                     OTy(LTy F8))])),
                                                          (LL[LW(242,8)],
                                                           Call
                                                             ("Zfull_inst",
                                                              CTy"Zinst",
                                                              TP[Var("p",
                                                                     LTy F8),
                                                                 Call
                                                                   ("SSE",
                                                                    CTy"instruction",
                                                                    Call
                                                                      ("CVTSD2SI",
                                                                       CTy"SSE",
                                                                       TP[bVar"a0",
                                                                          bVar"a1",
                                                                          Var("reg",
                                                                              CTy"Zreg"),
                                                                          Var("a3",
                                                                              CTy"xmm_mem")])),
                                                                 Var("strm3",
                                                                     OTy(LTy F8))])),
                                                          (AVar(LTy F8),
                                                           Call
                                                             ("Zdec_fail",
                                                              CTy"Zinst",
                                                              CC[LS
                                                                  "Unsupported opcode: 0F ",
                                                                 Mop(Cast
                                                                       sTy,
                                                                     Var("opc",
                                                                         F8))]))])))),
                                             (Bop(And,bVar"b'6",
                                                  Bop(And,bVar"b'4",
                                                      Bop(And,
                                                          Mop(Not,
                                                              bVar"b'3"),
                                                          Bop(And,
                                                              Mop(Not,
                                                                  bVar"b'2"),
                                                              bVar"b'0")))),
                                              ITE(EQ(Var("p",LTy F8),
                                                     LL[LW(102,8)]),
                                                  Let(TP[Var("opcode",
                                                             FTy 3),
                                                         Var("rm",CTy"Zrm"),
                                                         Var("strm3",
                                                             OTy(LTy F8))],
                                                      Call
                                                        ("readOpcodeModRM",
                                                         PTy(FTy 3,
                                                             PTy(CTy"Zrm",
                                                                 OTy(LTy F8))),
                                                         TP[Var("REX",
                                                                CTy"REX"),
                                                            Var("strm2",
                                                                LTy F8)]),
                                                      Let(TP[Var("imm",F64),
                                                             Var("strm4",
                                                                 OTy(LTy F8))],
                                                          Call
                                                            ("oimmediate8",
                                                             PTy(F64,
                                                                 OTy(LTy F8)),
                                                             Var("strm3",
                                                                 OTy(LTy F8))),
                                                          CS(TP[Var("opcode",
                                                                    FTy 3),
                                                                Var("rm",
                                                                    CTy"Zrm")],
                                                             [(TP[LW(2,3),
                                                                  Call
                                                                    ("Zr",
                                                                     CTy"Zrm",
                                                                     Var("r",
                                                                         CTy"Zreg"))],
                                                               Call
                                                                 ("Zfull_inst",
                                                                  CTy"Zinst",
                                                                  TP[Var("p",
                                                                         LTy F8),
                                                                     Call
                                                                       ("SSE",
                                                                        CTy"instruction",
                                                                        Call
                                                                          ("PSRLW_imm",
                                                                           CTy"SSE",
                                                                           TP[Mop(Cast
                                                                                    (FTy 3),
                                                                                  Var("r",
                                                                                      CTy"Zreg")),
                                                                              Mop(Cast
                                                                                    F8,
                                                                                  Var("imm",
                                                                                      F64))])),
                                                                     Var("strm4",
                                                                         OTy(LTy F8))])),
                                                              (TP[LW(4,3),
                                                                  Call
                                                                    ("Zr",
                                                                     CTy"Zrm",
                                                                     Var("r",
                                                                         CTy"Zreg"))],
                                                               Call
                                                                 ("Zfull_inst",
                                                                  CTy"Zinst",
                                                                  TP[Var("p",
                                                                         LTy F8),
                                                                     Call
                                                                       ("SSE",
                                                                        CTy"instruction",
                                                                        Call
                                                                          ("PSRAW_imm",
                                                                           CTy"SSE",
                                                                           TP[Mop(Cast
                                                                                    (FTy 3),
                                                                                  Var("r",
                                                                                      CTy"Zreg")),
                                                                              Mop(Cast
                                                                                    F8,
                                                                                  Var("imm",
                                                                                      F64))])),
                                                                     Var("strm4",
                                                                         OTy(LTy F8))])),
                                                              (TP[LW(6,3),
                                                                  Call
                                                                    ("Zr",
                                                                     CTy"Zrm",
                                                                     Var("r",
                                                                         CTy"Zreg"))],
                                                               Call
                                                                 ("Zfull_inst",
                                                                  CTy"Zinst",
                                                                  TP[Var("p",
                                                                         LTy F8),
                                                                     Call
                                                                       ("SSE",
                                                                        CTy"instruction",
                                                                        Call
                                                                          ("PSLLW_imm",
                                                                           CTy"SSE",
                                                                           TP[Mop(Cast
                                                                                    (FTy 3),
                                                                                  Var("r",
                                                                                      CTy"Zreg")),
                                                                              Mop(Cast
                                                                                    F8,
                                                                                  Var("imm",
                                                                                      F64))])),
                                                                     Var("strm4",
                                                                         OTy(LTy F8))])),
                                                              (AVar
                                                                 (PTy(FTy 3,
                                                                      CTy"Zrm")),
                                                               Call
                                                                 ("Zdec_fail",
                                                                  CTy"Zinst",
                                                                  LS
                                                                   "Unsupported group 12 opcode: 0F 71"))]))),
                                                  Call
                                                    ("Zdec_fail",
                                                     CTy"Zinst",
                                                     LS
                                                      "Unsupported group 12 opcode: 0F 71")))],
                                            Call
                                              ("Zdec_fail",CTy"Zinst",
                                               CC[LS
                                                   "Unsupported opcode: 0F ",
                                                  Mop(Cast sTy,
                                                      Var("opc",F8))]))),
                                       (bVar"b'7",
                                        ITB([(Bop(And,bVar"b'6",
                                                  Bop(And,bVar"b'4",
                                                      Bop(And,
                                                          Mop(Not,
                                                              bVar"b'3"),
                                                          Bop(And,
                                                              bVar"b'2",
                                                              Bop(And,
                                                                  bVar"b'1",
                                                                  Mop(Not,
                                                                      bVar"b'0")))))),
                                              Let(TP[Var("reg",FTy 3),
                                                     Var("rm",CTy"Zrm"),
                                                     Var("strm3",
                                                         OTy(LTy F8))],
                                                  Call
                                                    ("readOpcodeModRM",
                                                     PTy(FTy 3,
                                                         PTy(CTy"Zrm",
                                                             OTy(LTy F8))),
                                                     TP[Var("REX",CTy"REX"),
                                                        Var("strm2",LTy F8)]),
                                                  CS(Var("p",LTy F8),
                                                     [(LL[LW(102,8)],
                                                       Call
                                                         ("Zfull_inst",
                                                          CTy"Zinst",
                                                          TP[Var("p",
                                                                 LTy F8),
                                                             Call
                                                               ("SSE",
                                                                CTy"instruction",
                                                                Call
                                                                  ("MOVQ",
                                                                   CTy"SSE",
                                                                   TP[Call
                                                                        ("rm_to_xmm_mem",
                                                                         CTy"xmm_mem",
                                                                         Var("rm",
                                                                             CTy"Zrm")),
                                                                      Call
                                                                        ("xmm_reg",
                                                                         CTy"xmm_mem",
                                                                         Var("reg",
                                                                             FTy 3))])),
                                                             Var("strm3",
                                                                 OTy(LTy F8))])),
                                                      (AVar(LTy F8),
                                                       Call
                                                         ("Zdec_fail",
                                                          CTy"Zinst",
                                                          CC[LS
                                                              "Unsupported opcode: 0F ",
                                                             Mop(Cast sTy,
                                                                 Var("opc",
                                                                     F8))]))]))),
                                             (Bop(And,Mop(Not,bVar"b'6"),
                                                  Mop(Not,bVar"b'4")),
                                              Let(TP[Var("imm",F64),
                                                     Var("strm3",
                                                         OTy(LTy F8))],
                                                  Call
                                                    ("immediate32",
                                                     PTy(F64,OTy(LTy F8)),
                                                     Var("strm2",LTy F8)),
                                                  Call
                                                    ("Zfull_inst",
                                                     CTy"Zinst",
                                                     TP[Var("p",LTy F8),
                                                        Call
                                                          ("Zjcc",
                                                           CTy"instruction",
                                                           TP[Mop(Cast
                                                                    (CTy"Zcond"),
                                                                  Mop(Cast
                                                                        F4,
                                                                      LL[bVar"b'3",
                                                                         bVar"b'2",
                                                                         bVar"b'1",
                                                                         bVar"b'0"])),
                                                              Var("imm",
                                                                  F64)]),
                                                        Var("strm3",
                                                            OTy(LTy F8))]))),
                                             (Bop(And,Mop(Not,bVar"b'6"),
                                                  bVar"b'4"),
                                              Let(TP[AVar(CTy"Zreg"),
                                                     Var("rm",CTy"Zrm"),
                                                     Var("strm3",
                                                         OTy(LTy F8))],
                                                  Call
                                                    ("readModRM",
                                                     PTy(CTy"Zreg",
                                                         PTy(CTy"Zrm",
                                                             OTy(LTy F8))),
                                                     TP[Var("REX",CTy"REX"),
                                                        Var("strm2",LTy F8)]),
                                                  Call
                                                    ("Zfull_inst",
                                                     CTy"Zinst",
                                                     TP[Var("p",LTy F8),
                                                        Call
                                                          ("Zset",
                                                           CTy"instruction",
                                                           TP[Mop(Cast
                                                                    (CTy"Zcond"),
                                                                  Mop(Cast
                                                                        F4,
                                                                      LL[bVar"b'3",
                                                                         bVar"b'2",
                                                                         bVar"b'1",
                                                                         bVar"b'0"])),
                                                              bVar"have_rex",
                                                              Var("rm",
                                                                  CTy"Zrm")]),
                                                        Var("strm3",
                                                            OTy(LTy F8))]))),
                                             (Bop(And,bVar"b'6",
                                                  Bop(And,
                                                      Mop(Not,bVar"b'4"),
                                                      Bop(And,
                                                          Mop(Not,
                                                              bVar"b'3"),
                                                          Bop(And,
                                                              Mop(Not,
                                                                  bVar"b'2"),
                                                              Mop(Not,
                                                                  bVar"b'1"))))),
                                              Let(TP[Var("reg",CTy"Zreg"),
                                                     Var("rm",CTy"Zrm"),
                                                     Var("strm3",
                                                         OTy(LTy F8))],
                                                  Call
                                                    ("readModRM",
                                                     PTy(CTy"Zreg",
                                                         PTy(CTy"Zrm",
                                                             OTy(LTy F8))),
                                                     TP[Var("REX",CTy"REX"),
                                                        Var("strm2",LTy F8)]),
                                                  Call
                                                    ("Zfull_inst",
                                                     CTy"Zinst",
                                                     TP[Var("p",LTy F8),
                                                        Call
                                                          ("Zxadd",
                                                           CTy"instruction",
                                                           TP[Call
                                                                ("OpSize",
                                                                 CTy"Zsize",
                                                                 TP[bVar"have_rex",
                                                                    Dest
                                                                      ("W",
                                                                       bTy,
                                                                       Var("REX",
                                                                           CTy"REX")),
                                                                    Mop(Cast
                                                                          F1,
                                                                        LL[bVar"b'0"]),
                                                                    bVar"op_size_override"]),
                                                              Var("rm",
                                                                  CTy"Zrm"),
                                                              Var("reg",
                                                                  CTy"Zreg")]),
                                                        Var("strm3",
                                                            OTy(LTy F8))]))),
                                             (Bop(And,bVar"b'6",
                                                  Bop(And,
                                                      Mop(Not,bVar"b'4"),
                                                      Bop(And,
                                                          Mop(Not,
                                                              bVar"b'3"),
                                                          Bop(And,
                                                              Mop(Not,
                                                                  bVar"b'2"),
                                                              Bop(And,
                                                                  bVar"b'1",
                                                                  Mop(Not,
                                                                      bVar"b'0")))))),
                                              Let(TP[Var("reg",FTy 3),
                                                     Var("rm",CTy"Zrm"),
                                                     Var("strm3",
                                                         OTy(LTy F8))],
                                                  Call
                                                    ("readOpcodeModRM",
                                                     PTy(FTy 3,
                                                         PTy(CTy"Zrm",
                                                             OTy(LTy F8))),
                                                     TP[Var("REX",CTy"REX"),
                                                        Var("strm2",LTy F8)]),
                                                  Let(TP[Var("imm",F64),
                                                         Var("strm4",
                                                             OTy(LTy F8))],
                                                      Call
                                                        ("oimmediate8",
                                                         PTy(F64,
                                                             OTy(LTy F8)),
                                                         Var("strm3",
                                                             OTy(LTy F8))),
                                                      Let(TP[Var("a0",
                                                                 CTy"sse_compare"),
                                                             Var("a2",
                                                                 CTy"xmm_mem")],
                                                          TP[Mop(Cast
                                                                   (CTy"sse_compare"),
                                                                 Var("imm",
                                                                     F64)),
                                                             Call
                                                               ("rm_to_xmm_mem",
                                                                CTy"xmm_mem",
                                                                Var("rm",
                                                                    CTy"Zrm"))],
                                                          CS(Var("p",
                                                                 LTy F8),
                                                             [(LL[LW(102,8)],
                                                               Call
                                                                 ("Zfull_inst",
                                                                  CTy"Zinst",
                                                                  TP[Var("p",
                                                                         LTy F8),
                                                                     Call
                                                                       ("SSE",
                                                                        CTy"instruction",
                                                                        Call
                                                                          ("CMPPD",
                                                                           CTy"SSE",
                                                                           TP[Var("a0",
                                                                                  CTy"sse_compare"),
                                                                              Var("reg",
                                                                                  FTy 3),
                                                                              Var("a2",
                                                                                  CTy"xmm_mem")])),
                                                                     Var("strm4",
                                                                         OTy(LTy F8))])),
                                                              (LL[LW(243,8)],
                                                               Call
                                                                 ("Zfull_inst",
                                                                  CTy"Zinst",
                                                                  TP[Var("p",
                                                                         LTy F8),
                                                                     Call
                                                                       ("SSE",
                                                                        CTy"instruction",
                                                                        Call
                                                                          ("CMPSS",
                                                                           CTy"SSE",
                                                                           TP[Var("a0",
                                                                                  CTy"sse_compare"),
                                                                              Var("reg",
                                                                                  FTy 3),
                                                                              Var("a2",
                                                                                  CTy"xmm_mem")])),
                                                                     Var("strm4",
                                                                         OTy(LTy F8))])),
                                                              (LL[LW(242,8)],
                                                               Call
                                                                 ("Zfull_inst",
                                                                  CTy"Zinst",
                                                                  TP[Var("p",
                                                                         LTy F8),
                                                                     Call
                                                                       ("SSE",
                                                                        CTy"instruction",
                                                                        Call
                                                                          ("CMPSD",
                                                                           CTy"SSE",
                                                                           TP[Var("a0",
                                                                                  CTy"sse_compare"),
                                                                              Var("reg",
                                                                                  FTy 3),
                                                                              Var("a2",
                                                                                  CTy"xmm_mem")])),
                                                                     Var("strm4",
                                                                         OTy(LTy F8))])),
                                                              (AVar
                                                                 (LTy F8),
                                                               Call
                                                                 ("Zfull_inst",
                                                                  CTy"Zinst",
                                                                  TP[Var("p",
                                                                         LTy F8),
                                                                     Call
                                                                       ("SSE",
                                                                        CTy"instruction",
                                                                        Call
                                                                          ("CMPPS",
                                                                           CTy"SSE",
                                                                           TP[Var("a0",
                                                                                  CTy"sse_compare"),
                                                                              Var("reg",
                                                                                  FTy 3),
                                                                              Var("a2",
                                                                                  CTy"xmm_mem")])),
                                                                     Var("strm4",
                                                                         OTy(LTy F8))]))])))))],
                                            Call
                                              ("Zdec_fail",CTy"Zinst",
                                               CC[LS
                                                   "Unsupported opcode: 0F ",
                                                  Mop(Cast sTy,
                                                      Var("opc",F8))]))),
                                       (Bop(And,Mop(Not,bVar"b'6"),
                                            Bop(And,bVar"b'4",
                                                Bop(And,
                                                    Mop(Not,bVar"b'3"),
                                                    Bop(And,
                                                        Mop(Not,bVar"b'2"),
                                                        Bop(And,
                                                            Mop(Not,
                                                                bVar"b'1"),
                                                            Mop(Not,
                                                                bVar"b'0")))))),
                                        Let(TP[Var("reg",FTy 3),
                                               Var("rm",CTy"Zrm"),
                                               Var("strm3",OTy(LTy F8))],
                                            Call
                                              ("readOpcodeModRM",
                                               PTy(FTy 3,
                                                   PTy(CTy"Zrm",
                                                       OTy(LTy F8))),
                                               TP[Var("REX",CTy"REX"),
                                                  Var("strm2",LTy F8)]),
                                            Let(TP[Var("a0",CTy"xmm_mem"),
                                                   Var("a1",CTy"xmm_mem")],
                                                TP[Call
                                                     ("xmm_reg",
                                                      CTy"xmm_mem",
                                                      Var("reg",FTy 3)),
                                                   Call
                                                     ("rm_to_xmm_mem",
                                                      CTy"xmm_mem",
                                                      Var("rm",CTy"Zrm"))],
                                                CS(Var("p",LTy F8),
                                                   [(LL[LW(102,8)],
                                                     Call
                                                       ("Zfull_inst",
                                                        CTy"Zinst",
                                                        TP[Var("p",LTy F8),
                                                           Call
                                                             ("SSE",
                                                              CTy"instruction",
                                                              Call
                                                                ("MOVUP_D_S",
                                                                 CTy"SSE",
                                                                 TP[LT,
                                                                    Var("a0",
                                                                        CTy"xmm_mem"),
                                                                    Var("a1",
                                                                        CTy"xmm_mem")])),
                                                           Var("strm3",
                                                               OTy(LTy F8))])),
                                                    (LL[LW(242,8)],
                                                     Call
                                                       ("Zfull_inst",
                                                        CTy"Zinst",
                                                        TP[Var("p",LTy F8),
                                                           Call
                                                             ("SSE",
                                                              CTy"instruction",
                                                              Call
                                                                ("MOVSD",
                                                                 CTy"SSE",
                                                                 TP[Var("a0",
                                                                        CTy"xmm_mem"),
                                                                    Var("a1",
                                                                        CTy"xmm_mem")])),
                                                           Var("strm3",
                                                               OTy(LTy F8))])),
                                                    (LL[LW(243,8)],
                                                     Call
                                                       ("Zfull_inst",
                                                        CTy"Zinst",
                                                        TP[Var("p",LTy F8),
                                                           Call
                                                             ("SSE",
                                                              CTy"instruction",
                                                              Call
                                                                ("MOVSS",
                                                                 CTy"SSE",
                                                                 TP[Var("a0",
                                                                        CTy"xmm_mem"),
                                                                    Var("a1",
                                                                        CTy"xmm_mem")])),
                                                           Var("strm3",
                                                               OTy(LTy F8))])),
                                                    (AVar(LTy F8),
                                                     Call
                                                       ("Zfull_inst",
                                                        CTy"Zinst",
                                                        TP[Var("p",LTy F8),
                                                           Call
                                                             ("SSE",
                                                              CTy"instruction",
                                                              Call
                                                                ("MOVUP_D_S",
                                                                 CTy"SSE",
                                                                 TP[LF,
                                                                    Var("a0",
                                                                        CTy"xmm_mem"),
                                                                    Var("a1",
                                                                        CTy"xmm_mem")])),
                                                           Var("strm3",
                                                               OTy(LTy F8))]))])))),
                                       (Bop(And,Mop(Not,bVar"b'6"),
                                            Bop(And,bVar"b'4",
                                                Bop(And,
                                                    Mop(Not,bVar"b'3"),
                                                    Bop(And,
                                                        Mop(Not,bVar"b'2"),
                                                        Bop(And,
                                                            Mop(Not,
                                                                bVar"b'1"),
                                                            bVar"b'0"))))),
                                        Let(TP[Var("reg",FTy 3),
                                               Var("rm",CTy"Zrm"),
                                               Var("strm3",OTy(LTy F8))],
                                            Call
                                              ("readOpcodeModRM",
                                               PTy(FTy 3,
                                                   PTy(CTy"Zrm",
                                                       OTy(LTy F8))),
                                               TP[Var("REX",CTy"REX"),
                                                  Var("strm2",LTy F8)]),
                                            Let(TP[Var("a0",CTy"xmm_mem"),
                                                   Var("a1",CTy"xmm_mem")],
                                                TP[Call
                                                     ("rm_to_xmm_mem",
                                                      CTy"xmm_mem",
                                                      Var("rm",CTy"Zrm")),
                                                   Call
                                                     ("xmm_reg",
                                                      CTy"xmm_mem",
                                                      Var("reg",FTy 3))],
                                                CS(Var("p",LTy F8),
                                                   [(LL[LW(102,8)],
                                                     Call
                                                       ("Zfull_inst",
                                                        CTy"Zinst",
                                                        TP[Var("p",LTy F8),
                                                           Call
                                                             ("SSE",
                                                              CTy"instruction",
                                                              Call
                                                                ("MOVUP_D_S",
                                                                 CTy"SSE",
                                                                 TP[LT,
                                                                    Var("a0",
                                                                        CTy"xmm_mem"),
                                                                    Var("a1",
                                                                        CTy"xmm_mem")])),
                                                           Var("strm3",
                                                               OTy(LTy F8))])),
                                                    (LL[LW(242,8)],
                                                     Call
                                                       ("Zfull_inst",
                                                        CTy"Zinst",
                                                        TP[Var("p",LTy F8),
                                                           Call
                                                             ("SSE",
                                                              CTy"instruction",
                                                              Call
                                                                ("MOVSD",
                                                                 CTy"SSE",
                                                                 TP[Var("a0",
                                                                        CTy"xmm_mem"),
                                                                    Var("a1",
                                                                        CTy"xmm_mem")])),
                                                           Var("strm3",
                                                               OTy(LTy F8))])),
                                                    (LL[LW(243,8)],
                                                     Call
                                                       ("Zfull_inst",
                                                        CTy"Zinst",
                                                        TP[Var("p",LTy F8),
                                                           Call
                                                             ("SSE",
                                                              CTy"instruction",
                                                              Call
                                                                ("MOVSS",
                                                                 CTy"SSE",
                                                                 TP[Var("a0",
                                                                        CTy"xmm_mem"),
                                                                    Var("a1",
                                                                        CTy"xmm_mem")])),
                                                           Var("strm3",
                                                               OTy(LTy F8))])),
                                                    (AVar(LTy F8),
                                                     Call
                                                       ("Zfull_inst",
                                                        CTy"Zinst",
                                                        TP[Var("p",LTy F8),
                                                           Call
                                                             ("SSE",
                                                              CTy"instruction",
                                                              Call
                                                                ("MOVUP_D_S",
                                                                 CTy"SSE",
                                                                 TP[LF,
                                                                    Var("a0",
                                                                        CTy"xmm_mem"),
                                                                    Var("a1",
                                                                        CTy"xmm_mem")])),
                                                           Var("strm3",
                                                               OTy(LTy F8))]))])))),
                                       (Bop(And,Mop(Not,bVar"b'6"),
                                            Bop(And,bVar"b'4",
                                                Bop(And,bVar"b'3",
                                                    Bop(And,bVar"b'2",
                                                        Bop(And,bVar"b'1",
                                                            bVar"b'0"))))),
                                        Let(TP[AVar(FTy 3),AVar(CTy"Zrm"),
                                               Var("strm3",OTy(LTy F8))],
                                            Call
                                              ("readOpcodeModRM",
                                               PTy(FTy 3,
                                                   PTy(CTy"Zrm",
                                                       OTy(LTy F8))),
                                               TP[Var("REX",CTy"REX"),
                                                  Var("strm2",LTy F8)]),
                                            Call
                                              ("Zfull_inst",CTy"Zinst",
                                               TP[Var("p",LTy F8),
                                                  Call
                                                    ("Znop",
                                                     CTy"instruction",
                                                     Mop(Length,
                                                         Var("strm",LTy F8))),
                                                  Var("strm3",OTy(LTy F8))]))),
                                       (Bop(And,bVar"b'6",
                                            Mop(Not,bVar"b'4")),
                                        Let(TP[Var("reg",CTy"Zreg"),
                                               Var("rm",CTy"Zrm"),
                                               Var("strm3",OTy(LTy F8))],
                                            Call
                                              ("readModRM",
                                               PTy(CTy"Zreg",
                                                   PTy(CTy"Zrm",
                                                       OTy(LTy F8))),
                                               TP[Var("REX",CTy"REX"),
                                                  Var("strm2",LTy F8)]),
                                            Call
                                              ("Zfull_inst",CTy"Zinst",
                                               TP[Var("p",LTy F8),
                                                  Call
                                                    ("Zmov",
                                                     CTy"instruction",
                                                     TP[Mop(Cast
                                                              (CTy"Zcond"),
                                                            Mop(Cast F4,
                                                                LL[bVar"b'3",
                                                                   bVar"b'2",
                                                                   bVar"b'1",
                                                                   bVar"b'0"])),
                                                        Call
                                                          ("OpSize",
                                                           CTy"Zsize",
                                                           TP[LT,
                                                              Dest
                                                                ("W",bTy,
                                                                 Var("REX",
                                                                     CTy"REX")),
                                                              LW(1,1),
                                                              bVar"op_size_override"]),
                                                        Call
                                                          ("Zr_rm",
                                                           CTy"Zdest_src",
                                                           TP[Var("reg",
                                                                  CTy"Zreg"),
                                                              Var("rm",
                                                                  CTy"Zrm")])]),
                                                  Var("strm3",OTy(LTy F8))]))),
                                       (Bop(And,bVar"b'6",
                                            Bop(And,bVar"b'4",
                                                Bop(And,
                                                    Mop(Not,bVar"b'3"),
                                                    Bop(And,
                                                        Mop(Not,bVar"b'2"),
                                                        Bop(And,
                                                            Mop(Not,
                                                                bVar"b'1"),
                                                            bVar"b'0"))))),
                                        Let(TP[Var("reg",FTy 3),
                                               Var("rm",CTy"Zrm"),
                                               Var("strm3",OTy(LTy F8))],
                                            Call
                                              ("readOpcodeModRM",
                                               PTy(FTy 3,
                                                   PTy(CTy"Zrm",
                                                       OTy(LTy F8))),
                                               TP[Var("REX",CTy"REX"),
                                                  Var("strm2",LTy F8)]),
                                            Let(Var("a1",CTy"xmm_mem"),
                                                Call
                                                  ("rm_to_xmm_mem",
                                                   CTy"xmm_mem",
                                                   Var("rm",CTy"Zrm")),
                                                CS(Var("p",LTy F8),
                                                   [(LL[LW(102,8)],
                                                     Call
                                                       ("Zfull_inst",
                                                        CTy"Zinst",
                                                        TP[Var("p",LTy F8),
                                                           Call
                                                             ("SSE",
                                                              CTy"instruction",
                                                              Call
                                                                ("SQRTPD",
                                                                 CTy"SSE",
                                                                 TP[Var("reg",
                                                                        FTy 3),
                                                                    Var("a1",
                                                                        CTy"xmm_mem")])),
                                                           Var("strm3",
                                                               OTy(LTy F8))])),
                                                    (LL[LW(243,8)],
                                                     Call
                                                       ("Zfull_inst",
                                                        CTy"Zinst",
                                                        TP[Var("p",LTy F8),
                                                           Call
                                                             ("SSE",
                                                              CTy"instruction",
                                                              Call
                                                                ("SQRTSS",
                                                                 CTy"SSE",
                                                                 TP[Var("reg",
                                                                        FTy 3),
                                                                    Var("a1",
                                                                        CTy"xmm_mem")])),
                                                           Var("strm3",
                                                               OTy(LTy F8))])),
                                                    (LL[LW(242,8)],
                                                     Call
                                                       ("Zfull_inst",
                                                        CTy"Zinst",
                                                        TP[Var("p",LTy F8),
                                                           Call
                                                             ("SSE",
                                                              CTy"instruction",
                                                              Call
                                                                ("SQRTSD",
                                                                 CTy"SSE",
                                                                 TP[Var("reg",
                                                                        FTy 3),
                                                                    Var("a1",
                                                                        CTy"xmm_mem")])),
                                                           Var("strm3",
                                                               OTy(LTy F8))])),
                                                    (AVar(LTy F8),
                                                     Call
                                                       ("Zfull_inst",
                                                        CTy"Zinst",
                                                        TP[Var("p",LTy F8),
                                                           Call
                                                             ("SSE",
                                                              CTy"instruction",
                                                              Call
                                                                ("SQRTPS",
                                                                 CTy"SSE",
                                                                 TP[Var("reg",
                                                                        FTy 3),
                                                                    Var("a1",
                                                                        CTy"xmm_mem")])),
                                                           Var("strm3",
                                                               OTy(LTy F8))]))])))),
                                       (Bop(And,bVar"b'6",
                                            Bop(And,bVar"b'4",
                                                Bop(And,
                                                    Mop(Not,bVar"b'3"),
                                                    bVar"b'2"))),
                                        Let(TP[Var("reg",FTy 3),
                                               Var("rm",CTy"Zrm"),
                                               Var("strm3",OTy(LTy F8))],
                                            Call
                                              ("readOpcodeModRM",
                                               PTy(FTy 3,
                                                   PTy(CTy"Zrm",
                                                       OTy(LTy F8))),
                                               TP[Var("REX",CTy"REX"),
                                                  Var("strm2",LTy F8)]),
                                            Let(TP[Var("a0",CTy"sse_logic"),
                                                   Var("a2",CTy"xmm_mem")],
                                                TP[Mop(Cast
                                                         (CTy"sse_logic"),
                                                       Mop(Cast(FTy 2),
                                                           LL[bVar"b'1",
                                                              bVar"b'0"])),
                                                   Call
                                                     ("rm_to_xmm_mem",
                                                      CTy"xmm_mem",
                                                      Var("rm",CTy"Zrm"))],
                                                CS(Var("p",LTy F8),
                                                   [(LL[LW(102,8)],
                                                     Call
                                                       ("Zfull_inst",
                                                        CTy"Zinst",
                                                        TP[Var("p",LTy F8),
                                                           Call
                                                             ("SSE",
                                                              CTy"instruction",
                                                              Call
                                                                ("logic_PD",
                                                                 CTy"SSE",
                                                                 TP[Var("a0",
                                                                        CTy"sse_logic"),
                                                                    Var("reg",
                                                                        FTy 3),
                                                                    Var("a2",
                                                                        CTy"xmm_mem")])),
                                                           Var("strm3",
                                                               OTy(LTy F8))])),
                                                    (AVar(LTy F8),
                                                     Call
                                                       ("Zfull_inst",
                                                        CTy"Zinst",
                                                        TP[Var("p",LTy F8),
                                                           Call
                                                             ("SSE",
                                                              CTy"instruction",
                                                              Call
                                                                ("logic_PS",
                                                                 CTy"SSE",
                                                                 TP[Var("a0",
                                                                        CTy"sse_logic"),
                                                                    Var("reg",
                                                                        FTy 3),
                                                                    Var("a2",
                                                                        CTy"xmm_mem")])),
                                                           Var("strm3",
                                                               OTy(LTy F8))]))])))),
                                       (Bop(And,bVar"b'6",
                                            Bop(And,bVar"b'4",bVar"b'3")),
                                        Let(TP[Var("reg",FTy 3),
                                               Var("rm",CTy"Zrm"),
                                               Var("strm3",OTy(LTy F8))],
                                            Call
                                              ("readOpcodeModRM",
                                               PTy(FTy 3,
                                                   PTy(CTy"Zrm",
                                                       OTy(LTy F8))),
                                               TP[Var("REX",CTy"REX"),
                                                  Var("strm2",LTy F8)]),
                                            Let(Var("a1",CTy"xmm_mem"),
                                                Call
                                                  ("rm_to_xmm_mem",
                                                   CTy"xmm_mem",
                                                   Var("rm",CTy"Zrm")),
                                                CS(TP[Mop(Cast(FTy 3),
                                                          LL[bVar"b'2",
                                                             bVar"b'1",
                                                             bVar"b'0"]),
                                                      Var("p",LTy F8)],
                                                   [(TP[LW(0,3),
                                                        LL[LW(102,8)]],
                                                     Call
                                                       ("Zfull_inst",
                                                        CTy"Zinst",
                                                        TP[Var("p",LTy F8),
                                                           Call
                                                             ("SSE",
                                                              CTy"instruction",
                                                              Call
                                                                ("bin_PD",
                                                                 CTy"SSE",
                                                                 TP[LC("sse_add",
                                                                       CTy"sse_binop"),
                                                                    Var("reg",
                                                                        FTy 3),
                                                                    Var("a1",
                                                                        CTy"xmm_mem")])),
                                                           Var("strm3",
                                                               OTy(LTy F8))])),
                                                    (TP[LW(0,3),
                                                        LL[LW(243,8)]],
                                                     Call
                                                       ("Zfull_inst",
                                                        CTy"Zinst",
                                                        TP[Var("p",LTy F8),
                                                           Call
                                                             ("SSE",
                                                              CTy"instruction",
                                                              Call
                                                                ("bin_SS",
                                                                 CTy"SSE",
                                                                 TP[LC("sse_add",
                                                                       CTy"sse_binop"),
                                                                    Var("reg",
                                                                        FTy 3),
                                                                    Var("a1",
                                                                        CTy"xmm_mem")])),
                                                           Var("strm3",
                                                               OTy(LTy F8))])),
                                                    (TP[LW(0,3),
                                                        LL[LW(242,8)]],
                                                     Call
                                                       ("Zfull_inst",
                                                        CTy"Zinst",
                                                        TP[Var("p",LTy F8),
                                                           Call
                                                             ("SSE",
                                                              CTy"instruction",
                                                              Call
                                                                ("bin_SD",
                                                                 CTy"SSE",
                                                                 TP[LC("sse_add",
                                                                       CTy"sse_binop"),
                                                                    Var("reg",
                                                                        FTy 3),
                                                                    Var("a1",
                                                                        CTy"xmm_mem")])),
                                                           Var("strm3",
                                                               OTy(LTy F8))])),
                                                    (TP[LW(0,3),
                                                        AVar(LTy F8)],
                                                     Call
                                                       ("Zfull_inst",
                                                        CTy"Zinst",
                                                        TP[Var("p",LTy F8),
                                                           Call
                                                             ("SSE",
                                                              CTy"instruction",
                                                              Call
                                                                ("bin_PS",
                                                                 CTy"SSE",
                                                                 TP[LC("sse_add",
                                                                       CTy"sse_binop"),
                                                                    Var("reg",
                                                                        FTy 3),
                                                                    Var("a1",
                                                                        CTy"xmm_mem")])),
                                                           Var("strm3",
                                                               OTy(LTy F8))])),
                                                    (TP[LW(1,3),
                                                        LL[LW(102,8)]],
                                                     Call
                                                       ("Zfull_inst",
                                                        CTy"Zinst",
                                                        TP[Var("p",LTy F8),
                                                           Call
                                                             ("SSE",
                                                              CTy"instruction",
                                                              Call
                                                                ("bin_PD",
                                                                 CTy"SSE",
                                                                 TP[LC("sse_mul",
                                                                       CTy"sse_binop"),
                                                                    Var("reg",
                                                                        FTy 3),
                                                                    Var("a1",
                                                                        CTy"xmm_mem")])),
                                                           Var("strm3",
                                                               OTy(LTy F8))])),
                                                    (TP[LW(1,3),
                                                        LL[LW(243,8)]],
                                                     Call
                                                       ("Zfull_inst",
                                                        CTy"Zinst",
                                                        TP[Var("p",LTy F8),
                                                           Call
                                                             ("SSE",
                                                              CTy"instruction",
                                                              Call
                                                                ("bin_SS",
                                                                 CTy"SSE",
                                                                 TP[LC("sse_mul",
                                                                       CTy"sse_binop"),
                                                                    Var("reg",
                                                                        FTy 3),
                                                                    Var("a1",
                                                                        CTy"xmm_mem")])),
                                                           Var("strm3",
                                                               OTy(LTy F8))])),
                                                    (TP[LW(1,3),
                                                        LL[LW(242,8)]],
                                                     Call
                                                       ("Zfull_inst",
                                                        CTy"Zinst",
                                                        TP[Var("p",LTy F8),
                                                           Call
                                                             ("SSE",
                                                              CTy"instruction",
                                                              Call
                                                                ("bin_SD",
                                                                 CTy"SSE",
                                                                 TP[LC("sse_mul",
                                                                       CTy"sse_binop"),
                                                                    Var("reg",
                                                                        FTy 3),
                                                                    Var("a1",
                                                                        CTy"xmm_mem")])),
                                                           Var("strm3",
                                                               OTy(LTy F8))])),
                                                    (TP[LW(1,3),
                                                        AVar(LTy F8)],
                                                     Call
                                                       ("Zfull_inst",
                                                        CTy"Zinst",
                                                        TP[Var("p",LTy F8),
                                                           Call
                                                             ("SSE",
                                                              CTy"instruction",
                                                              Call
                                                                ("bin_PS",
                                                                 CTy"SSE",
                                                                 TP[LC("sse_mul",
                                                                       CTy"sse_binop"),
                                                                    Var("reg",
                                                                        FTy 3),
                                                                    Var("a1",
                                                                        CTy"xmm_mem")])),
                                                           Var("strm3",
                                                               OTy(LTy F8))])),
                                                    (TP[LW(2,3),
                                                        LL[LW(102,8)]],
                                                     Call
                                                       ("Zfull_inst",
                                                        CTy"Zinst",
                                                        TP[Var("p",LTy F8),
                                                           Call
                                                             ("SSE",
                                                              CTy"instruction",
                                                              Call
                                                                ("CVTPD2PS",
                                                                 CTy"SSE",
                                                                 TP[Var("reg",
                                                                        FTy 3),
                                                                    Var("a1",
                                                                        CTy"xmm_mem")])),
                                                           Var("strm3",
                                                               OTy(LTy F8))])),
                                                    (TP[LW(2,3),
                                                        LL[LW(243,8)]],
                                                     Call
                                                       ("Zfull_inst",
                                                        CTy"Zinst",
                                                        TP[Var("p",LTy F8),
                                                           Call
                                                             ("SSE",
                                                              CTy"instruction",
                                                              Call
                                                                ("CVTSS2SD",
                                                                 CTy"SSE",
                                                                 TP[Var("reg",
                                                                        FTy 3),
                                                                    Var("a1",
                                                                        CTy"xmm_mem")])),
                                                           Var("strm3",
                                                               OTy(LTy F8))])),
                                                    (TP[LW(2,3),
                                                        LL[LW(242,8)]],
                                                     Call
                                                       ("Zfull_inst",
                                                        CTy"Zinst",
                                                        TP[Var("p",LTy F8),
                                                           Call
                                                             ("SSE",
                                                              CTy"instruction",
                                                              Call
                                                                ("CVTSD2SS",
                                                                 CTy"SSE",
                                                                 TP[Var("reg",
                                                                        FTy 3),
                                                                    Var("a1",
                                                                        CTy"xmm_mem")])),
                                                           Var("strm3",
                                                               OTy(LTy F8))])),
                                                    (TP[LW(2,3),
                                                        AVar(LTy F8)],
                                                     Call
                                                       ("Zfull_inst",
                                                        CTy"Zinst",
                                                        TP[Var("p",LTy F8),
                                                           Call
                                                             ("SSE",
                                                              CTy"instruction",
                                                              Call
                                                                ("CVTPS2PD",
                                                                 CTy"SSE",
                                                                 TP[Var("reg",
                                                                        FTy 3),
                                                                    Var("a1",
                                                                        CTy"xmm_mem")])),
                                                           Var("strm3",
                                                               OTy(LTy F8))])),
                                                    (TP[LW(3,3),
                                                        LL[LW(102,8)]],
                                                     Call
                                                       ("Zfull_inst",
                                                        CTy"Zinst",
                                                        TP[Var("p",LTy F8),
                                                           Call
                                                             ("SSE",
                                                              CTy"instruction",
                                                              Call
                                                                ("CVTPS2DQ",
                                                                 CTy"SSE",
                                                                 TP[LF,
                                                                    Var("reg",
                                                                        FTy 3),
                                                                    Var("a1",
                                                                        CTy"xmm_mem")])),
                                                           Var("strm3",
                                                               OTy(LTy F8))])),
                                                    (TP[LW(3,3),
                                                        LL[LW(243,8)]],
                                                     Call
                                                       ("Zfull_inst",
                                                        CTy"Zinst",
                                                        TP[Var("p",LTy F8),
                                                           Call
                                                             ("SSE",
                                                              CTy"instruction",
                                                              Call
                                                                ("CVTPS2DQ",
                                                                 CTy"SSE",
                                                                 TP[LT,
                                                                    Var("reg",
                                                                        FTy 3),
                                                                    Var("a1",
                                                                        CTy"xmm_mem")])),
                                                           Var("strm3",
                                                               OTy(LTy F8))])),
                                                    (TP[LW(3,3),
                                                        LL[LW(242,8)]],
                                                     Call
                                                       ("Zdec_fail",
                                                        CTy"Zinst",
                                                        CC[LS
                                                            "Unsupported opcode: 0F ",
                                                           Mop(Cast sTy,
                                                               Var("opc",
                                                                   F8))])),
                                                    (TP[LW(3,3),
                                                        AVar(LTy F8)],
                                                     Call
                                                       ("Zfull_inst",
                                                        CTy"Zinst",
                                                        TP[Var("p",LTy F8),
                                                           Call
                                                             ("SSE",
                                                              CTy"instruction",
                                                              Call
                                                                ("CVTDQ2PS",
                                                                 CTy"SSE",
                                                                 TP[Var("reg",
                                                                        FTy 3),
                                                                    Var("a1",
                                                                        CTy"xmm_mem")])),
                                                           Var("strm3",
                                                               OTy(LTy F8))])),
                                                    (TP[LW(4,3),
                                                        LL[LW(102,8)]],
                                                     Call
                                                       ("Zfull_inst",
                                                        CTy"Zinst",
                                                        TP[Var("p",LTy F8),
                                                           Call
                                                             ("SSE",
                                                              CTy"instruction",
                                                              Call
                                                                ("bin_PD",
                                                                 CTy"SSE",
                                                                 TP[LC("sse_sub",
                                                                       CTy"sse_binop"),
                                                                    Var("reg",
                                                                        FTy 3),
                                                                    Var("a1",
                                                                        CTy"xmm_mem")])),
                                                           Var("strm3",
                                                               OTy(LTy F8))])),
                                                    (TP[LW(4,3),
                                                        LL[LW(243,8)]],
                                                     Call
                                                       ("Zfull_inst",
                                                        CTy"Zinst",
                                                        TP[Var("p",LTy F8),
                                                           Call
                                                             ("SSE",
                                                              CTy"instruction",
                                                              Call
                                                                ("bin_SS",
                                                                 CTy"SSE",
                                                                 TP[LC("sse_sub",
                                                                       CTy"sse_binop"),
                                                                    Var("reg",
                                                                        FTy 3),
                                                                    Var("a1",
                                                                        CTy"xmm_mem")])),
                                                           Var("strm3",
                                                               OTy(LTy F8))])),
                                                    (TP[LW(4,3),
                                                        LL[LW(242,8)]],
                                                     Call
                                                       ("Zfull_inst",
                                                        CTy"Zinst",
                                                        TP[Var("p",LTy F8),
                                                           Call
                                                             ("SSE",
                                                              CTy"instruction",
                                                              Call
                                                                ("bin_SD",
                                                                 CTy"SSE",
                                                                 TP[LC("sse_sub",
                                                                       CTy"sse_binop"),
                                                                    Var("reg",
                                                                        FTy 3),
                                                                    Var("a1",
                                                                        CTy"xmm_mem")])),
                                                           Var("strm3",
                                                               OTy(LTy F8))])),
                                                    (TP[LW(4,3),
                                                        AVar(LTy F8)],
                                                     Call
                                                       ("Zfull_inst",
                                                        CTy"Zinst",
                                                        TP[Var("p",LTy F8),
                                                           Call
                                                             ("SSE",
                                                              CTy"instruction",
                                                              Call
                                                                ("bin_PS",
                                                                 CTy"SSE",
                                                                 TP[LC("sse_sub",
                                                                       CTy"sse_binop"),
                                                                    Var("reg",
                                                                        FTy 3),
                                                                    Var("a1",
                                                                        CTy"xmm_mem")])),
                                                           Var("strm3",
                                                               OTy(LTy F8))])),
                                                    (TP[LW(5,3),
                                                        LL[LW(102,8)]],
                                                     Call
                                                       ("Zfull_inst",
                                                        CTy"Zinst",
                                                        TP[Var("p",LTy F8),
                                                           Call
                                                             ("SSE",
                                                              CTy"instruction",
                                                              Call
                                                                ("bin_PD",
                                                                 CTy"SSE",
                                                                 TP[LC("sse_min",
                                                                       CTy"sse_binop"),
                                                                    Var("reg",
                                                                        FTy 3),
                                                                    Var("a1",
                                                                        CTy"xmm_mem")])),
                                                           Var("strm3",
                                                               OTy(LTy F8))])),
                                                    (TP[LW(5,3),
                                                        LL[LW(243,8)]],
                                                     Call
                                                       ("Zfull_inst",
                                                        CTy"Zinst",
                                                        TP[Var("p",LTy F8),
                                                           Call
                                                             ("SSE",
                                                              CTy"instruction",
                                                              Call
                                                                ("bin_SS",
                                                                 CTy"SSE",
                                                                 TP[LC("sse_min",
                                                                       CTy"sse_binop"),
                                                                    Var("reg",
                                                                        FTy 3),
                                                                    Var("a1",
                                                                        CTy"xmm_mem")])),
                                                           Var("strm3",
                                                               OTy(LTy F8))])),
                                                    (TP[LW(5,3),
                                                        LL[LW(242,8)]],
                                                     Call
                                                       ("Zfull_inst",
                                                        CTy"Zinst",
                                                        TP[Var("p",LTy F8),
                                                           Call
                                                             ("SSE",
                                                              CTy"instruction",
                                                              Call
                                                                ("bin_SD",
                                                                 CTy"SSE",
                                                                 TP[LC("sse_min",
                                                                       CTy"sse_binop"),
                                                                    Var("reg",
                                                                        FTy 3),
                                                                    Var("a1",
                                                                        CTy"xmm_mem")])),
                                                           Var("strm3",
                                                               OTy(LTy F8))])),
                                                    (TP[LW(5,3),
                                                        AVar(LTy F8)],
                                                     Call
                                                       ("Zfull_inst",
                                                        CTy"Zinst",
                                                        TP[Var("p",LTy F8),
                                                           Call
                                                             ("SSE",
                                                              CTy"instruction",
                                                              Call
                                                                ("bin_PS",
                                                                 CTy"SSE",
                                                                 TP[LC("sse_min",
                                                                       CTy"sse_binop"),
                                                                    Var("reg",
                                                                        FTy 3),
                                                                    Var("a1",
                                                                        CTy"xmm_mem")])),
                                                           Var("strm3",
                                                               OTy(LTy F8))])),
                                                    (TP[LW(6,3),
                                                        LL[LW(102,8)]],
                                                     Call
                                                       ("Zfull_inst",
                                                        CTy"Zinst",
                                                        TP[Var("p",LTy F8),
                                                           Call
                                                             ("SSE",
                                                              CTy"instruction",
                                                              Call
                                                                ("bin_PD",
                                                                 CTy"SSE",
                                                                 TP[LC("sse_div",
                                                                       CTy"sse_binop"),
                                                                    Var("reg",
                                                                        FTy 3),
                                                                    Var("a1",
                                                                        CTy"xmm_mem")])),
                                                           Var("strm3",
                                                               OTy(LTy F8))])),
                                                    (TP[LW(6,3),
                                                        LL[LW(243,8)]],
                                                     Call
                                                       ("Zfull_inst",
                                                        CTy"Zinst",
                                                        TP[Var("p",LTy F8),
                                                           Call
                                                             ("SSE",
                                                              CTy"instruction",
                                                              Call
                                                                ("bin_SS",
                                                                 CTy"SSE",
                                                                 TP[LC("sse_div",
                                                                       CTy"sse_binop"),
                                                                    Var("reg",
                                                                        FTy 3),
                                                                    Var("a1",
                                                                        CTy"xmm_mem")])),
                                                           Var("strm3",
                                                               OTy(LTy F8))])),
                                                    (TP[LW(6,3),
                                                        LL[LW(242,8)]],
                                                     Call
                                                       ("Zfull_inst",
                                                        CTy"Zinst",
                                                        TP[Var("p",LTy F8),
                                                           Call
                                                             ("SSE",
                                                              CTy"instruction",
                                                              Call
                                                                ("bin_SD",
                                                                 CTy"SSE",
                                                                 TP[LC("sse_div",
                                                                       CTy"sse_binop"),
                                                                    Var("reg",
                                                                        FTy 3),
                                                                    Var("a1",
                                                                        CTy"xmm_mem")])),
                                                           Var("strm3",
                                                               OTy(LTy F8))])),
                                                    (TP[LW(6,3),
                                                        AVar(LTy F8)],
                                                     Call
                                                       ("Zfull_inst",
                                                        CTy"Zinst",
                                                        TP[Var("p",LTy F8),
                                                           Call
                                                             ("SSE",
                                                              CTy"instruction",
                                                              Call
                                                                ("bin_PS",
                                                                 CTy"SSE",
                                                                 TP[LC("sse_div",
                                                                       CTy"sse_binop"),
                                                                    Var("reg",
                                                                        FTy 3),
                                                                    Var("a1",
                                                                        CTy"xmm_mem")])),
                                                           Var("strm3",
                                                               OTy(LTy F8))])),
                                                    (TP[LW(7,3),
                                                        LL[LW(102,8)]],
                                                     Call
                                                       ("Zfull_inst",
                                                        CTy"Zinst",
                                                        TP[Var("p",LTy F8),
                                                           Call
                                                             ("SSE",
                                                              CTy"instruction",
                                                              Call
                                                                ("bin_PD",
                                                                 CTy"SSE",
                                                                 TP[LC("sse_max",
                                                                       CTy"sse_binop"),
                                                                    Var("reg",
                                                                        FTy 3),
                                                                    Var("a1",
                                                                        CTy"xmm_mem")])),
                                                           Var("strm3",
                                                               OTy(LTy F8))])),
                                                    (TP[LW(7,3),
                                                        LL[LW(243,8)]],
                                                     Call
                                                       ("Zfull_inst",
                                                        CTy"Zinst",
                                                        TP[Var("p",LTy F8),
                                                           Call
                                                             ("SSE",
                                                              CTy"instruction",
                                                              Call
                                                                ("bin_SS",
                                                                 CTy"SSE",
                                                                 TP[LC("sse_max",
                                                                       CTy"sse_binop"),
                                                                    Var("reg",
                                                                        FTy 3),
                                                                    Var("a1",
                                                                        CTy"xmm_mem")])),
                                                           Var("strm3",
                                                               OTy(LTy F8))])),
                                                    (TP[LW(7,3),
                                                        LL[LW(242,8)]],
                                                     Call
                                                       ("Zfull_inst",
                                                        CTy"Zinst",
                                                        TP[Var("p",LTy F8),
                                                           Call
                                                             ("SSE",
                                                              CTy"instruction",
                                                              Call
                                                                ("bin_SD",
                                                                 CTy"SSE",
                                                                 TP[LC("sse_max",
                                                                       CTy"sse_binop"),
                                                                    Var("reg",
                                                                        FTy 3),
                                                                    Var("a1",
                                                                        CTy"xmm_mem")])),
                                                           Var("strm3",
                                                               OTy(LTy F8))])),
                                                    (TP[LW(7,3),
                                                        AVar(LTy F8)],
                                                     Call
                                                       ("Zfull_inst",
                                                        CTy"Zinst",
                                                        TP[Var("p",LTy F8),
                                                           Call
                                                             ("SSE",
                                                              CTy"instruction",
                                                              Call
                                                                ("bin_PS",
                                                                 CTy"SSE",
                                                                 TP[LC("sse_max",
                                                                       CTy"sse_binop"),
                                                                    Var("reg",
                                                                        FTy 3),
                                                                    Var("a1",
                                                                        CTy"xmm_mem")])),
                                                           Var("strm3",
                                                               OTy(LTy F8))]))]))))],
                                      Call
                                        ("Zdec_fail",CTy"Zinst",
                                         CC[LS"Unsupported opcode: 0F ",
                                            Mop(Cast sTy,Var("opc",F8))])))),
                             (TP[TP[bVar"opc'7",bVar"opc'6",bVar"opc'5",
                                    bVar"opc'4",bVar"opc'3",bVar"opc'2",
                                    bVar"opc'1",bVar"opc'0"],AVar(LTy F8)],
                              Call
                                ("Zdec_fail",CTy"Zinst",
                                 CC[LS"Unsupported opcode: ",
                                    Mop(Cast sTy,
                                        Mop(Cast F8,
                                            LL[bVar"opc'7",bVar"opc'6",
                                               bVar"opc'5",bVar"opc'4",
                                               bVar"opc'3",bVar"opc'2",
                                               bVar"opc'1",bVar"opc'0"]))]))])),
                        (LNL F8,Call("Zdec_fail",CTy"Zinst",LS"No opcode"))])))))]))
;
val x64_fetch_def = Def
  ("x64_fetch",qVar"state",
   Mop(Fst,
       Mop(Snd,
           Apply
             (For(TP[LN 19,LN 0,
                     Close
                       (nVar"i",
                        Close
                          (Var("state",PTy(LTy F8,qTy)),
                           TP[LU,
                              LLC([Apply
                                     (Dest
                                        ("MEM",ATy(F64,F8),
                                         Mop(Snd,
                                             Var("state",PTy(LTy F8,qTy)))),
                                      Bop(Add,
                                          Dest
                                            ("RIP",F64,
                                             Mop(Snd,
                                                 Var("state",
                                                     PTy(LTy F8,qTy)))),
                                          Mop(Cast F64,nVar"i")))],
                                  Mop(Fst,Var("state",PTy(LTy F8,qTy)))),
                              Mop(Snd,Var("state",PTy(LTy F8,qTy)))]))]),
              TP[LNL F8,qVar"state"]))))
;
val x64_next_def = Def
  ("x64_next",qVar"state",
   CS(Call
        ("x64_decode",CTy"Zinst",
         Apply(Const("x64_fetch",ATy(qTy,LTy F8)),qVar"state")),
      [(Call
          ("Zfull_inst",CTy"Zinst",
           TP[AVar(LTy F8),Var("i",CTy"instruction"),
              Mop(Some,Var("strm1",LTy F8))]),
        Apply
          (Call("Run",ATy(qTy,qTy),Var("i",CTy"instruction")),
           Rupd
             ("RIP",
              TP[qVar"state",
                 Bop(Add,Dest("RIP",F64,qVar"state"),
                     Mop(Cast F64,
                         Bop(Sub,LN 20,Mop(Length,Var("strm1",LTy F8)))))]))),
       (Call
          ("Zfull_inst",CTy"Zinst",
           TP[AVar(LTy F8),AVar(CTy"instruction"),LO(LTy F8)]),
        Mop(Snd,
            Apply
              (Call
                 ("raise'exception",ATy(qTy,PTy(uTy,qTy)),
                  Call("FAILURE",CTy"exception",LS"not enough bytes")),
               qVar"state"))),
       (Call("Zdec_fail",CTy"Zinst",sVar"s0"),
        Mop(Snd,
            Apply
              (Call
                 ("raise'exception",ATy(qTy,PTy(uTy,qTy)),
                  Call("FAILURE",CTy"exception",sVar"s0")),qVar"state")))]))
;
val e_imm8_def = Def
  ("e_imm8",Var("imm",F64),
   ITE(Bop(And,Bop(Le,LW(18446744073709551488,64),Var("imm",F64)),
           Bop(Le,Var("imm",F64),LW(127,64))),
       LL[EX(Var("imm",F64),LN 7,LN 0,F8)],LNL F8))
;
val e_imm16_def = Def
  ("e_imm16",Var("imm",F64),
   ITE(Bop(And,Bop(Le,LW(18446744073709518848,64),Var("imm",F64)),
           Bop(Le,Var("imm",F64),LW(32767,64))),
       LL[EX(Var("imm",F64),LN 7,LN 0,F8),EX(Var("imm",F64),LN 15,LN 8,F8)],
       LNL F8))
;
val e_imm32_def = Def
  ("e_imm32",Var("imm",F64),
   ITE(Bop(And,Bop(Le,LW(18446744071562067968,64),Var("imm",F64)),
           Bop(Le,Var("imm",F64),LW(2147483647,64))),
       LL[EX(Var("imm",F64),LN 7,LN 0,F8),
          EX(Var("imm",F64),LN 15,LN 8,F8),
          EX(Var("imm",F64),LN 23,LN 16,F8),
          EX(Var("imm",F64),LN 31,LN 24,F8)],LNL F8))
;
val e_imm64_def = Def
  ("e_imm64",Var("imm",F64),
   LL[EX(Var("imm",F64),LN 7,LN 0,F8),EX(Var("imm",F64),LN 15,LN 8,F8),
      EX(Var("imm",F64),LN 23,LN 16,F8),EX(Var("imm",F64),LN 31,LN 24,F8),
      EX(Var("imm",F64),LN 39,LN 32,F8),EX(Var("imm",F64),LN 47,LN 40,F8),
      EX(Var("imm",F64),LN 55,LN 48,F8),EX(Var("imm",F64),LN 63,LN 56,F8)])
;
val e_imm_def = Def
  ("e_imm",Var("imm",F64),
   CS(Call("e_imm8",LTy F8,Var("imm",F64)),
      [(LNL F8,
        CS(Call("e_imm16",LTy F8,Var("imm",F64)),
           [(LNL F8,
             CS(Call("e_imm32",LTy F8,Var("imm",F64)),
                [(LNL F8,Call("e_imm64",LTy F8,Var("imm",F64))),
                 (Var("l",LTy F8),Var("l",LTy F8))])),
            (Var("l",LTy F8),Var("l",LTy F8))])),
       (Var("l",LTy F8),Var("l",LTy F8))]))
;
val e_imm_8_32_def = Def
  ("e_imm_8_32",Var("imm",F64),
   CS(Call("e_imm8",LTy F8,Var("imm",F64)),
      [(LNL F8,
        CS(Call("e_imm32",LTy F8,Var("imm",F64)),
           [(LNL F8,TP[LN 8,LNL F8]),
            (Var("l",LTy F8),TP[LN 4,Var("l",LTy F8)])])),
       (Var("l",LTy F8),TP[LN 1,Var("l",LTy F8)])]))
;
val e_ModRM_def = Def
  ("e_ModRM",TP[Var("r",F4),Var("rm",CTy"Zrm")],
   CS(Var("rm",CTy"Zrm"),
      [(Call
          ("Zm",CTy"Zrm",
           TP[LO(PTy(FTy 2,CTy"Zreg")),Const("ZripBase",CTy"Zbase"),
              Var("displacement",F64)]),
        Mop(Some,
            TP[CC[LW(0,1),EX(Var("r",F4),LN 3,LN 3,F1),LW(0,2)],
               LLC([CC[LW(0,2),EX(Var("r",F4),LN 2,LN 0,FTy 3),LW(5,3)]],
                   Call("e_imm32",LTy F8,Var("displacement",F64)))])),
       (Call("Zr",CTy"Zrm",Var("rm",CTy"Zreg")),
        Let(Var("rm",F4),Mop(Cast F4,Var("rm",CTy"Zreg")),
            Mop(Some,
                TP[CC[LW(0,1),EX(Var("r",F4),LN 3,LN 3,F1),LW(0,1),
                      EX(Var("rm",F4),LN 3,LN 3,F1)],
                   LL[CC[LW(3,2),EX(Var("r",F4),LN 2,LN 0,FTy 3),
                         EX(Var("rm",F4),LN 2,LN 0,FTy 3)]]]))),
       (Call
          ("Zm",CTy"Zrm",
           TP[LO(PTy(FTy 2,CTy"Zreg")),Const("ZnoBase",CTy"Zbase"),
              Var("imm",F64)]),
        CS(Call("e_imm32",LTy F8,Var("imm",F64)),
           [(LNL F8,LO(PTy(F4,LTy F8))),
            (Var("l",LTy F8),
             Mop(Some,
                 TP[CC[LW(0,1),EX(Var("r",F4),LN 3,LN 3,F1),LW(0,2)],
                    CC[LL[CC[LW(0,2),EX(Var("r",F4),LN 2,LN 0,FTy 3),
                             LW(4,3)],LW(37,8)],Var("l",LTy F8)]]))])),
       (Call
          ("Zm",CTy"Zrm",
           TP[Mop(Some,TP[Var("ss",FTy 2),Var("index",CTy"Zreg")]),
              Const("ZnoBase",CTy"Zbase"),Var("imm",F64)]),
        Let(Var("i",F4),Mop(Cast F4,Var("index",CTy"Zreg")),
            CS(Call("e_imm32",LTy F8,Var("imm",F64)),
               [(LNL F8,LO(PTy(F4,LTy F8))),
                (Var("l",LTy F8),
                 Mop(Some,
                     TP[CC[LW(0,1),EX(Var("r",F4),LN 3,LN 3,F1),
                           EX(Var("i",F4),LN 3,LN 3,F1),LW(0,1)],
                        CC[LL[CC[LW(0,2),EX(Var("r",F4),LN 2,LN 0,FTy 3),
                                 LW(4,3)],
                              CC[Var("ss",FTy 2),
                                 EX(Var("i",F4),LN 2,LN 0,FTy 3),LW(5,3)]],
                           Var("l",LTy F8)]]))]))),
       (Call
          ("Zm",CTy"Zrm",
           TP[Mop(Some,TP[Var("ss",FTy 2),Var("index",CTy"Zreg")]),
              Call("ZregBase",CTy"Zbase",Var("base",CTy"Zreg")),
              Var("imm",F64)]),
        Let(Var("b",F4),Mop(Cast F4,Var("base",CTy"Zreg")),
            Let(Var("i",F4),Mop(Cast F4,Var("index",CTy"Zreg")),
                Let(Var("b20",FTy 3),EX(Var("b",F4),LN 2,LN 0,FTy 3),
                    Let(TP[nVar"s",Var("l",LTy F8)],
                        ITE(Bop(And,EQ(Var("imm",F64),LW(0,64)),
                                Mop(Not,EQ(Var("b20",FTy 3),LW(5,3)))),
                            TP[LN 0,LNL F8],
                            Call
                              ("e_imm_8_32",PTy(nTy,LTy F8),Var("imm",F64))),
                        ITE(Bop(In,nVar"s",SL[LN 0,LN 1,LN 4]),
                            Mop(Some,
                                TP[CC[LW(0,1),
                                      EX(Var("r",F4),LN 3,LN 3,F1),
                                      EX(Var("i",F4),LN 3,LN 3,F1),
                                      EX(Var("b",F4),LN 3,LN 3,F1)],
                                   CC[LL[CC[CS(nVar"s",
                                               [(LN 0,LW(0,2)),
                                                (LN 1,LW(1,2)),
                                                (AVar nTy,LW(2,2))]),
                                            EX(Var("r",F4),LN 2,LN 0,FTy 3),
                                            LW(4,3)],
                                         CC[Var("ss",FTy 2),
                                            EX(Var("i",F4),LN 2,LN 0,FTy 3),
                                            Var("b20",FTy 3)]],
                                      Var("l",LTy F8)]]),
                            LO(PTy(F4,LTy F8)))))))),
       (Call
          ("Zm",CTy"Zrm",
           TP[LO(PTy(FTy 2,CTy"Zreg")),
              Call("ZregBase",CTy"Zbase",Var("base",CTy"Zreg")),
              Var("imm",F64)]),
        Let(Var("base",F4),Mop(Cast F4,Var("base",CTy"Zreg")),
            Let(Var("base20",FTy 3),EX(Var("base",F4),LN 2,LN 0,FTy 3),
                Let(TP[nVar"s",Var("l",LTy F8)],
                    ITE(Bop(And,EQ(Var("imm",F64),LW(0,64)),
                            Mop(Not,EQ(Var("base20",FTy 3),LW(5,3)))),
                        TP[LN 0,LNL F8],
                        Call("e_imm_8_32",PTy(nTy,LTy F8),Var("imm",F64))),
                    ITE(Bop(In,nVar"s",SL[LN 0,LN 1,LN 4]),
                        Mop(Some,
                            TP[CC[LW(0,1),EX(Var("r",F4),LN 3,LN 3,F1),
                                  LW(0,1),EX(Var("base",F4),LN 3,LN 3,F1)],
                               CC[LLC([CC[CS(nVar"s",
                                             [(LN 0,LW(0,2)),
                                              (LN 1,LW(1,2)),
                                              (AVar nTy,LW(2,2))]),
                                          EX(Var("r",F4),LN 2,LN 0,FTy 3),
                                          Var("base20",FTy 3)]],
                                      ITE(EQ(Var("base20",FTy 3),LW(4,3)),
                                          LL[CC[LW(4,5),
                                                Var("base20",FTy 3)]],
                                          LNL F8)),Var("l",LTy F8)]]),
                        LO(PTy(F4,LTy F8))))))),
       (AVar(CTy"Zrm"),LO(PTy(F4,LTy F8)))]))
;
val rex_prefix_def = Def
  ("rex_prefix",Var("rex",F4),
   ITE(EQ(Var("rex",F4),LW(0,4)),LNL F8,LL[CC[LW(4,4),Var("rex",F4)]]))
;
val e_opsize_def = Def
  ("e_opsize",TP[Var("sz",CTy"Zsize"),Var("rex",F4)],
   CS(Var("sz",CTy"Zsize"),
      [(Call("Z8",CTy"Zsize",bVar"have_rex"),
        Let(Var("p",LTy F8),Call("rex_prefix",LTy F8,Var("rex",F4)),
            TP[ITE(Bop(And,bVar"have_rex",EQ(Var("p",LTy F8),LNL F8)),
                   LL[LW(64,8)],Var("p",LTy F8)),LW(0,8)])),
       (Const("Z16",CTy"Zsize"),
        TP[CC[LL[LW(102,8)],
              Call("rex_prefix",LTy F8,Bop(BAnd,Var("rex",F4),LW(7,4)))],
           LW(1,8)]),
       (Const("Z32",CTy"Zsize"),
        TP[Call("rex_prefix",LTy F8,Bop(BAnd,Var("rex",F4),LW(7,4))),
           LW(1,8)]),
       (Const("Z64",CTy"Zsize"),
        TP[Call("rex_prefix",LTy F8,Bop(BOr,Var("rex",F4),LW(8,4))),
           LW(1,8)])]))
;
val e_opsize_imm_def = Def
  ("e_opsize_imm",
   TP[Var("sz",CTy"Zsize"),Var("rex",F4),Var("imm",F64),bVar"normal"],
   Let(TP[Var("prefixes",LTy F8),Var("v",F8)],
       Call
         ("e_opsize",PTy(LTy F8,F8),TP[Var("sz",CTy"Zsize"),Var("rex",F4)]),
       CS(ITE(Bop(And,EQ(Var("sz",CTy"Zsize"),Const("Z64",CTy"Zsize")),
                  bVar"normal"),Const("Z32",CTy"Zsize"),
              Var("sz",CTy"Zsize")),
          [(Call("Z8",CTy"Zsize",AVar bTy),
            CS(Call("e_imm8",LTy F8,Var("imm",F64)),
               [(LNL F8,LO(PTy(LTy F8,PTy(F8,LTy F8)))),
                (Var("l",LTy F8),
                 ITE(EQ(Var("v",F8),LW(0,8)),
                     Mop(Some,
                         TP[Var("prefixes",LTy F8),Var("v",F8),
                            Var("l",LTy F8)]),
                     LO(PTy(LTy F8,PTy(F8,LTy F8)))))])),
           (Const("Z16",CTy"Zsize"),
            CS(Call("e_imm16",LTy F8,Var("imm",F64)),
               [(LNL F8,LO(PTy(LTy F8,PTy(F8,LTy F8)))),
                (Var("l",LTy F8),
                 ITE(EQ(Var("v",F8),LW(1,8)),
                     Mop(Some,
                         TP[Var("prefixes",LTy F8),Var("v",F8),
                            Var("l",LTy F8)]),
                     LO(PTy(LTy F8,PTy(F8,LTy F8)))))])),
           (Const("Z32",CTy"Zsize"),
            CS(Call("e_imm32",LTy F8,Var("imm",F64)),
               [(LNL F8,LO(PTy(LTy F8,PTy(F8,LTy F8)))),
                (Var("l",LTy F8),
                 ITE(EQ(Var("v",F8),LW(1,8)),
                     Mop(Some,
                         TP[Var("prefixes",LTy F8),Var("v",F8),
                            Var("l",LTy F8)]),
                     LO(PTy(LTy F8,PTy(F8,LTy F8)))))])),
           (Const("Z64",CTy"Zsize"),
            ITE(EQ(Var("v",F8),LW(1,8)),
                Mop(Some,
                    TP[Var("prefixes",LTy F8),Var("v",F8),
                       Call("e_imm64",LTy F8,Var("imm",F64))]),
                LO(PTy(LTy F8,PTy(F8,LTy F8)))))])))
;
val e_opc_def = Def
  ("e_opc",TP[Var("opc1",F8),Var("opc2",FTy 3),Var("rm",CTy"Zrm")],
   CS(Call
        ("e_ModRM",OTy(PTy(F4,LTy F8)),
         TP[Mop(Cast F4,Var("opc2",FTy 3)),Var("rm",CTy"Zrm")]),
      [(LO(PTy(F4,LTy F8)),LNL F8),
       (Mop(Some,TP[Var("rex",F4),Var("strm",LTy F8)]),
        CC[Call("rex_prefix",LTy F8,Var("rex",F4)),
           LLC([Var("opc1",F8)],Var("strm",LTy F8))])]))
;
val e_gen_rm_reg_def = Def
  ("e_gen_rm_reg",
   TP[Var("sz",CTy"Zsize"),Var("rm",CTy"Zrm"),Var("r",F4),Var("p",LTy F8),
      Var("opc",F8),Var("mo",OTy F8)],
   CS(Call
        ("e_ModRM",OTy(PTy(F4,LTy F8)),TP[Var("r",F4),Var("rm",CTy"Zrm")]),
      [(LO(PTy(F4,LTy F8)),LNL F8),
       (Mop(Some,TP[Var("rex",F4),Var("strm",LTy F8)]),
        Let(TP[Var("prefixes",LTy F8),Var("v",F8)],
            Call
              ("e_opsize",PTy(LTy F8,F8),
               TP[Var("sz",CTy"Zsize"),Var("rex",F4)]),
            CC[Var("prefixes",LTy F8),Var("p",LTy F8),
               LL[Bop(BOr,Var("opc",F8),
                      CS(Var("mo",OTy F8),
                         [(Mop(Some,Var("x",F8)),Var("x",F8)),
                          (LO F8,Var("v",F8))]))],Var("strm",LTy F8)]))]))
;
val e_rm_imm_def = Def
  ("e_rm_imm",
   TP[Var("sz",CTy"Zsize"),Var("rm",CTy"Zrm"),Var("imm",F64),
      Var("opc1",F4),Var("opc2",F8)],
   CS(Call
        ("e_ModRM",OTy(PTy(F4,LTy F8)),
         TP[Var("opc1",F4),Var("rm",CTy"Zrm")]),
      [(LO(PTy(F4,LTy F8)),LNL F8),
       (Mop(Some,TP[Var("rex",F4),Var("strm",LTy F8)]),
        CS(Call
             ("e_opsize_imm",OTy(PTy(LTy F8,PTy(F8,LTy F8))),
              TP[Var("sz",CTy"Zsize"),Var("rex",F4),Var("imm",F64),LT]),
           [(Mop(Some,
                 TP[Var("prefixes",LTy F8),Var("v",F8),Var("l",LTy F8)]),
             CC[Var("prefixes",LTy F8),
                LL[Bop(BOr,Var("opc2",F8),Var("v",F8))],
                Var("strm",LTy F8),Var("l",LTy F8)]),
            (LO(PTy(LTy F8,PTy(F8,LTy F8))),LNL F8)]))]))
;
val e_rm_imm8_def = Def
  ("e_rm_imm8",
   TP[Var("sz",CTy"Zsize"),Var("rm",CTy"Zrm"),Var("imm",F64),
      Var("opc1",F4),Var("opc2",F8)],
   CS(Call
        ("e_ModRM",OTy(PTy(F4,LTy F8)),
         TP[Var("opc1",F4),Var("rm",CTy"Zrm")]),
      [(LO(PTy(F4,LTy F8)),LNL F8),
       (Mop(Some,TP[Var("rex",F4),Var("strm",LTy F8)]),
        Let(TP[Var("prefixes",LTy F8),Var("v",F8)],
            Call
              ("e_opsize",PTy(LTy F8,F8),
               TP[Var("sz",CTy"Zsize"),Var("rex",F4)]),
            CS(Call("e_imm8",LTy F8,Var("imm",F64)),
               [(LNL F8,LNL F8),
                (Var("l",LTy F8),
                 CC[Var("prefixes",LTy F8),
                    LL[Bop(BOr,Var("opc2",F8),Var("v",F8))],
                    Var("strm",LTy F8),Var("l",LTy F8)])])))]))
;
val e_rm_imm8b_def = Def
  ("e_rm_imm8b",
   TP[Var("sz",CTy"Zsize"),Var("rm",CTy"Zrm"),Var("imm",F64),
      Var("opc1",F4),Var("opc2",LTy F8)],
   CS(Call
        ("e_ModRM",OTy(PTy(F4,LTy F8)),
         TP[Var("opc1",F4),Var("rm",CTy"Zrm")]),
      [(Mop(Some,TP[Var("rex",F4),LLC([Var("s",F8)],Var("t",LTy F8))]),
        CS(Call("e_imm8",LTy F8,Var("imm",F64)),
           [(LNL F8,LNL F8),
            (Var("l",LTy F8),
             CC[Mop(Fst,
                    Call
                      ("e_opsize",PTy(LTy F8,F8),
                       TP[Var("sz",CTy"Zsize"),Var("rex",F4)])),
                Var("opc2",LTy F8),LL[Bop(BOr,Var("s",F8),LW(32,8))],
                Var("t",LTy F8),Var("l",LTy F8)])])),
       (AVar(OTy(PTy(F4,LTy F8))),LNL F8)]))
;
val e_rax_imm_def = Def
  ("e_rax_imm",TP[Var("sz",CTy"Zsize"),Var("imm",F64),Var("opc",F8)],
   CS(Call
        ("e_opsize_imm",OTy(PTy(LTy F8,PTy(F8,LTy F8))),
         TP[Var("sz",CTy"Zsize"),LW(0,4),Var("imm",F64),LT]),
      [(Mop(Some,TP[Var("prefixes",LTy F8),Var("v",F8),Var("l",LTy F8)]),
        CC[Var("prefixes",LTy F8),LL[Bop(BOr,Var("opc",F8),Var("v",F8))],
           Var("l",LTy F8)]),(LO(PTy(LTy F8,PTy(F8,LTy F8))),LNL F8)]))
;
val e_jcc_rel32_def = Def
  ("e_jcc_rel32",Var("i",CTy"instruction"),
   CS(Var("i",CTy"instruction"),
      [(Call
          ("Zjcc",CTy"instruction",
           TP[Var("cond",CTy"Zcond"),Var("imm",F64)]),
        CS(TP[Call("e_imm32",LTy F8,Var("imm",F64)),Var("cond",CTy"Zcond")],
           [(TP[LNL F8,AVar(CTy"Zcond")],LNL F8),
            (TP[Var("l",LTy F8),LC("Z_ALWAYS",CTy"Zcond")],
             LLC([LW(233,8)],Var("l",LTy F8))),
            (TP[Var("l",LTy F8),AVar(CTy"Zcond")],
             CC[LL[LW(15,8),
                   CC[LW(8,4),Mop(Cast F4,Var("cond",CTy"Zcond"))]],
                Var("l",LTy F8)])])),(AVar(CTy"instruction"),LNL F8)]))
;
val not_byte_def = Def
  ("not_byte",Var("sz",CTy"Zsize"),
   CS(Var("sz",CTy"Zsize"),
      [(Call("Z8",CTy"Zsize",AVar bTy),LF),(AVar(CTy"Zsize"),LT)]))
;
val is_rax_def = Def
  ("is_rax",Var("rm",CTy"Zrm"),
   CS(Var("rm",CTy"Zrm"),
      [(Call("Zr",CTy"Zrm",LC("RAX",CTy"Zreg")),LT),(AVar(CTy"Zrm"),LF)]))
;
val xmm_mem_to_rm_def = Def
  ("xmm_mem_to_rm",Var("x",CTy"xmm_mem"),
   CS(Var("x",CTy"xmm_mem"),
      [(Call("xmm_reg",CTy"xmm_mem",Var("r",FTy 3)),
        Call("Zr",CTy"Zrm",Mop(Cast(CTy"Zreg"),Var("r",FTy 3)))),
       (Call
          ("xmm_mem",CTy"xmm_mem",
           Var("m",PTy(OTy(PTy(FTy 2,CTy"Zreg")),PTy(CTy"Zbase",F64)))),
        Call
          ("Zm",CTy"Zrm",
           Var("m",PTy(OTy(PTy(FTy 2,CTy"Zreg")),PTy(CTy"Zbase",F64)))))]))
;
val encode_sse_binop_def = Def
  ("encode_sse_binop",Var("bop",CTy"sse_binop"),
   CS(Var("bop",CTy"sse_binop"),
      [(LC("sse_add",CTy"sse_binop"),LW(0,3)),
       (LC("sse_mul",CTy"sse_binop"),LW(1,3)),
       (LC("sse_sub",CTy"sse_binop"),LW(4,3)),
       (LC("sse_min",CTy"sse_binop"),LW(5,3)),
       (LC("sse_div",CTy"sse_binop"),LW(6,3)),
       (LC("sse_max",CTy"sse_binop"),LW(7,3))]))
;
val encode_sse_def = Def
  ("encode_sse",Var("i",CTy"SSE"),
   CS(Var("i",CTy"SSE"),
      [(Call
          ("bin_PD",CTy"SSE",
           TP[Var("bop",CTy"sse_binop"),Var("dst",FTy 3),
              Var("src",CTy"xmm_mem")]),
        LLC([LW(102,8)],
            Call
              ("e_gen_rm_reg",LTy F8,
               TP[Const("Z32",CTy"Zsize"),
                  Call("xmm_mem_to_rm",CTy"Zrm",Var("src",CTy"xmm_mem")),
                  Mop(Cast F4,Var("dst",FTy 3)),LL[LW(15,8)],
                  CC[LW(5,4),LW(1,1),
                     Call
                       ("encode_sse_binop",FTy 3,Var("bop",CTy"sse_binop"))],
                  Mop(Some,LW(0,8))]))),
       (Call
          ("bin_PS",CTy"SSE",
           TP[Var("bop",CTy"sse_binop"),Var("dst",FTy 3),
              Var("src",CTy"xmm_mem")]),
        Call
          ("e_gen_rm_reg",LTy F8,
           TP[Const("Z32",CTy"Zsize"),
              Call("xmm_mem_to_rm",CTy"Zrm",Var("src",CTy"xmm_mem")),
              Mop(Cast F4,Var("dst",FTy 3)),LL[LW(15,8)],
              CC[LW(5,4),LW(1,1),
                 Call("encode_sse_binop",FTy 3,Var("bop",CTy"sse_binop"))],
              Mop(Some,LW(0,8))])),
       (Call
          ("bin_SD",CTy"SSE",
           TP[Var("bop",CTy"sse_binop"),Var("dst",FTy 3),
              Var("src",CTy"xmm_mem")]),
        LLC([LW(242,8)],
            Call
              ("e_gen_rm_reg",LTy F8,
               TP[Const("Z32",CTy"Zsize"),
                  Call("xmm_mem_to_rm",CTy"Zrm",Var("src",CTy"xmm_mem")),
                  Mop(Cast F4,Var("dst",FTy 3)),LL[LW(15,8)],
                  CC[LW(5,4),LW(1,1),
                     Call
                       ("encode_sse_binop",FTy 3,Var("bop",CTy"sse_binop"))],
                  Mop(Some,LW(0,8))]))),
       (Call
          ("bin_SS",CTy"SSE",
           TP[Var("bop",CTy"sse_binop"),Var("dst",FTy 3),
              Var("src",CTy"xmm_mem")]),
        LLC([LW(243,8)],
            Call
              ("e_gen_rm_reg",LTy F8,
               TP[Const("Z32",CTy"Zsize"),
                  Call("xmm_mem_to_rm",CTy"Zrm",Var("src",CTy"xmm_mem")),
                  Mop(Cast F4,Var("dst",FTy 3)),LL[LW(15,8)],
                  CC[LW(5,4),LW(1,1),
                     Call
                       ("encode_sse_binop",FTy 3,Var("bop",CTy"sse_binop"))],
                  Mop(Some,LW(0,8))]))),
       (Call
          ("logic_PD",CTy"SSE",
           TP[Var("bop",CTy"sse_logic"),Var("dst",FTy 3),
              Var("src",CTy"xmm_mem")]),
        LLC([LW(102,8)],
            Call
              ("e_gen_rm_reg",LTy F8,
               TP[Const("Z32",CTy"Zsize"),
                  Call("xmm_mem_to_rm",CTy"Zrm",Var("src",CTy"xmm_mem")),
                  Mop(Cast F4,Var("dst",FTy 3)),LL[LW(15,8)],
                  CC[LW(5,4),LW(1,2),
                     Mop(Cast(FTy 2),Var("bop",CTy"sse_logic"))],
                  Mop(Some,LW(0,8))]))),
       (Call
          ("logic_PS",CTy"SSE",
           TP[Var("bop",CTy"sse_logic"),Var("dst",FTy 3),
              Var("src",CTy"xmm_mem")]),
        Call
          ("e_gen_rm_reg",LTy F8,
           TP[Const("Z32",CTy"Zsize"),
              Call("xmm_mem_to_rm",CTy"Zrm",Var("src",CTy"xmm_mem")),
              Mop(Cast F4,Var("dst",FTy 3)),LL[LW(15,8)],
              CC[LW(5,4),LW(1,2),
                 Mop(Cast(FTy 2),Var("bop",CTy"sse_logic"))],
              Mop(Some,LW(0,8))])),
       (Call
          ("CMPPD",CTy"SSE",
           TP[Var("bop",CTy"sse_compare"),Var("dst",FTy 3),
              Var("src",CTy"xmm_mem")]),
        CC[LLC([LW(102,8)],
               Call
                 ("e_gen_rm_reg",LTy F8,
                  TP[Const("Z32",CTy"Zsize"),
                     Call
                       ("xmm_mem_to_rm",CTy"Zrm",Var("src",CTy"xmm_mem")),
                     Mop(Cast F4,Var("dst",FTy 3)),LL[LW(15,8)],LW(194,8),
                     Mop(Some,LW(0,8))])),
           LL[Mop(Cast F8,Var("bop",CTy"sse_compare"))]]),
       (Call
          ("CMPPS",CTy"SSE",
           TP[Var("bop",CTy"sse_compare"),Var("dst",FTy 3),
              Var("src",CTy"xmm_mem")]),
        CC[Call
             ("e_gen_rm_reg",LTy F8,
              TP[Const("Z32",CTy"Zsize"),
                 Call("xmm_mem_to_rm",CTy"Zrm",Var("src",CTy"xmm_mem")),
                 Mop(Cast F4,Var("dst",FTy 3)),LL[LW(15,8)],LW(194,8),
                 Mop(Some,LW(0,8))]),
           LL[Mop(Cast F8,Var("bop",CTy"sse_compare"))]]),
       (Call
          ("CMPSD",CTy"SSE",
           TP[Var("bop",CTy"sse_compare"),Var("dst",FTy 3),
              Var("src",CTy"xmm_mem")]),
        CC[LLC([LW(242,8)],
               Call
                 ("e_gen_rm_reg",LTy F8,
                  TP[Const("Z32",CTy"Zsize"),
                     Call
                       ("xmm_mem_to_rm",CTy"Zrm",Var("src",CTy"xmm_mem")),
                     Mop(Cast F4,Var("dst",FTy 3)),LL[LW(15,8)],LW(194,8),
                     Mop(Some,LW(0,8))])),
           LL[Mop(Cast F8,Var("bop",CTy"sse_compare"))]]),
       (Call
          ("CMPSS",CTy"SSE",
           TP[Var("bop",CTy"sse_compare"),Var("dst",FTy 3),
              Var("src",CTy"xmm_mem")]),
        CC[LLC([LW(243,8)],
               Call
                 ("e_gen_rm_reg",LTy F8,
                  TP[Const("Z32",CTy"Zsize"),
                     Call
                       ("xmm_mem_to_rm",CTy"Zrm",Var("src",CTy"xmm_mem")),
                     Mop(Cast F4,Var("dst",FTy 3)),LL[LW(15,8)],LW(194,8),
                     Mop(Some,LW(0,8))])),
           LL[Mop(Cast F8,Var("bop",CTy"sse_compare"))]]),
       (Call
          ("COMISD",CTy"SSE",
           TP[Var("src1",FTy 3),Var("src2",CTy"xmm_mem")]),
        LLC([LW(102,8)],
            Call
              ("e_gen_rm_reg",LTy F8,
               TP[Const("Z32",CTy"Zsize"),
                  Call("xmm_mem_to_rm",CTy"Zrm",Var("src2",CTy"xmm_mem")),
                  Mop(Cast F4,Var("src1",FTy 3)),LL[LW(15,8)],LW(47,8),
                  Mop(Some,LW(0,8))]))),
       (Call
          ("COMISS",CTy"SSE",
           TP[Var("src1",FTy 3),Var("src2",CTy"xmm_mem")]),
        Call
          ("e_gen_rm_reg",LTy F8,
           TP[Const("Z32",CTy"Zsize"),
              Call("xmm_mem_to_rm",CTy"Zrm",Var("src2",CTy"xmm_mem")),
              Mop(Cast F4,Var("src1",FTy 3)),LL[LW(15,8)],LW(47,8),LO F8])),
       (Call
          ("CVTDQ2PD",CTy"SSE",
           TP[Var("dst",FTy 3),Var("src",CTy"xmm_mem")]),
        LLC([LW(243,8)],
            Call
              ("e_gen_rm_reg",LTy F8,
               TP[Const("Z32",CTy"Zsize"),
                  Call("xmm_mem_to_rm",CTy"Zrm",Var("src",CTy"xmm_mem")),
                  Mop(Cast F4,Var("dst",FTy 3)),LL[LW(15,8)],LW(230,8),
                  Mop(Some,LW(0,8))]))),
       (Call
          ("CVTDQ2PS",CTy"SSE",
           TP[Var("dst",FTy 3),Var("src",CTy"xmm_mem")]),
        Call
          ("e_gen_rm_reg",LTy F8,
           TP[Const("Z32",CTy"Zsize"),
              Call("xmm_mem_to_rm",CTy"Zrm",Var("src",CTy"xmm_mem")),
              Mop(Cast F4,Var("dst",FTy 3)),LL[LW(15,8)],LW(91,8),
              Mop(Some,LW(0,8))])),
       (Call
          ("CVTPD2DQ",CTy"SSE",
           TP[bVar"truncate",Var("dst",FTy 3),Var("src",CTy"xmm_mem")]),
        LLC([ITE(bVar"truncate",LW(102,8),LW(242,8))],
            Call
              ("e_gen_rm_reg",LTy F8,
               TP[Const("Z32",CTy"Zsize"),
                  Call("xmm_mem_to_rm",CTy"Zrm",Var("src",CTy"xmm_mem")),
                  Mop(Cast F4,Var("dst",FTy 3)),LL[LW(15,8)],LW(230,8),
                  Mop(Some,LW(0,8))]))),
       (Call
          ("CVTPD2PS",CTy"SSE",
           TP[Var("dst",FTy 3),Var("src",CTy"xmm_mem")]),
        LLC([LW(102,8)],
            Call
              ("e_gen_rm_reg",LTy F8,
               TP[Const("Z32",CTy"Zsize"),
                  Call("xmm_mem_to_rm",CTy"Zrm",Var("src",CTy"xmm_mem")),
                  Mop(Cast F4,Var("dst",FTy 3)),LL[LW(15,8)],LW(90,8),
                  Mop(Some,LW(0,8))]))),
       (Call
          ("CVTPS2DQ",CTy"SSE",
           TP[bVar"truncate",Var("dst",FTy 3),Var("src",CTy"xmm_mem")]),
        LLC([ITE(bVar"truncate",LW(243,8),LW(102,8))],
            Call
              ("e_gen_rm_reg",LTy F8,
               TP[Const("Z32",CTy"Zsize"),
                  Call("xmm_mem_to_rm",CTy"Zrm",Var("src",CTy"xmm_mem")),
                  Mop(Cast F4,Var("dst",FTy 3)),LL[LW(15,8)],LW(91,8),
                  Mop(Some,LW(0,8))]))),
       (Call
          ("CVTPS2PD",CTy"SSE",
           TP[Var("dst",FTy 3),Var("src",CTy"xmm_mem")]),
        Call
          ("e_gen_rm_reg",LTy F8,
           TP[Const("Z32",CTy"Zsize"),
              Call("xmm_mem_to_rm",CTy"Zrm",Var("src",CTy"xmm_mem")),
              Mop(Cast F4,Var("dst",FTy 3)),LL[LW(15,8)],LW(90,8),
              Mop(Some,LW(0,8))])),
       (Call
          ("CVTSD2SI",CTy"SSE",
           TP[bVar"truncate",bVar"quad",Var("dst",CTy"Zreg"),
              Var("src",CTy"xmm_mem")]),
        LLC([LW(242,8)],
            Call
              ("e_gen_rm_reg",LTy F8,
               TP[ITE(bVar"quad",Const("Z64",CTy"Zsize"),
                      Const("Z32",CTy"Zsize")),
                  Call("xmm_mem_to_rm",CTy"Zrm",Var("src",CTy"xmm_mem")),
                  Mop(Cast F4,Var("dst",CTy"Zreg")),LL[LW(15,8)],LW(44,8),
                  Mop(Some,Mop(Cast F8,Mop(Not,bVar"truncate")))]))),
       (Call
          ("CVTSD2SS",CTy"SSE",
           TP[Var("dst",FTy 3),Var("src",CTy"xmm_mem")]),
        LLC([LW(242,8)],
            Call
              ("e_gen_rm_reg",LTy F8,
               TP[Const("Z32",CTy"Zsize"),
                  Call("xmm_mem_to_rm",CTy"Zrm",Var("src",CTy"xmm_mem")),
                  Mop(Cast F4,Var("dst",FTy 3)),LL[LW(15,8)],LW(90,8),
                  Mop(Some,LW(0,8))]))),
       (Call
          ("CVTSI2SD",CTy"SSE",
           TP[bVar"quad",Var("reg",FTy 3),Var("src",CTy"Zrm")]),
        LLC([LW(242,8)],
            Call
              ("e_gen_rm_reg",LTy F8,
               TP[ITE(bVar"quad",Const("Z64",CTy"Zsize"),
                      Const("Z32",CTy"Zsize")),Var("src",CTy"Zrm"),
                  Mop(Cast F4,Var("reg",FTy 3)),LL[LW(15,8)],LW(42,8),
                  Mop(Some,LW(0,8))]))),
       (Call
          ("CVTSI2SS",CTy"SSE",
           TP[bVar"quad",Var("reg",FTy 3),Var("src",CTy"Zrm")]),
        LLC([LW(243,8)],
            Call
              ("e_gen_rm_reg",LTy F8,
               TP[ITE(bVar"quad",Const("Z64",CTy"Zsize"),
                      Const("Z32",CTy"Zsize")),Var("src",CTy"Zrm"),
                  Mop(Cast F4,Var("reg",FTy 3)),LL[LW(15,8)],LW(42,8),
                  Mop(Some,LW(0,8))]))),
       (Call
          ("CVTSS2SD",CTy"SSE",
           TP[Var("dst",FTy 3),Var("src",CTy"xmm_mem")]),
        LLC([LW(243,8)],
            Call
              ("e_gen_rm_reg",LTy F8,
               TP[Const("Z32",CTy"Zsize"),
                  Call("xmm_mem_to_rm",CTy"Zrm",Var("src",CTy"xmm_mem")),
                  Mop(Cast F4,Var("dst",FTy 3)),LL[LW(15,8)],LW(90,8),
                  Mop(Some,LW(0,8))]))),
       (Call
          ("CVTSS2SI",CTy"SSE",
           TP[bVar"truncate",bVar"quad",Var("dst",CTy"Zreg"),
              Var("src",CTy"xmm_mem")]),
        LLC([LW(243,8)],
            Call
              ("e_gen_rm_reg",LTy F8,
               TP[ITE(bVar"quad",Const("Z64",CTy"Zsize"),
                      Const("Z32",CTy"Zsize")),
                  Call("xmm_mem_to_rm",CTy"Zrm",Var("src",CTy"xmm_mem")),
                  Mop(Cast F4,Var("dst",CTy"Zreg")),LL[LW(15,8)],LW(44,8),
                  Mop(Some,Mop(Cast F8,Mop(Not,bVar"truncate")))]))),
       (Call
          ("MOVAP_D_S",CTy"SSE",
           TP[bVar"double",Call("xmm_reg",CTy"xmm_mem",Var("dst",FTy 3)),
              Var("src",CTy"xmm_mem")]),
        CC[ITE(bVar"double",LL[LW(102,8)],LNL F8),
           Call
             ("e_gen_rm_reg",LTy F8,
              TP[Const("Z32",CTy"Zsize"),
                 Call("xmm_mem_to_rm",CTy"Zrm",Var("src",CTy"xmm_mem")),
                 Mop(Cast F4,Var("dst",FTy 3)),LL[LW(15,8)],LW(40,8),
                 Mop(Some,LW(0,8))])]),
       (Call
          ("MOVAP_D_S",CTy"SSE",
           TP[bVar"double",Var("dst",CTy"xmm_mem"),
              Call("xmm_reg",CTy"xmm_mem",Var("src",FTy 3))]),
        CC[ITE(bVar"double",LL[LW(102,8)],LNL F8),
           Call
             ("e_gen_rm_reg",LTy F8,
              TP[Const("Z32",CTy"Zsize"),
                 Call("xmm_mem_to_rm",CTy"Zrm",Var("dst",CTy"xmm_mem")),
                 Mop(Cast F4,Var("src",FTy 3)),LL[LW(15,8)],LW(41,8),
                 Mop(Some,LW(0,8))])]),
       (Call
          ("MOVAP_D_S",CTy"SSE",
           AVar(PTy(bTy,PTy(CTy"xmm_mem",CTy"xmm_mem")))),LNL F8),
       (Call
          ("MOVUP_D_S",CTy"SSE",
           TP[bVar"double",Call("xmm_reg",CTy"xmm_mem",Var("dst",FTy 3)),
              Var("src",CTy"xmm_mem")]),
        CC[ITE(bVar"double",LL[LW(102,8)],LNL F8),
           Call
             ("e_gen_rm_reg",LTy F8,
              TP[Const("Z32",CTy"Zsize"),
                 Call("xmm_mem_to_rm",CTy"Zrm",Var("src",CTy"xmm_mem")),
                 Mop(Cast F4,Var("dst",FTy 3)),LL[LW(15,8)],LW(16,8),
                 Mop(Some,LW(0,8))])]),
       (Call
          ("MOVUP_D_S",CTy"SSE",
           TP[bVar"double",Var("dst",CTy"xmm_mem"),
              Call("xmm_reg",CTy"xmm_mem",Var("src",FTy 3))]),
        CC[ITE(bVar"double",LL[LW(102,8)],LNL F8),
           Call
             ("e_gen_rm_reg",LTy F8,
              TP[Const("Z32",CTy"Zsize"),
                 Call("xmm_mem_to_rm",CTy"Zrm",Var("dst",CTy"xmm_mem")),
                 Mop(Cast F4,Var("src",FTy 3)),LL[LW(15,8)],LW(17,8),
                 Mop(Some,LW(0,8))])]),
       (Call
          ("MOVUP_D_S",CTy"SSE",
           AVar(PTy(bTy,PTy(CTy"xmm_mem",CTy"xmm_mem")))),LNL F8),
       (Call
          ("MOVSD",CTy"SSE",
           TP[Call("xmm_reg",CTy"xmm_mem",Var("dst",FTy 3)),
              Var("src",CTy"xmm_mem")]),
        LLC([LW(242,8)],
            Call
              ("e_gen_rm_reg",LTy F8,
               TP[Const("Z32",CTy"Zsize"),
                  Call("xmm_mem_to_rm",CTy"Zrm",Var("src",CTy"xmm_mem")),
                  Mop(Cast F4,Var("dst",FTy 3)),LL[LW(15,8)],LW(16,8),
                  Mop(Some,LW(0,8))]))),
       (Call
          ("MOVSD",CTy"SSE",
           TP[Var("dst",CTy"xmm_mem"),
              Call("xmm_reg",CTy"xmm_mem",Var("src",FTy 3))]),
        LLC([LW(242,8)],
            Call
              ("e_gen_rm_reg",LTy F8,
               TP[Const("Z32",CTy"Zsize"),
                  Call("xmm_mem_to_rm",CTy"Zrm",Var("dst",CTy"xmm_mem")),
                  Mop(Cast F4,Var("src",FTy 3)),LL[LW(15,8)],LW(17,8),
                  Mop(Some,LW(0,8))]))),
       (Call("MOVSD",CTy"SSE",AVar(PTy(CTy"xmm_mem",CTy"xmm_mem"))),LNL F8),
       (Call
          ("MOVSS",CTy"SSE",
           TP[Call("xmm_reg",CTy"xmm_mem",Var("dst",FTy 3)),
              Var("src",CTy"xmm_mem")]),
        LLC([LW(243,8)],
            Call
              ("e_gen_rm_reg",LTy F8,
               TP[Const("Z32",CTy"Zsize"),
                  Call("xmm_mem_to_rm",CTy"Zrm",Var("src",CTy"xmm_mem")),
                  Mop(Cast F4,Var("dst",FTy 3)),LL[LW(15,8)],LW(16,8),
                  Mop(Some,LW(0,8))]))),
       (Call
          ("MOVSS",CTy"SSE",
           TP[Var("dst",CTy"xmm_mem"),
              Call("xmm_reg",CTy"xmm_mem",Var("src",FTy 3))]),
        LLC([LW(243,8)],
            Call
              ("e_gen_rm_reg",LTy F8,
               TP[Const("Z32",CTy"Zsize"),
                  Call("xmm_mem_to_rm",CTy"Zrm",Var("dst",CTy"xmm_mem")),
                  Mop(Cast F4,Var("src",FTy 3)),LL[LW(15,8)],LW(17,8),
                  Mop(Some,LW(0,8))]))),
       (Call("MOVSS",CTy"SSE",AVar(PTy(CTy"xmm_mem",CTy"xmm_mem"))),LNL F8),
       (Call
          ("MOV_D_Q",CTy"SSE",
           TP[bVar"to_xmm",bVar"quad",Var("xmm",FTy 3),Var("rm",CTy"Zrm")]),
        LLC([LW(102,8)],
            Call
              ("e_gen_rm_reg",LTy F8,
               TP[ITE(bVar"quad",Const("Z64",CTy"Zsize"),
                      Const("Z32",CTy"Zsize")),Var("rm",CTy"Zrm"),
                  Mop(Cast F4,Var("xmm",FTy 3)),LL[LW(15,8)],
                  CC[LW(3,3),Mop(Cast F1,Mop(Not,bVar"to_xmm")),LW(14,4)],
                  Mop(Some,LW(0,8))]))),
       (Call
          ("MOVQ",CTy"SSE",
           TP[Call
                ("xmm_mem",CTy"xmm_mem",
                 Var("m",
                     PTy(OTy(PTy(FTy 2,CTy"Zreg")),PTy(CTy"Zbase",F64)))),
              Call("xmm_reg",CTy"xmm_mem",Var("src",FTy 3))]),
        LLC([LW(102,8)],
            Call
              ("e_gen_rm_reg",LTy F8,
               TP[Call("Z8",CTy"Zsize",LF),
                  Call
                    ("Zm",CTy"Zrm",
                     Var("m",
                         PTy(OTy(PTy(FTy 2,CTy"Zreg")),PTy(CTy"Zbase",F64)))),
                  Mop(Cast F4,Var("src",FTy 3)),LL[LW(15,8)],LW(214,8),
                  LO F8]))),
       (Call
          ("MOVQ",CTy"SSE",
           TP[Call("xmm_reg",CTy"xmm_mem",Var("r",FTy 3)),
              Var("src",CTy"xmm_mem")]),
        LLC([LW(243,8)],
            Call
              ("e_gen_rm_reg",LTy F8,
               TP[Call("Z8",CTy"Zsize",LF),
                  Call("xmm_mem_to_rm",CTy"Zrm",Var("src",CTy"xmm_mem")),
                  Mop(Cast F4,Var("r",FTy 3)),LL[LW(15,8)],LW(126,8),LO F8]))),
       (Call("MOVQ",CTy"SSE",AVar(PTy(CTy"xmm_mem",CTy"xmm_mem"))),LNL F8),
       (Call
          ("PCMPEQQ",CTy"SSE",TP[Var("dst",FTy 3),Var("src",CTy"xmm_mem")]),
        LLC([LW(102,8)],
            Call
              ("e_gen_rm_reg",LTy F8,
               TP[Const("Z32",CTy"Zsize"),
                  Call("xmm_mem_to_rm",CTy"Zrm",Var("src",CTy"xmm_mem")),
                  Mop(Cast F4,Var("dst",FTy 3)),LL[LW(15,8),LW(56,8)],
                  LW(41,8),Mop(Some,LW(0,8))]))),
       (Call("PSRLW_imm",CTy"SSE",TP[Var("dst",FTy 3),Var("imm",F8)]),
        CC[LLC([LW(102,8)],
               Call
                 ("e_gen_rm_reg",LTy F8,
                  TP[Const("Z32",CTy"Zsize"),
                     Call
                       ("Zr",CTy"Zrm",
                        Mop(Cast(CTy"Zreg"),Var("dst",FTy 3))),LW(2,4),
                     LL[LW(15,8)],LW(113,8),Mop(Some,LW(0,8))])),
           LL[Var("imm",F8)]]),
       (Call("PSRAW_imm",CTy"SSE",TP[Var("dst",FTy 3),Var("imm",F8)]),
        CC[LLC([LW(102,8)],
               Call
                 ("e_gen_rm_reg",LTy F8,
                  TP[Const("Z32",CTy"Zsize"),
                     Call
                       ("Zr",CTy"Zrm",
                        Mop(Cast(CTy"Zreg"),Var("dst",FTy 3))),LW(4,4),
                     LL[LW(15,8)],LW(113,8),Mop(Some,LW(0,8))])),
           LL[Var("imm",F8)]]),
       (Call("PSLLW_imm",CTy"SSE",TP[Var("dst",FTy 3),Var("imm",F8)]),
        CC[LLC([LW(102,8)],
               Call
                 ("e_gen_rm_reg",LTy F8,
                  TP[Const("Z32",CTy"Zsize"),
                     Call
                       ("Zr",CTy"Zrm",
                        Mop(Cast(CTy"Zreg"),Var("dst",FTy 3))),LW(6,4),
                     LL[LW(15,8)],LW(113,8),Mop(Some,LW(0,8))])),
           LL[Var("imm",F8)]]),
       (Call("PSRLD_imm",CTy"SSE",TP[Var("dst",FTy 3),Var("imm",F8)]),
        CC[LLC([LW(102,8)],
               Call
                 ("e_gen_rm_reg",LTy F8,
                  TP[Const("Z32",CTy"Zsize"),
                     Call
                       ("Zr",CTy"Zrm",
                        Mop(Cast(CTy"Zreg"),Var("dst",FTy 3))),LW(2,4),
                     LL[LW(15,8)],LW(114,8),Mop(Some,LW(0,8))])),
           LL[Var("imm",F8)]]),
       (Call("PSRAD_imm",CTy"SSE",TP[Var("dst",FTy 3),Var("imm",F8)]),
        CC[LLC([LW(102,8)],
               Call
                 ("e_gen_rm_reg",LTy F8,
                  TP[Const("Z32",CTy"Zsize"),
                     Call
                       ("Zr",CTy"Zrm",
                        Mop(Cast(CTy"Zreg"),Var("dst",FTy 3))),LW(4,4),
                     LL[LW(15,8)],LW(114,8),Mop(Some,LW(0,8))])),
           LL[Var("imm",F8)]]),
       (Call("PSLLD_imm",CTy"SSE",TP[Var("dst",FTy 3),Var("imm",F8)]),
        CC[LLC([LW(102,8)],
               Call
                 ("e_gen_rm_reg",LTy F8,
                  TP[Const("Z32",CTy"Zsize"),
                     Call
                       ("Zr",CTy"Zrm",
                        Mop(Cast(CTy"Zreg"),Var("dst",FTy 3))),LW(6,4),
                     LL[LW(15,8)],LW(114,8),Mop(Some,LW(0,8))])),
           LL[Var("imm",F8)]]),
       (Call("PSRLQ_imm",CTy"SSE",TP[Var("dst",FTy 3),Var("imm",F8)]),
        CC[LLC([LW(102,8)],
               Call
                 ("e_gen_rm_reg",LTy F8,
                  TP[Const("Z32",CTy"Zsize"),
                     Call
                       ("Zr",CTy"Zrm",
                        Mop(Cast(CTy"Zreg"),Var("dst",FTy 3))),LW(2,4),
                     LL[LW(15,8)],LW(115,8),Mop(Some,LW(0,8))])),
           LL[Var("imm",F8)]]),
       (Call("PSRLDQ",CTy"SSE",TP[Var("dst",FTy 3),Var("imm",F8)]),
        CC[LLC([LW(102,8)],
               Call
                 ("e_gen_rm_reg",LTy F8,
                  TP[Const("Z32",CTy"Zsize"),
                     Call
                       ("Zr",CTy"Zrm",
                        Mop(Cast(CTy"Zreg"),Var("dst",FTy 3))),LW(3,4),
                     LL[LW(15,8)],LW(115,8),Mop(Some,LW(0,8))])),
           LL[Var("imm",F8)]]),
       (Call("PSLLQ_imm",CTy"SSE",TP[Var("dst",FTy 3),Var("imm",F8)]),
        CC[LLC([LW(102,8)],
               Call
                 ("e_gen_rm_reg",LTy F8,
                  TP[Const("Z32",CTy"Zsize"),
                     Call
                       ("Zr",CTy"Zrm",
                        Mop(Cast(CTy"Zreg"),Var("dst",FTy 3))),LW(6,4),
                     LL[LW(15,8)],LW(115,8),Mop(Some,LW(0,8))])),
           LL[Var("imm",F8)]]),
       (Call("PSLLDQ",CTy"SSE",TP[Var("dst",FTy 3),Var("imm",F8)]),
        CC[LLC([LW(102,8)],
               Call
                 ("e_gen_rm_reg",LTy F8,
                  TP[Const("Z32",CTy"Zsize"),
                     Call
                       ("Zr",CTy"Zrm",
                        Mop(Cast(CTy"Zreg"),Var("dst",FTy 3))),LW(7,4),
                     LL[LW(15,8)],LW(115,8),Mop(Some,LW(0,8))])),
           LL[Var("imm",F8)]]),
       (Call
          ("SQRTPD",CTy"SSE",TP[Var("dst",FTy 3),Var("src",CTy"xmm_mem")]),
        LLC([LW(102,8)],
            Call
              ("e_gen_rm_reg",LTy F8,
               TP[Const("Z32",CTy"Zsize"),
                  Call("xmm_mem_to_rm",CTy"Zrm",Var("src",CTy"xmm_mem")),
                  Mop(Cast F4,Var("dst",FTy 3)),LL[LW(15,8)],LW(81,8),
                  Mop(Some,LW(0,8))]))),
       (Call
          ("SQRTSD",CTy"SSE",TP[Var("dst",FTy 3),Var("src",CTy"xmm_mem")]),
        LLC([LW(242,8)],
            Call
              ("e_gen_rm_reg",LTy F8,
               TP[Const("Z32",CTy"Zsize"),
                  Call("xmm_mem_to_rm",CTy"Zrm",Var("src",CTy"xmm_mem")),
                  Mop(Cast F4,Var("dst",FTy 3)),LL[LW(15,8)],LW(81,8),
                  Mop(Some,LW(0,8))]))),
       (Call
          ("SQRTPS",CTy"SSE",TP[Var("dst",FTy 3),Var("src",CTy"xmm_mem")]),
        Call
          ("e_gen_rm_reg",LTy F8,
           TP[Const("Z32",CTy"Zsize"),
              Call("xmm_mem_to_rm",CTy"Zrm",Var("src",CTy"xmm_mem")),
              Mop(Cast F4,Var("dst",FTy 3)),LL[LW(15,8)],LW(81,8),
              Mop(Some,LW(0,8))])),
       (Call
          ("SQRTSS",CTy"SSE",TP[Var("dst",FTy 3),Var("src",CTy"xmm_mem")]),
        LLC([LW(243,8)],
            Call
              ("e_gen_rm_reg",LTy F8,
               TP[Const("Z32",CTy"Zsize"),
                  Call("xmm_mem_to_rm",CTy"Zrm",Var("src",CTy"xmm_mem")),
                  Mop(Cast F4,Var("dst",FTy 3)),LL[LW(15,8)],LW(81,8),
                  Mop(Some,LW(0,8))])))]))
;
val encode_def = Def
  ("encode",Var("i",CTy"instruction"),
   CS(Var("i",CTy"instruction"),
      [(Call("SSE",CTy"instruction",Var("j",CTy"SSE")),
        Call("encode_sse",LTy F8,Var("j",CTy"SSE"))),
       (Call
          ("Zbinop",CTy"instruction",
           TP[Var("bop",CTy"Zbinop_name"),Var("sz",CTy"Zsize"),
              Call
                ("Zrm_i",CTy"Zdest_src",
                 TP[Var("rm",CTy"Zrm"),Var("imm",F64)])]),
        ITE(EQ(Var("bop",CTy"Zbinop_name"),LC("Ztest",CTy"Zbinop_name")),
            ITE(Call("is_rax",bTy,Var("rm",CTy"Zrm")),
                Call
                  ("e_rax_imm",LTy F8,
                   TP[Var("sz",CTy"Zsize"),Var("imm",F64),LW(168,8)]),
                Call
                  ("e_rm_imm",LTy F8,
                   TP[Var("sz",CTy"Zsize"),Var("rm",CTy"Zrm"),
                      Var("imm",F64),LW(0,4),LW(246,8)])),
            Let(Var("opc",F4),Mop(Cast F4,Var("bop",CTy"Zbinop_name")),
                ITB([(Bop(Bit,Var("opc",F4),LN 3),
                      ITE(EQ(Var("imm",F64),LW(1,64)),
                          Call
                            ("e_gen_rm_reg",LTy F8,
                             TP[Var("sz",CTy"Zsize"),Var("rm",CTy"Zrm"),
                                Bop(BAnd,Var("opc",F4),LW(7,4)),LNL F8,
                                LW(208,8),LO F8]),
                          Call
                            ("e_rm_imm8",LTy F8,
                             TP[Var("sz",CTy"Zsize"),Var("rm",CTy"Zrm"),
                                Var("imm",F64),
                                Bop(BAnd,Var("opc",F4),LW(7,4)),LW(192,8)]))),
                     (Bop(And,Call("not_byte",bTy,Var("sz",CTy"Zsize")),
                          Mop(Not,
                              EQ(Call("e_imm8",LTy F8,Var("imm",F64)),
                                 LNL F8))),
                      Call
                        ("e_rm_imm8",LTy F8,
                         TP[Var("sz",CTy"Zsize"),Var("rm",CTy"Zrm"),
                            Var("imm",F64),Var("opc",F4),LW(131,8)])),
                     (Call("is_rax",bTy,Var("rm",CTy"Zrm")),
                      Call
                        ("e_rax_imm",LTy F8,
                         TP[Var("sz",CTy"Zsize"),Var("imm",F64),
                            CC[LW(0,2),EX(Var("opc",F4),LN 2,LN 0,FTy 3),
                               LW(4,3)]]))],
                    Call
                      ("e_rm_imm",LTy F8,
                       TP[Var("sz",CTy"Zsize"),Var("rm",CTy"Zrm"),
                          Var("imm",F64),Var("opc",F4),LW(128,8)]))))),
       (Call
          ("Zbinop",CTy"instruction",
           TP[Var("bop",CTy"Zbinop_name"),Var("sz",CTy"Zsize"),
              Call
                ("Zrm_r",CTy"Zdest_src",
                 TP[Var("rm",CTy"Zrm"),Var("r",CTy"Zreg")])]),
        ITE(EQ(Var("bop",CTy"Zbinop_name"),LC("Ztest",CTy"Zbinop_name")),
            Call
              ("e_gen_rm_reg",LTy F8,
               TP[Var("sz",CTy"Zsize"),Var("rm",CTy"Zrm"),
                  Mop(Cast F4,Var("r",CTy"Zreg")),LNL F8,LW(132,8),LO F8]),
            Let(Var("opc",F4),Mop(Cast F4,Var("bop",CTy"Zbinop_name")),
                ITE(Bop(Bit,Var("opc",F4),LN 3),
                    ITE(EQ(Var("r",CTy"Zreg"),LC("RCX",CTy"Zreg")),
                        Call
                          ("e_gen_rm_reg",LTy F8,
                           TP[Var("sz",CTy"Zsize"),Var("rm",CTy"Zrm"),
                              Bop(BAnd,Var("opc",F4),LW(7,4)),LNL F8,
                              LW(210,8),LO F8]),LNL F8),
                    Call
                      ("e_gen_rm_reg",LTy F8,
                       TP[Var("sz",CTy"Zsize"),Var("rm",CTy"Zrm"),
                          Mop(Cast F4,Var("r",CTy"Zreg")),LNL F8,
                          CC[LW(0,2),EX(Var("opc",F4),LN 2,LN 0,FTy 3),
                             LW(0,3)],LO F8]))))),
       (Call
          ("Zbinop",CTy"instruction",
           TP[Var("bop",CTy"Zbinop_name"),Var("sz",CTy"Zsize"),
              Call
                ("Zr_rm",CTy"Zdest_src",
                 TP[Var("r",CTy"Zreg"),Var("rm",CTy"Zrm")])]),
        Let(Var("opc",F4),Mop(Cast F4,Var("bop",CTy"Zbinop_name")),
            ITE(Bop(Bit,Var("opc",F4),LN 3),LNL F8,
                Call
                  ("e_gen_rm_reg",LTy F8,
                   TP[Var("sz",CTy"Zsize"),Var("rm",CTy"Zrm"),
                      Mop(Cast F4,Var("r",CTy"Zreg")),LNL F8,
                      CC[LW(0,2),EX(Var("opc",F4),LN 2,LN 0,FTy 3),LW(2,3)],
                      LO F8])))),
       (Call
          ("Zbit_test",CTy"instruction",
           TP[Var("bt",CTy"Zbit_test_name"),Var("sz",CTy"Zsize"),
              Call
                ("Zrm_r",CTy"Zdest_src",
                 TP[Var("rm",CTy"Zrm"),Var("r",CTy"Zreg")])]),
        Call
          ("e_gen_rm_reg",LTy F8,
           TP[Var("sz",CTy"Zsize"),Var("rm",CTy"Zrm"),
              Mop(Cast F4,Var("r",CTy"Zreg")),LL[LW(15,8)],
              CC[LW(5,3),Mop(Cast(FTy 2),Var("bt",CTy"Zbit_test_name")),
                 LW(3,3)],LO F8])),
       (Call
          ("Zbit_test",CTy"instruction",
           TP[Var("bt",CTy"Zbit_test_name"),Var("sz",CTy"Zsize"),
              Call
                ("Zrm_i",CTy"Zdest_src",
                 TP[Var("rm",CTy"Zrm"),Var("i",F64)])]),
        Call
          ("e_rm_imm8b",LTy F8,
           TP[Var("sz",CTy"Zsize"),Var("rm",CTy"Zrm"),Var("i",F64),
              Mop(Cast F4,Var("bt",CTy"Zbit_test_name")),
              LL[LW(15,8),LW(186,8)]])),
       (Call
          ("Zbit_test",CTy"instruction",
           AVar(PTy(CTy"Zbit_test_name",PTy(CTy"Zsize",CTy"Zdest_src")))),
        LNL F8),
       (Call
          ("Zcall",CTy"instruction",
           Call("Zrm",CTy"Zimm_rm",Var("rm",CTy"Zrm"))),
        Call("e_opc",LTy F8,TP[LW(255,8),LW(2,3),Var("rm",CTy"Zrm")])),
       (Call
          ("Zcall",CTy"instruction",
           Call("Zimm",CTy"Zimm_rm",Var("imm",F64))),
        CS(Call("e_imm32",LTy F8,Var("imm",F64)),
           [(LNL F8,LNL F8),
            (Var("l",LTy F8),LLC([LW(232,8)],Var("l",LTy F8)))])),
       (Const("Zcmc",CTy"instruction"),LL[LW(245,8)]),
       (Const("Zclc",CTy"instruction"),LL[LW(248,8)]),
       (Const("Zstc",CTy"instruction"),LL[LW(249,8)]),
       (Call
          ("Zcmpxchg",CTy"instruction",
           TP[Var("sz",CTy"Zsize"),Var("rm",CTy"Zrm"),Var("r",CTy"Zreg")]),
        Call
          ("e_gen_rm_reg",LTy F8,
           TP[Var("sz",CTy"Zsize"),Var("rm",CTy"Zrm"),
              Mop(Cast F4,Var("r",CTy"Zreg")),LL[LW(15,8)],LW(176,8),LO F8])),
       (Call
          ("Zdiv",CTy"instruction",
           TP[Var("sz",CTy"Zsize"),Var("rm",CTy"Zrm")]),
        Call
          ("e_gen_rm_reg",LTy F8,
           TP[Var("sz",CTy"Zsize"),Var("rm",CTy"Zrm"),LW(6,4),LNL F8,
              LW(246,8),LO F8])),
       (Call
          ("Zidiv",CTy"instruction",
           TP[Var("sz",CTy"Zsize"),Var("rm",CTy"Zrm")]),
        Call
          ("e_gen_rm_reg",LTy F8,
           TP[Var("sz",CTy"Zsize"),Var("rm",CTy"Zrm"),LW(7,4),LNL F8,
              LW(246,8),LO F8])),
       (Call
          ("Zjcc",CTy"instruction",
           TP[Var("cond",CTy"Zcond"),Var("imm",F64)]),
        Let(TP[nVar"s",Var("l",LTy F8)],
            Call("e_imm_8_32",PTy(nTy,LTy F8),Var("imm",F64)),
            ITB([(EQ(Var("cond",CTy"Zcond"),LC("Z_ALWAYS",CTy"Zcond")),
                  ITB([(EQ(nVar"s",LN 1),LLC([LW(235,8)],Var("l",LTy F8))),
                       (EQ(nVar"s",LN 4),LLC([LW(233,8)],Var("l",LTy F8)))],
                      LNL F8)),
                 (EQ(nVar"s",LN 1),
                  LLC([CC[LW(7,4),Mop(Cast F4,Var("cond",CTy"Zcond"))]],
                      Var("l",LTy F8))),
                 (EQ(nVar"s",LN 4),
                  CC[LL[LW(15,8),
                        CC[LW(8,4),Mop(Cast F4,Var("cond",CTy"Zcond"))]],
                     Var("l",LTy F8)])],LNL F8))),
       (Call("Zjmp",CTy"instruction",Var("rm",CTy"Zrm")),
        Call("e_opc",LTy F8,TP[LW(255,8),LW(4,3),Var("rm",CTy"Zrm")])),
       (Call
          ("Zlea",CTy"instruction",
           TP[Call("Z8",CTy"Zsize",AVar bTy),AVar(CTy"Zdest_src")]),LNL F8),
       (Call
          ("Zlea",CTy"instruction",
           TP[Var("sz",CTy"Zsize"),
              Call
                ("Zr_rm",CTy"Zdest_src",
                 TP[Var("r",CTy"Zreg"),
                    Call
                      ("Zm",CTy"Zrm",
                       Var("m",
                           PTy(OTy(PTy(FTy 2,CTy"Zreg")),
                               PTy(CTy"Zbase",F64))))])]),
        Call
          ("e_gen_rm_reg",LTy F8,
           TP[Var("sz",CTy"Zsize"),
              Call
                ("Zm",CTy"Zrm",
                 Var("m",
                     PTy(OTy(PTy(FTy 2,CTy"Zreg")),PTy(CTy"Zbase",F64)))),
              Mop(Cast F4,Var("r",CTy"Zreg")),LNL F8,LW(141,8),LO F8])),
       (Call("Zlea",CTy"instruction",AVar(PTy(CTy"Zsize",CTy"Zdest_src"))),
        LNL F8),(Const("Zleave",CTy"instruction"),LL[LW(201,8)]),
       (Call
          ("Zloop",CTy"instruction",
           TP[Var("cond",CTy"Zcond"),Var("imm",F64)]),
        CS(TP[Var("cond",CTy"Zcond"),Call("e_imm8",LTy F8,Var("imm",F64))],
           [(TP[AVar(CTy"Zcond"),LNL F8],LNL F8),
            (TP[LC("Z_NE",CTy"Zcond"),Var("l",LTy F8)],
             LLC([LW(224,8)],Var("l",LTy F8))),
            (TP[LC("Z_E",CTy"Zcond"),Var("l",LTy F8)],
             LLC([LW(225,8)],Var("l",LTy F8))),
            (TP[LC("Z_ALWAYS",CTy"Zcond"),Var("l",LTy F8)],
             LLC([LW(226,8)],Var("l",LTy F8))),
            (AVar(PTy(CTy"Zcond",LTy F8)),LNL F8)])),
       (Call
          ("Zmonop",CTy"instruction",
           TP[LC("Zinc",CTy"Zmonop_name"),Call("Z8",CTy"Zsize",AVar bTy),
              Var("rm",CTy"Zrm")]),
        Call("e_opc",LTy F8,TP[LW(254,8),LW(0,3),Var("rm",CTy"Zrm")])),
       (Call
          ("Zmonop",CTy"instruction",
           TP[LC("Zdec",CTy"Zmonop_name"),Call("Z8",CTy"Zsize",AVar bTy),
              Var("rm",CTy"Zrm")]),
        Call("e_opc",LTy F8,TP[LW(254,8),LW(1,3),Var("rm",CTy"Zrm")])),
       (Call
          ("Zmonop",CTy"instruction",
           TP[LC("Zinc",CTy"Zmonop_name"),Var("sz",CTy"Zsize"),
              Var("rm",CTy"Zrm")]),
        Call
          ("e_gen_rm_reg",LTy F8,
           TP[Var("sz",CTy"Zsize"),Var("rm",CTy"Zrm"),LW(0,4),LNL F8,
              LW(255,8),LO F8])),
       (Call
          ("Zmonop",CTy"instruction",
           TP[LC("Zdec",CTy"Zmonop_name"),Var("sz",CTy"Zsize"),
              Var("rm",CTy"Zrm")]),
        Call
          ("e_gen_rm_reg",LTy F8,
           TP[Var("sz",CTy"Zsize"),Var("rm",CTy"Zrm"),LW(1,4),LNL F8,
              LW(255,8),LO F8])),
       (Call
          ("Zmonop",CTy"instruction",
           TP[LC("Znot",CTy"Zmonop_name"),Var("sz",CTy"Zsize"),
              Var("rm",CTy"Zrm")]),
        Call
          ("e_gen_rm_reg",LTy F8,
           TP[Var("sz",CTy"Zsize"),Var("rm",CTy"Zrm"),LW(2,4),LNL F8,
              LW(246,8),LO F8])),
       (Call
          ("Zmonop",CTy"instruction",
           TP[LC("Zneg",CTy"Zmonop_name"),Var("sz",CTy"Zsize"),
              Var("rm",CTy"Zrm")]),
        Call
          ("e_gen_rm_reg",LTy F8,
           TP[Var("sz",CTy"Zsize"),Var("rm",CTy"Zrm"),LW(3,4),LNL F8,
              LW(246,8),LO F8])),
       (Call
          ("Zmov",CTy"instruction",
           TP[LC("Z_ALWAYS",CTy"Zcond"),Var("sz",CTy"Zsize"),
              Call
                ("Zrm_r",CTy"Zdest_src",
                 TP[Var("rm",CTy"Zrm"),Var("r",CTy"Zreg")])]),
        Call
          ("e_gen_rm_reg",LTy F8,
           TP[Var("sz",CTy"Zsize"),Var("rm",CTy"Zrm"),
              Mop(Cast F4,Var("r",CTy"Zreg")),LNL F8,LW(136,8),LO F8])),
       (Call
          ("Zmov",CTy"instruction",
           TP[LC("Z_ALWAYS",CTy"Zcond"),Var("sz",CTy"Zsize"),
              Call
                ("Zr_rm",CTy"Zdest_src",
                 TP[Var("r",CTy"Zreg"),Var("rm",CTy"Zrm")])]),
        Call
          ("e_gen_rm_reg",LTy F8,
           TP[Var("sz",CTy"Zsize"),Var("rm",CTy"Zrm"),
              Mop(Cast F4,Var("r",CTy"Zreg")),LNL F8,LW(138,8),LO F8])),
       (Call
          ("Zmov",CTy"instruction",
           TP[LC("Z_ALWAYS",CTy"Zcond"),Var("sz",CTy"Zsize"),
              Call
                ("Zrm_i",CTy"Zdest_src",
                 TP[Call("Zr",CTy"Zrm",Var("reg",CTy"Zreg")),
                    Var("imm",F64)])]),
        Let(Var("r",F4),Mop(Cast F4,Var("reg",CTy"Zreg")),
            CS(Call
                 ("e_opsize_imm",OTy(PTy(LTy F8,PTy(F8,LTy F8))),
                  TP[Var("sz",CTy"Zsize"),
                     ITE(Bop(Bit,Var("r",F4),LN 3),LW(1,4),LW(0,4)),
                     Var("imm",F64),LF]),
               [(Mop(Some,
                     TP[Var("prefixes",LTy F8),Var("v",F8),Var("l",LTy F8)]),
                 CC[Var("prefixes",LTy F8),
                    LL[CC[LW(11,4),Mop(Cast F1,Var("v",F8)),
                          EX(Var("r",F4),LN 2,LN 0,FTy 3)]],
                    Var("l",LTy F8)]),
                (LO(PTy(LTy F8,PTy(F8,LTy F8))),LNL F8)]))),
       (Call
          ("Zmov",CTy"instruction",
           TP[LC("Z_ALWAYS",CTy"Zcond"),Var("sz",CTy"Zsize"),
              Call
                ("Zrm_i",CTy"Zdest_src",
                 TP[Var("rm",CTy"Zrm"),Var("imm",F64)])]),
        Call
          ("e_rm_imm",LTy F8,
           TP[Var("sz",CTy"Zsize"),Var("rm",CTy"Zrm"),Var("imm",F64),
              LW(0,4),LW(198,8)])),
       (Call
          ("Zmov",CTy"instruction",
           TP[Var("cond",CTy"Zcond"),Call("Z8",CTy"Zsize",AVar bTy),
              AVar(CTy"Zdest_src")]),LNL F8),
       (Call
          ("Zmov",CTy"instruction",
           TP[Var("cond",CTy"Zcond"),Var("sz",CTy"Zsize"),
              Call
                ("Zr_rm",CTy"Zdest_src",
                 TP[Var("r",CTy"Zreg"),Var("rm",CTy"Zrm")])]),
        Call
          ("e_gen_rm_reg",LTy F8,
           TP[Var("sz",CTy"Zsize"),Var("rm",CTy"Zrm"),
              Mop(Cast F4,Var("r",CTy"Zreg")),LL[LW(15,8)],LW(64,8),
              Mop(Some,Mop(Cast F8,Var("cond",CTy"Zcond")))])),
       (Call
          ("Zmov",CTy"instruction",
           AVar(PTy(CTy"Zcond",PTy(CTy"Zsize",CTy"Zdest_src")))),LNL F8),
       (Call
          ("Zmovsx",CTy"instruction",
           TP[Const("Z32",CTy"Zsize"),
              Call
                ("Zr_rm",CTy"Zdest_src",
                 TP[Var("r",CTy"Zreg"),Var("rm",CTy"Zrm")]),
              Const("Z64",CTy"Zsize")]),
        Call
          ("e_gen_rm_reg",LTy F8,
           TP[Const("Z64",CTy"Zsize"),Var("rm",CTy"Zrm"),
              Mop(Cast F4,Var("r",CTy"Zreg")),LNL F8,LW(99,8),LO F8])),
       (Call
          ("Zmovsx",CTy"instruction",
           TP[Var("sz1",CTy"Zsize"),
              Call
                ("Zr_rm",CTy"Zdest_src",
                 TP[Var("r",CTy"Zreg"),Var("rm",CTy"Zrm")]),
              Var("sz2",CTy"Zsize")]),
        ITE(Bop(Lt,Call("Zsize_width",nTy,Var("sz1",CTy"Zsize")),
                Call("Zsize_width",nTy,Var("sz2",CTy"Zsize"))),
            Call
              ("e_gen_rm_reg",LTy F8,
               TP[Var("sz2",CTy"Zsize"),Var("rm",CTy"Zrm"),
                  Mop(Cast F4,Var("r",CTy"Zreg")),LL[LW(15,8)],LW(190,8),
                  Mop(Some,
                      ITE(EQ(Var("sz1",CTy"Zsize"),Const("Z16",CTy"Zsize")),
                          LW(1,8),LW(0,8)))]),LNL F8)),
       (Call
          ("Zmovsx",CTy"instruction",
           AVar(PTy(CTy"Zsize",PTy(CTy"Zdest_src",CTy"Zsize")))),LNL F8),
       (Call
          ("Zmovzx",CTy"instruction",
           TP[Var("sz1",CTy"Zsize"),
              Call
                ("Zr_rm",CTy"Zdest_src",
                 TP[Var("r",CTy"Zreg"),Var("rm",CTy"Zrm")]),
              Var("sz2",CTy"Zsize")]),
        ITE(Bop(And,
                Bop(Lt,Call("Zsize_width",nTy,Var("sz1",CTy"Zsize")),
                    Call("Zsize_width",nTy,Var("sz2",CTy"Zsize"))),
                Mop(Not,EQ(Var("sz1",CTy"Zsize"),Const("Z32",CTy"Zsize")))),
            Call
              ("e_gen_rm_reg",LTy F8,
               TP[Var("sz2",CTy"Zsize"),Var("rm",CTy"Zrm"),
                  Mop(Cast F4,Var("r",CTy"Zreg")),LL[LW(15,8)],LW(182,8),
                  Mop(Some,
                      ITE(EQ(Var("sz1",CTy"Zsize"),Const("Z16",CTy"Zsize")),
                          LW(1,8),LW(0,8)))]),LNL F8)),
       (Call
          ("Zmovzx",CTy"instruction",
           AVar(PTy(CTy"Zsize",PTy(CTy"Zdest_src",CTy"Zsize")))),LNL F8),
       (Call
          ("Zmul",CTy"instruction",
           TP[Var("sz",CTy"Zsize"),Var("rm",CTy"Zrm")]),
        Call
          ("e_gen_rm_reg",LTy F8,
           TP[Var("sz",CTy"Zsize"),Var("rm",CTy"Zrm"),LW(4,4),LNL F8,
              LW(246,8),LO F8])),
       (Call
          ("Zimul",CTy"instruction",
           TP[Var("sz",CTy"Zsize"),Var("rm",CTy"Zrm")]),
        Call
          ("e_gen_rm_reg",LTy F8,
           TP[Var("sz",CTy"Zsize"),Var("rm",CTy"Zrm"),LW(5,4),LNL F8,
              LW(246,8),LO F8])),
       (Call
          ("Zimul2",CTy"instruction",
           TP[Call("Z8",CTy"Zsize",AVar bTy),AVar(CTy"Zreg"),
              AVar(CTy"Zrm")]),LNL F8),
       (Call
          ("Zimul2",CTy"instruction",
           TP[Var("sz",CTy"Zsize"),Var("r",CTy"Zreg"),Var("rm",CTy"Zrm")]),
        Call
          ("e_gen_rm_reg",LTy F8,
           TP[Var("sz",CTy"Zsize"),Var("rm",CTy"Zrm"),
              Mop(Cast F4,Var("r",CTy"Zreg")),LL[LW(15,8)],LW(175,8),LO F8])),
       (Call
          ("Zimul3",CTy"instruction",
           TP[Call("Z8",CTy"Zsize",AVar bTy),AVar(CTy"Zreg"),
              AVar(PTy(CTy"Zrm",F64))]),LNL F8),
       (Call
          ("Zimul3",CTy"instruction",
           TP[Var("sz",CTy"Zsize"),Var("r",CTy"Zreg"),Var("rm",CTy"Zrm"),
              Var("imm",F64)]),
        Let(TP[nVar"s",Var("l",LTy F8)],
            Call("e_imm_8_32",PTy(nTy,LTy F8),Var("imm",F64)),
            ITB([(EQ(nVar"s",LN 1),
                  CC[Call
                       ("e_gen_rm_reg",LTy F8,
                        TP[Var("sz",CTy"Zsize"),Var("rm",CTy"Zrm"),
                           Mop(Cast F4,Var("r",CTy"Zreg")),LNL F8,
                           LW(107,8),LO F8]),Var("l",LTy F8)]),
                 (EQ(nVar"s",LN 4),
                  CC[Call
                       ("e_gen_rm_reg",LTy F8,
                        TP[Var("sz",CTy"Zsize"),Var("rm",CTy"Zrm"),
                           Mop(Cast F4,Var("r",CTy"Zreg")),LNL F8,
                           LW(105,8),LO F8]),Var("l",LTy F8)])],LNL F8))),
       (Call("Znop",CTy"instruction",LN 1),LL[LW(144,8)]),
       (Call("Znop",CTy"instruction",LN 2),LL[LW(102,8),LW(144,8)]),
       (Call("Znop",CTy"instruction",LN 3),LL[LW(15,8),LW(31,8),LW(0,8)]),
       (Call("Znop",CTy"instruction",LN 4),
        LL[LW(15,8),LW(31,8),LW(64,8),LW(0,8)]),
       (Call("Znop",CTy"instruction",LN 5),
        LL[LW(15,8),LW(31,8),LW(68,8),LW(0,8),LW(0,8)]),
       (Call("Znop",CTy"instruction",LN 6),
        LL[LW(102,8),LW(15,8),LW(31,8),LW(68,8),LW(0,8),LW(0,8)]),
       (Call("Znop",CTy"instruction",LN 7),
        LL[LW(15,8),LW(31,8),LW(128,8),LW(0,8),LW(0,8),LW(0,8),LW(0,8)]),
       (Call("Znop",CTy"instruction",LN 8),
        LL[LW(15,8),LW(31,8),LW(132,8),LW(0,8),LW(0,8),LW(0,8),LW(0,8),
           LW(0,8)]),
       (Call("Znop",CTy"instruction",LN 9),
        LL[LW(102,8),LW(15,8),LW(31,8),LW(132,8),LW(0,8),LW(0,8),LW(0,8),
           LW(0,8),LW(0,8)]),
       (Call("Znop",CTy"instruction",AVar nTy),LNL F8),
       (Call
          ("Zpop",CTy"instruction",
           Call("Zr",CTy"Zrm",Var("reg",CTy"Zreg"))),
        Let(Var("r",F4),Mop(Cast F4,Var("reg",CTy"Zreg")),
            CC[ITE(Bop(Bit,Var("r",F4),LN 3),LL[LW(73,8)],LNL F8),
               LL[CC[LW(11,5),EX(Var("r",F4),LN 2,LN 0,FTy 3)]]])),
       (Call("Zpop",CTy"instruction",Var("rm",CTy"Zrm")),
        Call("e_opc",LTy F8,TP[LW(143,8),LW(0,3),Var("rm",CTy"Zrm")])),
       (Call
          ("Zpush",CTy"instruction",
           Call
             ("Zrm",CTy"Zimm_rm",Call("Zr",CTy"Zrm",Var("reg",CTy"Zreg")))),
        Let(Var("r",F4),Mop(Cast F4,Var("reg",CTy"Zreg")),
            CC[ITE(Bop(Bit,Var("r",F4),LN 3),LL[LW(73,8)],LNL F8),
               LL[CC[LW(10,5),EX(Var("r",F4),LN 2,LN 0,FTy 3)]]])),
       (Call
          ("Zpush",CTy"instruction",
           Call("Zrm",CTy"Zimm_rm",Var("rm",CTy"Zrm"))),
        Call("e_opc",LTy F8,TP[LW(255,8),LW(6,3),Var("rm",CTy"Zrm")])),
       (Call
          ("Zpush",CTy"instruction",
           Call("Zimm",CTy"Zimm_rm",Var("imm",F64))),
        Let(TP[nVar"s",Var("l",LTy F8)],
            Call("e_imm_8_32",PTy(nTy,LTy F8),Var("imm",F64)),
            ITB([(EQ(nVar"s",LN 1),LLC([LW(106,8)],Var("l",LTy F8))),
                 (EQ(nVar"s",LN 4),LLC([LW(104,8)],Var("l",LTy F8)))],
                LNL F8))),
       (Call("Zret",CTy"instruction",LW(0,64)),LL[LW(195,8)]),
       (Call("Zret",CTy"instruction",Var("imm",F64)),
        CS(Call("e_imm16",LTy F8,Var("imm",F64)),
           [(LNL F8,LNL F8),
            (Var("l",LTy F8),LLC([LW(194,8)],Var("l",LTy F8)))])),
       (Call
          ("Zset",CTy"instruction",
           TP[LC("Z_ALWAYS",CTy"Zcond"),bVar"have_rex",Var("rm",CTy"Zrm")]),
        LNL F8),
       (Call
          ("Zset",CTy"instruction",
           TP[Var("cond",CTy"Zcond"),bVar"have_rex",Var("rm",CTy"Zrm")]),
        Call
          ("e_gen_rm_reg",LTy F8,
           TP[Call("Z8",CTy"Zsize",bVar"have_rex"),Var("rm",CTy"Zrm"),
              LW(0,4),LL[LW(15,8)],
              CC[LW(9,4),Mop(Cast F4,Var("cond",CTy"Zcond"))],LO F8])),
       (Call
          ("Zxadd",CTy"instruction",
           TP[Var("sz",CTy"Zsize"),Var("rm",CTy"Zrm"),Var("r",CTy"Zreg")]),
        Call
          ("e_gen_rm_reg",LTy F8,
           TP[Var("sz",CTy"Zsize"),Var("rm",CTy"Zrm"),
              Mop(Cast F4,Var("r",CTy"Zreg")),LL[LW(15,8)],LW(192,8),LO F8])),
       (Call
          ("Zxchg",CTy"instruction",
           TP[Var("sz",CTy"Zsize"),Var("rm",CTy"Zrm"),Var("reg",CTy"Zreg")]),
        ITE(Bop(And,Call("not_byte",bTy,Var("sz",CTy"Zsize")),
                Bop(Or,EQ(Var("reg",CTy"Zreg"),LC("RAX",CTy"Zreg")),
                    Call("is_rax",bTy,Var("rm",CTy"Zrm")))),
            Let(Var("r",F4),Mop(Cast F4,Var("reg",CTy"Zreg")),
                Let(TP[Var("prefixes",LTy F8),Var("v",F8)],
                    Call
                      ("e_opsize",PTy(LTy F8,F8),
                       TP[Var("sz",CTy"Zsize"),
                          ITE(Bop(Bit,Var("r",F4),LN 3),LW(1,4),LW(0,4))]),
                    ITE(EQ(Var("v",F8),LW(1,8)),
                        CC[Var("prefixes",LTy F8),
                           LL[CC[LW(18,5),EX(Var("r",F4),LN 2,LN 0,FTy 3)]]],
                        LNL F8))),
            Call
              ("e_gen_rm_reg",LTy F8,
               TP[Var("sz",CTy"Zsize"),Var("rm",CTy"Zrm"),
                  Mop(Cast F4,Var("reg",CTy"Zreg")),LNL F8,LW(134,8),LO F8])))]))

val () = Import.finish 0